import{c as M,r as n,j as e,a as _,u as we,L as Te,B as Y,b as Se}from"./index-Di5bqkpT.js";import{C as Ee,b as Ie,c as Re,a as Fe,d as Le}from"./card-D_CoMJxr.js";import{u as Pe,a as ae,c as ne,b as Me,P as L,d as P,e as re,f as _e,E as Ae,I as z}from"./index--Y5pGr1Y.js";import{c as oe,R as De,I as $e,B as ze,U as Be}from"./badge-CgdYnlhA.js";import{T as He,L as A,S as Ve,A as Z,a as J,b as Q,c as W,d as ee,e as te,f as se}from"./separator-BnkA3RSR.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],qe=M("Check",Ue);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],Ge=M("Code",Oe);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Xe=M("FileDown",Ke);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Ze=M("ImagePlus",Ye);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],Qe=M("ListChecks",Je);var V="Tabs",[We,yt]=ne(V,[oe]),ie=oe(),[et,U]=We(V),ce=n.forwardRef((t,s)=>{const{__scopeTabs:a,value:r,onValueChange:c,defaultValue:l,orientation:o="horizontal",dir:u,activationMode:g="automatic",...j}=t,d=Pe(u),[m,h]=ae({prop:r,onChange:c,defaultProp:l});return e.jsx(et,{scope:a,baseId:Me(),value:m,onValueChange:h,orientation:o,dir:d,activationMode:g,children:e.jsx(L.div,{dir:d,"data-orientation":o,...j,ref:s})})});ce.displayName=V;var le="TabsList",de=n.forwardRef((t,s)=>{const{__scopeTabs:a,loop:r=!0,...c}=t,l=U(le,a),o=ie(a);return e.jsx(De,{asChild:!0,...o,orientation:l.orientation,dir:l.dir,loop:r,children:e.jsx(L.div,{role:"tablist","aria-orientation":l.orientation,...c,ref:s})})});de.displayName=le;var ue="TabsTrigger",me=n.forwardRef((t,s)=>{const{__scopeTabs:a,value:r,disabled:c=!1,...l}=t,o=U(ue,a),u=ie(a),g=pe(o.baseId,r),j=ge(o.baseId,r),d=r===o.value;return e.jsx($e,{asChild:!0,...u,focusable:!c,active:d,children:e.jsx(L.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":j,"data-state":d?"active":"inactive","data-disabled":c?"":void 0,disabled:c,id:g,...l,ref:s,onMouseDown:P(t.onMouseDown,m=>{!c&&m.button===0&&m.ctrlKey===!1?o.onValueChange(r):m.preventDefault()}),onKeyDown:P(t.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&o.onValueChange(r)}),onFocus:P(t.onFocus,()=>{const m=o.activationMode!=="manual";!d&&!c&&m&&o.onValueChange(r)})})})});me.displayName=ue;var he="TabsContent",xe=n.forwardRef((t,s)=>{const{__scopeTabs:a,value:r,forceMount:c,children:l,...o}=t,u=U(he,a),g=pe(u.baseId,r),j=ge(u.baseId,r),d=r===u.value,m=n.useRef(d);return n.useEffect(()=>{const h=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(h)},[]),e.jsx(re,{present:c||d,children:({present:h})=>e.jsx(L.div,{"data-state":d?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":g,hidden:!h,id:j,tabIndex:0,...o,ref:s,style:{...t.style,animationDuration:m.current?"0s":void 0},children:h&&l})})});xe.displayName=he;function pe(t,s){return`${t}-trigger-${s}`}function ge(t,s){return`${t}-content-${s}`}var tt=ce,st=de,at=me,nt=xe;function B({className:t,...s}){return e.jsx(tt,{"data-slot":"tabs",className:_("flex flex-col gap-2",t),...s})}function H({className:t,...s}){return e.jsx(st,{"data-slot":"tabs-list",className:_("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-1",t),...s})}function R({className:t,...s}){return e.jsx(at,{"data-slot":"tabs-trigger",className:_("data-[state=active]:bg-background data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring inline-flex flex-1 items-center justify-center gap-1.5 rounded-md px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}function F({className:t,...s}){return e.jsx(nt,{"data-slot":"tabs-content",className:_("flex-1 outline-none",t),...s})}function rt(t){const s=n.useRef({value:t,previous:t});return n.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}var q="Checkbox",[ot,kt]=ne(q),[it,ct]=ot(q),be=n.forwardRef((t,s)=>{const{__scopeCheckbox:a,name:r,checked:c,defaultChecked:l,required:o,disabled:u,value:g="on",onCheckedChange:j,form:d,...m}=t,[h,S]=n.useState(null),E=we(s,f=>S(f)),k=n.useRef(!1),N=h?d||!!h.closest("form"):!0,[b=!1,T]=ae({prop:c,defaultProp:l,onChange:j}),D=n.useRef(b);return n.useEffect(()=>{const f=h==null?void 0:h.form;if(f){const C=()=>T(D.current);return f.addEventListener("reset",C),()=>f.removeEventListener("reset",C)}},[h,T]),e.jsxs(it,{scope:a,state:b,disabled:u,children:[e.jsx(L.button,{type:"button",role:"checkbox","aria-checked":w(b)?"mixed":b,"aria-required":o,"data-state":je(b),"data-disabled":u?"":void 0,disabled:u,value:g,...m,ref:E,onKeyDown:P(t.onKeyDown,f=>{f.key==="Enter"&&f.preventDefault()}),onClick:P(t.onClick,f=>{T(C=>w(C)?!0:!C),N&&(k.current=f.isPropagationStopped(),k.current||f.stopPropagation())})}),N&&e.jsx(lt,{control:h,bubbles:!k.current,name:r,value:g,checked:b,required:o,disabled:u,form:d,style:{transform:"translateX(-100%)"},defaultChecked:w(l)?!1:l})]})});be.displayName=q;var fe="CheckboxIndicator",ve=n.forwardRef((t,s)=>{const{__scopeCheckbox:a,forceMount:r,...c}=t,l=ct(fe,a);return e.jsx(re,{present:r||w(l.state)||l.state===!0,children:e.jsx(L.span,{"data-state":je(l.state),"data-disabled":l.disabled?"":void 0,...c,ref:s,style:{pointerEvents:"none",...t.style}})})});ve.displayName=fe;var lt=t=>{const{control:s,checked:a,bubbles:r=!0,defaultChecked:c,...l}=t,o=n.useRef(null),u=rt(a),g=_e(s);n.useEffect(()=>{const d=o.current,m=window.HTMLInputElement.prototype,S=Object.getOwnPropertyDescriptor(m,"checked").set;if(u!==a&&S){const E=new Event("click",{bubbles:r});d.indeterminate=w(a),S.call(d,w(a)?!1:a),d.dispatchEvent(E)}},[u,a,r]);const j=n.useRef(w(a)?!1:a);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:c??j.current,...l,tabIndex:-1,ref:o,style:{...t.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function w(t){return t==="indeterminate"}function je(t){return w(t)?"indeterminate":t?"checked":"unchecked"}var dt=be,ut=ve;function mt({className:t,...s}){return e.jsx(dt,{"data-slot":"checkbox",className:_("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(ut,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(qe,{className:"size-3.5"})})})}const Nt=()=>{const[t,s]=n.useState(""),[a,r]=n.useState([]),[c,l]=n.useState("Album"),[o,u]=n.useState("1"),[g,j]=n.useState("my-file.html"),[d,m]=n.useState("chapter"),[h,S]=n.useState([]),[E,k]=n.useState(!1),[N,b]=n.useState(null),[T,D]=n.useState(!1),[f,C]=n.useState("code");n.useEffect(()=>{if(t.trim()){const i=/<img[^>]+src="([^">]+)"/g;let x;const p=[];for(;(x=i.exec(t))!==null;)p.push(x[1]);if(p.length>0)r(p);else{const v=/https?:\/\/[^\s]+\.(jpg|jpeg|png|gif|webp|svg)/gi,y=t.match(v)||[];r(y)}}else r([])},[t]);const $=()=>d==="chapter"?`${o} - ${c}.html`:g;n.useEffect(()=>{(async()=>{const x=indexedDB.open("htmlEditorDB",1);x.onerror=p=>{console.error("IndexedDB error:",p.target.error)},x.onupgradeneeded=p=>{const v=p.target.result;v.objectStoreNames.contains("htmlFiles")||v.createObjectStore("htmlFiles",{keyPath:"id",autoIncrement:!0})},x.onsuccess=p=>{const v=p.target.result;O(v)}})()},[]);const O=i=>{const v=i.transaction(["htmlFiles"],"readonly").objectStore("htmlFiles").getAll();v.onsuccess=()=>{S(v.result)}},ye=()=>{k(!0);const i=indexedDB.open("htmlEditorDB",1);i.onsuccess=x=>{const p=x.target.result,y=p.transaction(["htmlFiles"],"readwrite").objectStore("htmlFiles"),I=d==="chapter"?`${o} - ${c}`:c,K=y.getAll();K.onsuccess=()=>{if(K.result.some(Ce=>Ce.albumName===I)){k(!1),b({type:"error",text:"Album name already exists. Please choose a different name."}),setTimeout(()=>b(null),3e3);return}const Ne={albumName:I,imageUrls:a,createdAt:new Date().toISOString()},X=y.add(Ne);X.onsuccess=()=>{k(!1),b({type:"success",text:"Album saved successfully!"}),O(p),setTimeout(()=>b(null),3e3)},X.onerror=()=>{k(!1),b({type:"error",text:"Failed to save album."}),setTimeout(()=>b(null),3e3)}}}},ke=()=>{const i=a.length>0?a.map(I=>`<img src="${I}" alt="" ${T?'loading="lazy"':""}>`).join(`
`):t,x=`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${$()}</title>
    <style>
        body { background: #f2f2f2; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        img { max-width: 100%; height: auto; margin-bottom: 10px; } /* Added margin for spacing */
        .image-wrapper { margin-bottom: 0px; } /* Remove extra margin */
    </style>
</head>
<body>
    ${i.split(`
`).map(I=>`<div class="image-wrapper">${I}</div>`).join(`
`)}
</body>
</html>`,p=new Blob([x],{type:"text/html"}),v=URL.createObjectURL(p),y=document.createElement("a");y.href=v,y.download=$(),document.body.appendChild(y),y.click(),setTimeout(()=>{document.body.removeChild(y),URL.revokeObjectURL(v)},100)},G=()=>{if(f==="visual")return a.length>0?e.jsx("div",{className:"flex flex-col items-center",children:a.map((i,x)=>e.jsx("img",{src:i,alt:`Image ${x+1}`,className:"max-w-full h-auto mb-2"},i))}):e.jsx("div",{dangerouslySetInnerHTML:{__html:t},className:"prose dark:prose-invert max-w-none"});{const i=a.length>0?a.map(x=>`<img src="${x}" alt="" ${T?'loading="lazy"':""}>`).join(`
`):t;return e.jsx("pre",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-md overflow-auto",children:e.jsx("code",{className:"text-sm font-mono",children:i})})}};return e.jsx("div",{className:"container mx-auto p-4",children:e.jsxs(Ee,{className:"shadow-lg",children:[e.jsxs(Ie,{children:[e.jsxs(Re,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(Ze,{size:24,className:"text-blue-600"}),"HTML Image Uploader"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Create HTML files from image links or HTML content."})]}),e.jsx(Fe,{children:e.jsxs(B,{defaultValue:"edit",className:"w-full space-y-4",children:[e.jsxs(H,{className:"grid grid-cols-2",children:[e.jsxs(R,{value:"edit",className:"flex items-center gap-2",children:[e.jsx(Ge,{size:16})," Editor"]}),e.jsxs(R,{value:"preview",className:"flex items-center gap-2",children:[e.jsx(Ae,{size:16})," Preview"]})]}),e.jsxs(F,{value:"edit",children:[e.jsx(He,{className:"min-h-[150px] font-mono text-sm",value:t,onChange:i=>s(i.target.value),placeholder:"Paste your HTML or image links here..."}),e.jsxs("div",{className:"flex items-center space-x-2 my-4",children:[e.jsx(mt,{id:"lazy-load",checked:T,onCheckedChange:i=>D(!!i)}),e.jsx(A,{htmlFor:"lazy-load",children:"Enable Lazy Loading for Images"})]}),e.jsx(Ve,{className:"my-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"File Naming"}),e.jsxs(B,{defaultValue:"chapter",onValueChange:m,className:"mb-4",children:[e.jsxs(H,{className:"grid grid-cols-2 w-full",children:[e.jsx(R,{value:"chapter",children:"Chapter + Album"}),e.jsx(R,{value:"custom",children:"Custom Name"})]}),e.jsx(F,{value:"chapter",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(A,{className:"my-2",htmlFor:"chapterNumber",children:"Chapter Number"}),e.jsx(z,{id:"chapterNumber",value:o,onChange:i=>u(i.target.value),placeholder:"Enter chapter number"})]}),e.jsxs("div",{children:[e.jsx(A,{className:"my-2",htmlFor:"albumName",children:"Album Name"}),e.jsx(z,{id:"albumName",value:c,onChange:i=>l(i.target.value),placeholder:"Enter album name"})]})]})}),e.jsx(F,{value:"custom",className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(A,{className:"my-2",htmlFor:"customFileName",children:"File Name"}),e.jsx(z,{id:"customFileName",value:g,onChange:i=>j(i.target.value),placeholder:"Enter file name"})]})})]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["File will be named as:"," ",e.jsx(ze,{variant:"secondary",children:$()})]}),a.length>0&&e.jsxs(Z,{className:"border-green-500 bg-green-50 dark:bg-green-900 dark:border-green-400",children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"text-green-600 dark:text-green-300"}),"Image Detection"]}),e.jsxs(Q,{children:["Detected ",a.length," image link(s). Only the image URLs will be processed."]})]})]}),e.jsx(F,{value:"preview",children:e.jsxs(B,{defaultValue:"visual",className:"w-full space-y-4",children:[e.jsxs(H,{className:"grid grid-cols-2",children:[e.jsx(R,{value:"visual",onClick:()=>C("visual"),children:"Visual Preview"}),e.jsx(R,{value:"code",onClick:()=>C("code"),children:"Code Preview"})]}),e.jsx(F,{value:"visual",children:G()}),e.jsx(F,{value:"code",children:G()})]})})]})}),e.jsxs(Le,{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[h.length," file(s) saved in browser storage."," ",e.jsx(Te,{to:"/albums",className:"text-blue-500 hover:underline",children:"View Albums"})]}),e.jsxs("div",{children:[N&&e.jsxs(Z,{variant:N.type==="error"?"destructive":"default",className:`mb-4 ${N.type==="error"?"bg-red-50 dark:bg-red-900":"bg-green-50 dark:bg-green-900"}`,children:[e.jsx(J,{children:N.type==="error"?"Error":"Success"}),e.jsx(Q,{children:N.text})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(W,{children:e.jsxs(ee,{children:[e.jsx(te,{asChild:!0,children:e.jsxs(Y,{variant:"outline",onClick:ke,disabled:!t.trim(),className:"w-32",children:[e.jsx(Xe,{size:16,className:"mr-2"}),"Download"]})}),e.jsx(se,{children:e.jsx("p",{children:"Download the generated HTML file"})})]})}),e.jsx(W,{children:e.jsxs(ee,{children:[e.jsx(te,{asChild:!0,children:e.jsxs(Y,{onClick:ye,disabled:E||!t.trim(),className:"w-32",children:[E?e.jsx(Se,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Be,{size:16,className:"mr-2"}),"Upload"]})}),e.jsx(se,{children:e.jsx("p",{children:"Save the album to browser storage"})})]})})]})]})]})]})})};export{Nt as default};
