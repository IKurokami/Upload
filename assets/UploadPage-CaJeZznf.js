import{c as $,r as n,j as e,a as A,u as je,B as q,L as ye}from"./index-RCUVdnZG.js";import{C as Ne,b as Ce,c as ke,d as we}from"./card-CWL82PV-.js";import{u as Te,a as Q,c as W,b as Se,d as Y,R as Ee,I as Re,e as F,P as ee,f as Ie,U as O}from"./index-DNsEyPm4.js";import{P as I,E as Fe,I as M}from"./input-BkS6dkE6.js";import{T as Ae,L as P,A as G,a as K,b as X}from"./alert-BT5ybd4u.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],_e=$("Check",Pe);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],De=$("Code",Le);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],$e=$("FileDown",Me);var z="Tabs",[ze,it]=W(z,[Y]),te=Y(),[Be,B]=ze(z),se=n.forwardRef((t,s)=>{const{__scopeTabs:a,value:r,onValueChange:i,defaultValue:c,orientation:o="horizontal",dir:u,activationMode:f="automatic",...j}=t,l=Te(u),[m,h]=Q({prop:r,onChange:i,defaultProp:c});return e.jsx(Be,{scope:a,baseId:Se(),value:m,onValueChange:h,orientation:o,dir:l,activationMode:f,children:e.jsx(I.div,{dir:l,"data-orientation":o,...j,ref:s})})});se.displayName=z;var ae="TabsList",ne=n.forwardRef((t,s)=>{const{__scopeTabs:a,loop:r=!0,...i}=t,c=B(ae,a),o=te(a);return e.jsx(Ee,{asChild:!0,...o,orientation:c.orientation,dir:c.dir,loop:r,children:e.jsx(I.div,{role:"tablist","aria-orientation":c.orientation,...i,ref:s})})});ne.displayName=ae;var re="TabsTrigger",oe=n.forwardRef((t,s)=>{const{__scopeTabs:a,value:r,disabled:i=!1,...c}=t,o=B(re,a),u=te(a),f=le(o.baseId,r),j=de(o.baseId,r),l=r===o.value;return e.jsx(Re,{asChild:!0,...u,focusable:!i,active:l,children:e.jsx(I.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":j,"data-state":l?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:f,...c,ref:s,onMouseDown:F(t.onMouseDown,m=>{!i&&m.button===0&&m.ctrlKey===!1?o.onValueChange(r):m.preventDefault()}),onKeyDown:F(t.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&o.onValueChange(r)}),onFocus:F(t.onFocus,()=>{const m=o.activationMode!=="manual";!l&&!i&&m&&o.onValueChange(r)})})})});oe.displayName=re;var ie="TabsContent",ce=n.forwardRef((t,s)=>{const{__scopeTabs:a,value:r,forceMount:i,children:c,...o}=t,u=B(ie,a),f=le(u.baseId,r),j=de(u.baseId,r),l=r===u.value,m=n.useRef(l);return n.useEffect(()=>{const h=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(h)},[]),e.jsx(ee,{present:i||l,children:({present:h})=>e.jsx(I.div,{"data-state":l?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":f,hidden:!h,id:j,tabIndex:0,...o,ref:s,style:{...t.style,animationDuration:m.current?"0s":void 0},children:h&&c})})});ce.displayName=ie;function le(t,s){return`${t}-trigger-${s}`}function de(t,s){return`${t}-content-${s}`}var He=se,Ue=ne,Ve=oe,qe=ce;function Z({className:t,...s}){return e.jsx(He,{"data-slot":"tabs",className:A("flex flex-col gap-2",t),...s})}function J({className:t,...s}){return e.jsx(Ue,{"data-slot":"tabs-list",className:A("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-1",t),...s})}function _({className:t,...s}){return e.jsx(Ve,{"data-slot":"tabs-trigger",className:A("data-[state=active]:bg-background data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring inline-flex flex-1 items-center justify-center gap-1.5 rounded-md px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...s})}function L({className:t,...s}){return e.jsx(qe,{"data-slot":"tabs-content",className:A("flex-1 outline-none",t),...s})}function Oe(t){const s=n.useRef({value:t,previous:t});return n.useMemo(()=>(s.current.value!==t&&(s.current.previous=s.current.value,s.current.value=t),s.current.previous),[t])}var H="Checkbox",[Ge,ct]=W(H),[Ke,Xe]=Ge(H),ue=n.forwardRef((t,s)=>{const{__scopeCheckbox:a,name:r,checked:i,defaultChecked:c,required:o,disabled:u,value:f="on",onCheckedChange:j,form:l,...m}=t,[h,T]=n.useState(null),S=je(s,p=>T(p)),N=n.useRef(!1),C=h?l||!!h.closest("form"):!0,[b=!1,E]=Q({prop:i,defaultProp:c,onChange:j}),D=n.useRef(b);return n.useEffect(()=>{const p=h==null?void 0:h.form;if(p){const k=()=>E(D.current);return p.addEventListener("reset",k),()=>p.removeEventListener("reset",k)}},[h,E]),e.jsxs(Ke,{scope:a,state:b,disabled:u,children:[e.jsx(I.button,{type:"button",role:"checkbox","aria-checked":w(b)?"mixed":b,"aria-required":o,"data-state":xe(b),"data-disabled":u?"":void 0,disabled:u,value:f,...m,ref:S,onKeyDown:F(t.onKeyDown,p=>{p.key==="Enter"&&p.preventDefault()}),onClick:F(t.onClick,p=>{E(k=>w(k)?!0:!k),C&&(N.current=p.isPropagationStopped(),N.current||p.stopPropagation())})}),C&&e.jsx(Ze,{control:h,bubbles:!N.current,name:r,value:f,checked:b,required:o,disabled:u,form:l,style:{transform:"translateX(-100%)"},defaultChecked:w(c)?!1:c})]})});ue.displayName=H;var me="CheckboxIndicator",he=n.forwardRef((t,s)=>{const{__scopeCheckbox:a,forceMount:r,...i}=t,c=Xe(me,a);return e.jsx(ee,{present:r||w(c.state)||c.state===!0,children:e.jsx(I.span,{"data-state":xe(c.state),"data-disabled":c.disabled?"":void 0,...i,ref:s,style:{pointerEvents:"none",...t.style}})})});he.displayName=me;var Ze=t=>{const{control:s,checked:a,bubbles:r=!0,defaultChecked:i,...c}=t,o=n.useRef(null),u=Oe(a),f=Ie(s);n.useEffect(()=>{const l=o.current,m=window.HTMLInputElement.prototype,T=Object.getOwnPropertyDescriptor(m,"checked").set;if(u!==a&&T){const S=new Event("click",{bubbles:r});l.indeterminate=w(a),T.call(l,w(a)?!1:a),l.dispatchEvent(S)}},[u,a,r]);const j=n.useRef(w(a)?!1:a);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:i??j.current,...c,tabIndex:-1,ref:o,style:{...t.style,...f,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function w(t){return t==="indeterminate"}function xe(t){return w(t)?"indeterminate":t?"checked":"unchecked"}var Je=ue,Qe=he;function We({className:t,...s}){return e.jsx(Je,{"data-slot":"checkbox",className:A("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(Qe,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(_e,{className:"size-3.5"})})})}const lt=()=>{const[t,s]=n.useState(""),[a,r]=n.useState([]),[i,c]=n.useState("Album"),[o,u]=n.useState("1"),[f,j]=n.useState("my-file.html"),[l,m]=n.useState("chapter"),[h,T]=n.useState([]),[S,N]=n.useState(!1),[C,b]=n.useState(null),[E,D]=n.useState(!1);n.useEffect(()=>{if(t.trim()){const d=/<img[^>]+src="([^">]+)"/g;let g;const x=[];for(;(g=d.exec(t))!==null;)x.push(g[1]);if(x.length>0)r(x);else{const v=/https?:\/\/[^\s]+\.(jpg|jpeg|png|gif|webp|svg)/gi,y=t.match(v)||[];r(y)}}else r([])},[t]);const p=()=>l==="chapter"?`${o} - ${i}.html`:f;n.useEffect(()=>{(async()=>{const g=indexedDB.open("htmlEditorDB",1);g.onerror=x=>{console.error("IndexedDB error:",x.target.error)},g.onupgradeneeded=x=>{const v=x.target.result;v.objectStoreNames.contains("htmlFiles")||v.createObjectStore("htmlFiles",{keyPath:"id",autoIncrement:!0})},g.onsuccess=x=>{const v=x.target.result;k(v)}})()},[]);const k=d=>{const v=d.transaction(["htmlFiles"],"readonly").objectStore("htmlFiles").getAll();v.onsuccess=()=>{T(v.result)}},pe=()=>{N(!0);const d=indexedDB.open("htmlEditorDB",1);d.onsuccess=g=>{const x=g.target.result,y=x.transaction(["htmlFiles"],"readwrite").objectStore("htmlFiles"),R=l==="chapter"?`${o} - ${i}`:i,U=y.getAll();U.onsuccess=()=>{if(U.result.some(ve=>ve.albumName===R)){N(!1),b({type:"error",text:"Album name already exists. Please choose a different name."}),setTimeout(()=>b(null),3e3);return}const ge={albumName:R,imageUrls:a,createdAt:new Date().toISOString()},V=y.add(ge);V.onsuccess=()=>{N(!1),b({type:"success",text:"Album saved successfully!"}),k(x),setTimeout(()=>b(null),3e3)},V.onerror=()=>{N(!1),b({type:"error",text:"Failed to save album."}),setTimeout(()=>b(null),3e3)}}}},fe=()=>{const g=`<style>
  body {
    background: #f2f2f2;
    margin: 0;
    padding: 20px;
  }
  img {
    max-width: 100%;
    height: auto;
    background: white;
    object-fit: contain;
    object-position: top center;
    display: block; /* Remove default inline spacing */
  }
  .container {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .image-wrapper {
    margin-bottom: 0px; /* Remove bottom margin between images */
  }
</style>
<body class="container">
  ${(a.length>0?a.map(R=>`<img src="${R}" alt="" border="0" ${E?'loading="lazy"':""}>`).join(`
`):t).split(`
`).map(R=>`<div class="image-wrapper">${R}</div>`).join(`
`)}
</body>`,x=new Blob([g],{type:"text/html"}),v=URL.createObjectURL(x),y=document.createElement("a");y.href=v,y.download=p(),document.body.appendChild(y),y.click(),setTimeout(()=>{document.body.removeChild(y),URL.revokeObjectURL(v)},100)},be=()=>a.length>0?e.jsx("div",{className:"flex flex-col",children:a.map((d,g)=>e.jsx("div",{children:e.jsx("img",{src:d,alt:`Image ${g+1}`,className:"max-w-full h-auto"})},d))}):e.jsx("div",{dangerouslySetInnerHTML:{__html:t}});return e.jsxs("div",{className:"container mx-auto p-4 max-w-4xl flex",children:[" ",e.jsxs("div",{className:"w-full",children:[" ",e.jsxs(Ne,{className:"shadow-lg",children:[e.jsx(Ce,{className:"border-b",children:e.jsxs(ke,{className:"text-2xl font-bold flex items-center gap-2 mb-2",children:[e.jsx(O,{size:24,className:"text-blue-600"}),"Uploader"]})}),e.jsxs(Z,{defaultValue:"edit",className:"w-full",children:[e.jsxs(J,{className:"grid grid-cols-2 mx-4 mt-4",children:[e.jsxs(_,{value:"edit",className:"flex items-center gap-2",children:[e.jsx(De,{size:16})," Editor"]}),e.jsxs(_,{value:"preview",className:"flex items-center gap-2",children:[e.jsx(Fe,{size:16})," Preview"]})]}),e.jsx(L,{value:"edit",className:"p-4",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Ae,{className:"min-h-80 font-mono text-sm",value:t,onChange:d=>s(d.target.value),placeholder:"Paste your HTML or image links here..."}),e.jsx("div",{className:"p-4 rounded-lg border",children:e.jsxs(Z,{defaultValue:"chapter",onValueChange:m,children:[e.jsxs(J,{className:"grid grid-cols-2 w-full",children:[e.jsx(_,{value:"chapter",children:"Chapter + Album"}),e.jsx(_,{value:"custom",children:"Custom Name"})]}),e.jsxs(L,{value:"chapter",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{htmlFor:"chapterNumber",children:"Chapter Number"}),e.jsx(M,{id:"chapterNumber",value:o,onChange:d=>u(d.target.value),placeholder:"Enter chapter number"})]}),e.jsxs("div",{children:[e.jsx(P,{htmlFor:"albumName",children:"Album Name"}),e.jsx(M,{id:"albumName",value:i,onChange:d=>c(d.target.value),placeholder:"Enter album name"})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["File will be named as: ",p()]})]}),e.jsx(L,{value:"custom",className:"space-y-4 mt-4",children:e.jsxs("div",{children:[e.jsx(P,{htmlFor:"customFileName",children:"File Name"}),e.jsx(M,{id:"customFileName",value:f,onChange:d=>j(d.target.value),placeholder:"Enter file name"})]})})]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(We,{id:"lazy-load",checked:E,onCheckedChange:d=>D(!!d)}),e.jsx(P,{htmlFor:"lazy-load",children:"Enable Lazy Loading for Images"})]}),a.length>0&&e.jsxs(G,{className:"border-green-200",children:[e.jsxs(K,{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),"Image Detection"]}),e.jsxs(X,{children:["Detected ",a.length," image link(s). Only the image URLs will be processed."]})]}),C&&e.jsxs(G,{variant:C.type==="error"?"destructive":"default",className:C.type==="error"?"bg-red-50":"",children:[e.jsx(K,{children:C.type==="error"?"Error":"Success"}),e.jsx(X,{children:C.text})]})]})}),e.jsx(L,{value:"preview",className:"border-t",children:e.jsxs("div",{className:"p-4 rounded-md min-h-80 overflow-auto flex",children:[" ",e.jsxs("div",{className:"w-full rounded-md shadow-sm mr-0",children:[" "," ",be()]})]})})]}),e.jsxs(we,{className:"flex justify-between border-t p-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[h.length," file(s) saved in browser storage"]}),e.jsxs("div",{className:"flex space-x-2",children:[" ",e.jsxs(q,{variant:"outline",onClick:fe,disabled:!t.trim(),className:"flex items-center gap-2 w-24 justify-center",children:[e.jsx($e,{size:16}),"Download"]}),e.jsxs(q,{onClick:pe,disabled:S||!t.trim(),className:"flex items-center gap-2 w-24 justify-center",children:[S?e.jsx(ye,{className:"h-4 w-4 animate-spin"}):e.jsx(O,{size:16}),"Upload"]})]})]})]})]})]})};export{lt as default};
