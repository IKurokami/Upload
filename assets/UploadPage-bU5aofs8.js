import{c as M,r as s,u as ce,j as e,a as ie,L as de,B as O,b as me}from"./index-ImkOsJzG.js";import{C as ue,b as he,c as xe,a as pe,d as ge}from"./card-D_-TSsK_.js";import{C as be,T as A,a as z,b as E,c as L}from"./tabs-hhZm1yRi.js";import{T as fe,L as R,S as ve,a as V,b as K,c as X,d as Y}from"./separator-CeTht1x_.js";import{u as je,c as ye,P as W,a as Z,b as ke,I as $}from"./index-DAT3OwXg.js";import{A as G,a as J,b as Q}from"./alert-OuqCM6y-.js";import{u as Ne,E as Ce}from"./index-BJPslMbN.js";import{B as we,U as Se}from"./badge-BC3mvHYM.js";import"./index-aAoXt5Xy.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],Ee=M("Code",Te);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Fe=M("FileDown",Le);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Re=M("ImagePlus",Pe);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],Ie=M("ListChecks",Me);function De(t){const n=s.useRef({value:t,previous:t});return s.useMemo(()=>(n.current.value!==t&&(n.current.previous=n.current.value,n.current.value=t),n.current.previous),[t])}var B="Checkbox",[Ae,tt]=ye(B),[ze,$e]=Ae(B),ee=s.forwardRef((t,n)=>{const{__scopeCheckbox:r,name:u,checked:h,defaultChecked:m,required:g,disabled:b,value:N="on",onCheckedChange:F,form:f,...P}=t,[x,w]=s.useState(null),S=ce(n,i=>w(i)),v=s.useRef(!1),j=x?f||!!x.closest("form"):!0,[c=!1,C]=je({prop:h,defaultProp:m,onChange:F}),I=s.useRef(c);return s.useEffect(()=>{const i=x==null?void 0:x.form;if(i){const y=()=>C(I.current);return i.addEventListener("reset",y),()=>i.removeEventListener("reset",y)}},[x,C]),e.jsxs(ze,{scope:r,state:c,disabled:b,children:[e.jsx(W.button,{type:"button",role:"checkbox","aria-checked":k(c)?"mixed":c,"aria-required":g,"data-state":ae(c),"data-disabled":b?"":void 0,disabled:b,value:N,...P,ref:S,onKeyDown:Z(t.onKeyDown,i=>{i.key==="Enter"&&i.preventDefault()}),onClick:Z(t.onClick,i=>{C(y=>k(y)?!0:!y),j&&(v.current=i.isPropagationStopped(),v.current||i.stopPropagation())})}),j&&e.jsx(Be,{control:x,bubbles:!v.current,name:u,value:N,checked:c,required:g,disabled:b,form:f,style:{transform:"translateX(-100%)"},defaultChecked:k(m)?!1:m})]})});ee.displayName=B;var te="CheckboxIndicator",se=s.forwardRef((t,n)=>{const{__scopeCheckbox:r,forceMount:u,...h}=t,m=$e(te,r);return e.jsx(ke,{present:u||k(m.state)||m.state===!0,children:e.jsx(W.span,{"data-state":ae(m.state),"data-disabled":m.disabled?"":void 0,...h,ref:n,style:{pointerEvents:"none",...t.style}})})});se.displayName=te;var Be=t=>{const{control:n,checked:r,bubbles:u=!0,defaultChecked:h,...m}=t,g=s.useRef(null),b=De(r),N=Ne(n);s.useEffect(()=>{const f=g.current,P=window.HTMLInputElement.prototype,w=Object.getOwnPropertyDescriptor(P,"checked").set;if(b!==r&&w){const S=new Event("click",{bubbles:u});f.indeterminate=k(r),w.call(f,k(r)?!1:r),f.dispatchEvent(S)}},[b,r,u]);const F=s.useRef(k(r)?!1:r);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:h??F.current,...m,tabIndex:-1,ref:g,style:{...t.style,...N,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function k(t){return t==="indeterminate"}function ae(t){return k(t)?"indeterminate":t?"checked":"unchecked"}var He=ee,_e=se;function Ue({className:t,...n}){return e.jsx(He,{"data-slot":"checkbox",className:ie("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",t),...n,children:e.jsx(_e,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(be,{className:"size-3.5"})})})}const st=()=>{const[t,n]=s.useState(""),[r,u]=s.useState([]),[h,m]=s.useState("Album"),[g,b]=s.useState("1"),[N,F]=s.useState("my-file.html"),[f,P]=s.useState("chapter"),[x,w]=s.useState([]),[S,v]=s.useState(!1),[j,c]=s.useState(null),[C,I]=s.useState(!0),[i,y]=s.useState("visual");s.useEffect(()=>{if(t.trim()){const a=/<img[^>]+src="([^">]+)"/g;let o;const l=[];for(;(o=a.exec(t))!==null;)l.push(o[1]);if(l.length>0)u(l);else{const d=/https?:\/\/[^\s]+\.(jpg|jpeg|png|gif|webp|svg)/gi,p=t.match(d)||[];u(p)}}else u([])},[t]);const D=()=>f==="chapter"?`${g} - ${h}.html`:N;s.useEffect(()=>{(async()=>{const o=indexedDB.open("htmlEditorDB",1);o.onerror=l=>{console.error("IndexedDB error:",l.target.error)},o.onupgradeneeded=l=>{const d=l.target.result;d.objectStoreNames.contains("htmlFiles")||d.createObjectStore("htmlFiles",{keyPath:"id",autoIncrement:!0})},o.onsuccess=l=>{const d=l.target.result;H(d)}})()},[]);const H=a=>{const d=a.transaction(["htmlFiles"],"readonly").objectStore("htmlFiles").getAll();d.onsuccess=()=>{w(d.result)}},re=()=>{v(!0);const a=indexedDB.open("htmlEditorDB",1);a.onsuccess=o=>{const l=o.target.result,p=l.transaction(["htmlFiles"],"readwrite").objectStore("htmlFiles"),T=f==="chapter"?`${g} - ${h}`:h,U=p.getAll();U.onsuccess=()=>{if(U.result.some(le=>le.albumName===T)){v(!1),c({type:"error",text:"Album name already exists. Please choose a different name."}),setTimeout(()=>c(null),3e3);return}const oe={albumName:T,imageUrls:r,createdAt:new Date().toISOString()},q=p.add(oe);q.onsuccess=()=>{v(!1),c({type:"success",text:"Album saved successfully!"}),H(l),setTimeout(()=>c(null),3e3)},q.onerror=()=>{v(!1),c({type:"error",text:"Failed to save album."}),setTimeout(()=>c(null),3e3)}}}},ne=()=>{const a=r.length>0?r.map(T=>`<img src="${T}" alt="" ${C?'loading="lazy"':""}>`).join(`
`):t,o=`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${D()}</title>
    <style>
        body { background: #f2f2f2; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        img { max-width: 100%; height: auto; object-fit: contain; object-position: top center;} 
    </style>
</head>
<body class="container">
    ${a.split(`
`).map(T=>`${T}`).join(`
`)}
</body>
</html>`,l=new Blob([o],{type:"text/html"}),d=URL.createObjectURL(l),p=document.createElement("a");p.href=d,p.download=D(),document.body.appendChild(p),p.click(),setTimeout(()=>{document.body.removeChild(p),URL.revokeObjectURL(d)},100)},_=()=>{if(i==="visual")return r.length>0?e.jsx("div",{className:"flex flex-col items-center",children:r.map((a,o)=>e.jsx("img",{src:a,alt:`Image ${o+1}`,className:"max-w-full h-auto"},a))}):e.jsx("div",{dangerouslySetInnerHTML:{__html:t},className:"prose dark:prose-invert max-w-none"});{const a=r.length>0?r.map(o=>`<img src="${o}" alt="" ${C?'loading="lazy"':""}>`).join(`
`):t;return e.jsx("pre",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-md overflow-auto",children:e.jsx("code",{className:"text-sm font-mono",children:a})})}};return e.jsx("div",{className:"container mx-auto p-4",children:e.jsxs(ue,{className:"shadow-lg",children:[e.jsxs(he,{children:[e.jsxs(xe,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(Re,{size:24,className:"text-blue-600"}),"HTML Image Uploader"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Create HTML files from image links or HTML content."})]}),e.jsx(pe,{children:e.jsxs(A,{defaultValue:"edit",className:"w-full space-y-4",children:[e.jsxs(z,{className:"grid grid-cols-2",children:[e.jsxs(E,{value:"edit",className:"flex items-center gap-2",children:[e.jsx(Ee,{size:16})," Editor"]}),e.jsxs(E,{value:"preview",className:"flex items-center gap-2",children:[e.jsx(Ce,{size:16})," Preview"]})]}),e.jsxs(L,{value:"edit",children:[e.jsx(fe,{className:"min-h-[150px] font-mono text-sm",value:t,onChange:a=>n(a.target.value),placeholder:"Paste your HTML or image links here..."}),e.jsxs("div",{className:"flex items-center space-x-2 my-4",children:[e.jsx(Ue,{id:"lazy-load",checked:C,onCheckedChange:a=>I(!!a)}),e.jsx(R,{htmlFor:"lazy-load",children:"Enable Lazy Loading for Images"})]}),e.jsx(ve,{className:"my-4"}),e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"File Naming"}),e.jsxs(A,{defaultValue:"chapter",onValueChange:P,className:"mb-4",children:[e.jsxs(z,{className:"grid grid-cols-2 w-full",children:[e.jsx(E,{value:"chapter",children:"Chapter + Album"}),e.jsx(E,{value:"custom",children:"Custom Name"})]}),e.jsx(L,{value:"chapter",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(R,{className:"my-2",htmlFor:"chapterNumber",children:"Chapter Number"}),e.jsx($,{id:"chapterNumber",value:g,onChange:a=>b(a.target.value),placeholder:"Enter chapter number"})]}),e.jsxs("div",{children:[e.jsx(R,{className:"my-2",htmlFor:"albumName",children:"Album Name"}),e.jsx($,{id:"albumName",value:h,onChange:a=>m(a.target.value),placeholder:"Enter album name"})]})]})}),e.jsx(L,{value:"custom",className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(R,{className:"my-2",htmlFor:"customFileName",children:"File Name"}),e.jsx($,{id:"customFileName",value:N,onChange:a=>F(a.target.value),placeholder:"Enter file name"})]})})]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["File will be named as:"," ",e.jsx(we,{variant:"secondary",children:D()})]}),r.length>0&&e.jsxs(G,{className:"border-green-500 bg-green-50 dark:bg-green-900 dark:border-green-400",children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"text-green-600 dark:text-green-300"}),"Image Detection"]}),e.jsxs(Q,{children:["Detected ",r.length," image link(s). Only the image URLs will be processed."]})]})]}),e.jsx(L,{value:"preview",children:e.jsxs(A,{defaultValue:"visual",className:"w-full space-y-4",children:[e.jsxs(z,{className:"grid grid-cols-2",children:[e.jsx(E,{value:"visual",onClick:()=>y("visual"),children:"Visual Preview"}),e.jsx(E,{value:"code",onClick:()=>y("code"),children:"Code Preview"})]}),e.jsx(L,{value:"visual",children:_()}),e.jsx(L,{value:"code",children:_()})]})})]})}),e.jsxs(ge,{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[x.length," file(s) saved in browser storage."," ",e.jsx(de,{to:"/albums",className:"text-blue-500 hover:underline",children:"View Albums"})]}),e.jsxs("div",{children:[j&&e.jsxs(G,{variant:j.type==="error"?"destructive":"default",className:`mb-4 ${j.type==="error"?"bg-red-50 dark:bg-red-900":"bg-green-50 dark:bg-green-900"}`,children:[e.jsx(J,{children:j.type==="error"?"Error":"Success"}),e.jsx(Q,{children:j.text})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(V,{children:e.jsxs(K,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(O,{variant:"outline",onClick:ne,disabled:!t.trim(),className:"w-32",children:[e.jsx(Fe,{size:16,className:"mr-2"}),"Download"]})}),e.jsx(Y,{children:e.jsx("p",{children:"Download the generated HTML file"})})]})}),e.jsx(V,{children:e.jsxs(K,{children:[e.jsx(X,{asChild:!0,children:e.jsxs(O,{onClick:re,disabled:S||!t.trim(),className:"w-32",children:[S?e.jsx(me,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Se,{size:16,className:"mr-2"}),"Upload"]})}),e.jsx(Y,{children:e.jsx("p",{children:"Save the album to browser storage"})})]})})]})]})]})]})})};export{st as default};
