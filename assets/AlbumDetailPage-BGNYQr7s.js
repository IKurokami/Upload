import{c as M,k as R,r as l,j as e,L as w,g as I,B as h}from"./index-RCUVdnZG.js";import{C as b,b as j,c as p,a as g,d as f,e as q}from"./card-CWL82PV-.js";import{A as B,a as E,b as L,L as F,T as H}from"./alert-BT5ybd4u.js";import{E as m,I as V}from"./input-BkS6dkE6.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],_=M("Save",P),Q=()=>{const{albumId:x}=R(),[a,N]=l.useState(null),[T,u]=l.useState(!0),[v,A]=l.useState(""),[y,D]=l.useState(""),[S,c]=l.useState(!1),[i,t]=l.useState(null);l.useEffect(()=>{x&&(async()=>{u(!0);const d=indexedDB.open("htmlEditorDB",1);d.onsuccess=s=>{const o=s.target.result.transaction(["htmlFiles"],"readonly").objectStore("htmlFiles").get(parseInt(x,10));o.onsuccess=()=>{const r=o.result;r?(N(r),A(r.albumName),D(r.imageUrls.join(`
`))):console.error("Album not found"),u(!1)},o.onerror=()=>{console.error("Error loading album from IndexedDB"),u(!1)}},d.onerror=s=>{console.error("IndexedDB error:",s.target.error),u(!1)}})()},[x]);const U=async()=>{if(c(!0),t(null),!a||!a.id){t({type:"error",text:"Album ID not found."}),c(!1);return}const n=y.split(`
`).filter(s=>s.trim()!==""),d=indexedDB.open("htmlEditorDB",1);d.onsuccess=s=>{const C=s.target.result.transaction(["htmlFiles"],"readwrite").objectStore("htmlFiles"),o={id:a.id,albumName:v,imageUrls:n,createdAt:a.createdAt},r=C.put(o);r.onsuccess=()=>{c(!1),t({type:"success",text:"Album updated successfully!"}),N(o),setTimeout(()=>t(null),3e3)},r.onerror=()=>{c(!1),t({type:"error",text:"Failed to update album."}),setTimeout(()=>t(null),3e3)}},d.onerror=s=>{console.error("IndexedDB error:",s.target.error),c(!1),t({type:"error",text:"Failed to connect to database."}),setTimeout(()=>t(null),3e3)}};return T?e.jsx("div",{className:"container mx-auto p-4 max-w-4xl",children:e.jsxs(b,{className:"shadow-lg",children:[e.jsx(j,{children:e.jsxs(p,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(m,{size:24,className:"text-blue-600"}),"Album Detail"]})}),e.jsxs(g,{className:"p-4 flex justify-center items-center",children:[e.jsx(w,{className:"h-6 w-6 animate-spin"})," Loading album details..."]})]})}):a?e.jsx("div",{className:"container mx-auto p-4 max-w-4xl",children:e.jsxs(b,{className:"shadow-lg",children:[e.jsxs(j,{children:[e.jsxs(p,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(m,{size:24,className:"text-blue-600"}),"Album Detail"]}),e.jsx(q,{children:"View and update album details."})]}),e.jsxs(g,{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"albumName",children:"Album Name"}),e.jsx(V,{id:"albumName",value:v,onChange:n=>A(n.target.value),placeholder:"Album Name"})]}),e.jsxs("div",{children:[e.jsx(F,{htmlFor:"imageUrls",children:"Image URLs"}),e.jsx(H,{id:"imageUrls",value:y,onChange:n=>D(n.target.value),placeholder:"Enter image URLs, one per line",className:"min-h-40 font-mono text-sm"})]}),i&&e.jsxs(B,{variant:i.type==="error"?"destructive":"default",className:i.type==="error"?"bg-red-50":"bg-blue-50",children:[e.jsx(E,{children:i.type==="error"?"Error":"Success"}),e.jsx(L,{children:i.text})]})]}),e.jsxs(f,{className:"flex justify-between p-4 border-t",children:[e.jsxs(I,{to:"/albums",children:[" ",e.jsxs(h,{variant:"outline",children:[e.jsx(m,{size:16,className:"mr-2"}),"Back to Albums"]})]}),e.jsxs(h,{onClick:U,disabled:S,className:"flex items-center gap-2",children:[S?e.jsx(w,{className:"h-4 w-4 animate-spin"}):e.jsx(_,{size:16}),"Save Changes"]})]}),e.jsx(f,{className:"p-4",children:e.jsxs("div",{className:"text-sm text-gray-500",children:["Created at: ",a?new Date(a.createdAt).toLocaleDateString():"N/A"]})})]})}):e.jsx("div",{className:"container mx-auto p-4 max-w-4xl",children:e.jsxs(b,{className:"shadow-lg",children:[e.jsx(j,{children:e.jsxs(p,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(m,{size:24,className:"text-blue-600"}),"Album Detail"]})}),e.jsx(g,{className:"p-4",children:e.jsxs(B,{variant:"destructive",children:[e.jsx(E,{children:"Error"}),e.jsx(L,{children:"Album not found."})]})}),e.jsx(f,{className:"p-4 border-t",children:e.jsxs(I,{to:"/albums",children:[" ",e.jsxs(h,{variant:"outline",children:[e.jsx(m,{size:16,className:"mr-2"}),"Back to Albums"]})]})})]})})};export{Q as default};
