import{R as C,u as M,j as m,S as D,r as l}from"./index-WgvW7qno.js";import{c as G,h as $,P as j,a as x,e as J,u as Q,d as W}from"./index-ByFW4FAC.js";function X(e){const r=e+"CollectionProvider",[a,n]=G(r),[w,I]=a(r,{collectionRef:{current:null},itemMap:new Map}),b=f=>{const{scope:t,children:c}=f,d=C.useRef(null),o=C.useRef(new Map).current;return m.jsx(w,{scope:t,itemMap:o,collectionRef:d,children:c})};b.displayName=r;const g=e+"CollectionSlot",p=C.forwardRef((f,t)=>{const{scope:c,children:d}=f,o=I(g,c),s=M(t,o.collectionRef);return m.jsx(D,{ref:s,children:d})});p.displayName=g;const u=e+"CollectionItemSlot",E="data-radix-collection-item",F=C.forwardRef((f,t)=>{const{scope:c,children:d,...o}=f,s=C.useRef(null),S=M(t,s),T=I(u,c);return C.useEffect(()=>(T.itemMap.set(s,{ref:s,...o}),()=>void T.itemMap.delete(s))),m.jsx(D,{[E]:"",ref:S,children:d})});F.displayName=u;function v(f){const t=I(e+"CollectionConsumer",f);return C.useCallback(()=>{const d=t.collectionRef.current;if(!d)return[];const o=Array.from(d.querySelectorAll(`[${E}]`));return Array.from(t.itemMap.values()).sort((T,A)=>o.indexOf(T.ref.current)-o.indexOf(A.ref.current))},[t.collectionRef,t.itemMap])}return[{Provider:b,Slot:p,ItemSlot:F},v,n]}var h="rovingFocusGroup.onEntryFocus",Z={bubbles:!1,cancelable:!0},_="RovingFocusGroup",[N,L,ee]=X(_),[te,de]=G(_,[ee]),[oe,re]=te(_),K=l.forwardRef((e,r)=>m.jsx(N.Provider,{scope:e.__scopeRovingFocusGroup,children:m.jsx(N.Slot,{scope:e.__scopeRovingFocusGroup,children:m.jsx(ne,{...e,ref:r})})}));K.displayName=_;var ne=l.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:a,orientation:n,loop:w=!1,dir:I,currentTabStopId:b,defaultCurrentTabStopId:g,onCurrentTabStopIdChange:p,onEntryFocus:u,preventScrollOnEntryFocus:E=!1,...F}=e,v=l.useRef(null),f=M(r,v),t=J(I),[c=null,d]=Q({prop:b,defaultProp:g,onChange:p}),[o,s]=l.useState(!1),S=W(u),T=L(a),A=l.useRef(!1),[V,P]=l.useState(0);return l.useEffect(()=>{const i=v.current;if(i)return i.addEventListener(h,S),()=>i.removeEventListener(h,S)},[S]),m.jsx(oe,{scope:a,orientation:n,dir:t,loop:w,currentTabStopId:c,onItemFocus:l.useCallback(i=>d(i),[d]),onItemShiftTab:l.useCallback(()=>s(!0),[]),onFocusableItemAdd:l.useCallback(()=>P(i=>i+1),[]),onFocusableItemRemove:l.useCallback(()=>P(i=>i-1),[]),children:m.jsx(j.div,{tabIndex:o||V===0?-1:0,"data-orientation":n,...F,ref:f,style:{outline:"none",...e.style},onMouseDown:x(e.onMouseDown,()=>{A.current=!0}),onFocus:x(e.onFocus,i=>{const Y=!A.current;if(i.target===i.currentTarget&&Y&&!o){const O=new CustomEvent(h,Z);if(i.currentTarget.dispatchEvent(O),!O.defaultPrevented){const y=T().filter(R=>R.focusable),H=y.find(R=>R.active),q=y.find(R=>R.id===c),z=[H,q,...y].filter(Boolean).map(R=>R.ref.current);B(z,E)}}A.current=!1}),onBlur:x(e.onBlur,()=>s(!1))})})}),k="RovingFocusGroupItem",U=l.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:a,focusable:n=!0,active:w=!1,tabStopId:I,...b}=e,g=$(),p=I||g,u=re(k,a),E=u.currentTabStopId===p,F=L(a),{onFocusableItemAdd:v,onFocusableItemRemove:f}=u;return l.useEffect(()=>{if(n)return v(),()=>f()},[n,v,f]),m.jsx(N.ItemSlot,{scope:a,id:p,focusable:n,active:w,children:m.jsx(j.span,{tabIndex:E?0:-1,"data-orientation":u.orientation,...b,ref:r,onMouseDown:x(e.onMouseDown,t=>{n?u.onItemFocus(p):t.preventDefault()}),onFocus:x(e.onFocus,()=>u.onItemFocus(p)),onKeyDown:x(e.onKeyDown,t=>{if(t.key==="Tab"&&t.shiftKey){u.onItemShiftTab();return}if(t.target!==t.currentTarget)return;const c=ae(t,u.orientation,u.dir);if(c!==void 0){if(t.metaKey||t.ctrlKey||t.altKey||t.shiftKey)return;t.preventDefault();let o=F().filter(s=>s.focusable).map(s=>s.ref.current);if(c==="last")o.reverse();else if(c==="prev"||c==="next"){c==="prev"&&o.reverse();const s=o.indexOf(t.currentTarget);o=u.loop?ue(o,s+1):o.slice(s+1)}setTimeout(()=>B(o))}})})})});U.displayName=k;var se={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ce(e,r){return r!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function ae(e,r,a){const n=ce(e.key,a);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return se[n]}function B(e,r=!1){const a=document.activeElement;for(const n of e)if(n===a||(n.focus({preventScroll:r}),document.activeElement!==a))return}function ue(e,r){return e.map((a,n)=>e[(r+n)%e.length])}var me=K,pe=U;export{pe as I,me as R,de as a,X as c};
