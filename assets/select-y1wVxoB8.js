import{c as Nt,ap as yt,r as E,A as bt,ah as vn,b as Et,j as C,F as _n,d as An,E as ut,aq as Nn,u as le,ai as we,P as ee,G as bn,e as K,H as On,x as Ot,V as Bn,af as Mn,ak as Fn,ag as Ln,S as Pn,al as Un,J as Dn,K as kn,I as jn,a as xe,C as Gn}from"./index-B2SOdPb6.js";import{c as wt}from"./index-BdQq_4o_.js";import{u as Hn}from"./index-CnqFH--f.js";import{V as $n}from"./index-BJIp35I2.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vn=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Bt=Nt("ChevronDown",Vn);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kn=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Yn=Nt("ChevronUp",Kn);var Je;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})(Je||(Je={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(Xe||(Xe={}));var ze;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(ze||(ze={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qe=["user","model","function","system"];var ye;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(ye||(ye={}));var Ee;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Ee||(Ee={}));var Ze;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Ze||(Ze={}));var et;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(et||(et={}));var Ne;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(Ne||(Ne={}));var tt;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(tt||(tt={}));var nt;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(nt||(nt={}));var rt;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(rt||(rt={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y extends Error{constructor(s){super(`[GoogleGenerativeAI Error]: ${s}`)}}class Re extends Y{constructor(s,o){super(s),this.response=o}}class dt extends Y{constructor(s,o,c,l){super(s),this.status=o,this.statusText=c,this.errorDetails=l}}class fe extends Y{}class ft extends Y{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qn="https://generativelanguage.googleapis.com",Wn="v1beta",Jn="0.24.0",Xn="genai-js";var ve;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})(ve||(ve={}));class zn{constructor(s,o,c,l,f){this.model=s,this.task=o,this.apiKey=c,this.stream=l,this.requestOptions=f}toString(){var s,o;const c=((s=this.requestOptions)===null||s===void 0?void 0:s.apiVersion)||Wn;let f=`${((o=this.requestOptions)===null||o===void 0?void 0:o.baseUrl)||qn}/${c}/${this.model}:${this.task}`;return this.stream&&(f+="?alt=sse"),f}}function Qn(n){const s=[];return n!=null&&n.apiClient&&s.push(n.apiClient),s.push(`${Xn}/${Jn}`),s.join(" ")}async function Zn(n){var s;const o=new Headers;o.append("Content-Type","application/json"),o.append("x-goog-api-client",Qn(n.requestOptions)),o.append("x-goog-api-key",n.apiKey);let c=(s=n.requestOptions)===null||s===void 0?void 0:s.customHeaders;if(c){if(!(c instanceof Headers))try{c=new Headers(c)}catch(l){throw new fe(`unable to convert customHeaders value ${JSON.stringify(c)} to Headers: ${l.message}`)}for(const[l,f]of c.entries()){if(l==="x-goog-api-key")throw new fe(`Cannot set reserved header name ${l}`);if(l==="x-goog-api-client")throw new fe(`Header name ${l} can only be set using the apiClient field`);o.append(l,f)}}return o}async function er(n,s,o,c,l,f){const d=new zn(n,s,o,c,f);return{url:d.toString(),fetchOptions:Object.assign(Object.assign({},or(f)),{method:"POST",headers:await Zn(d),body:l})}}async function De(n,s,o,c,l,f={},d=fetch){const{url:a,fetchOptions:g}=await er(n,s,o,c,l,f);return tr(a,g,d)}async function tr(n,s,o=fetch){let c;try{c=await o(n,s)}catch(l){nr(l,n)}return c.ok||await rr(c,n),c}function nr(n,s){let o=n;throw o.name==="AbortError"?(o=new ft(`Request aborted when fetching ${s.toString()}: ${n.message}`),o.stack=n.stack):n instanceof dt||n instanceof fe||(o=new Y(`Error fetching from ${s.toString()}: ${n.message}`),o.stack=n.stack),o}async function rr(n,s){let o="",c;try{const l=await n.json();o=l.error.message,l.error.details&&(o+=` ${JSON.stringify(l.error.details)}`,c=l.error.details)}catch{}throw new dt(`Error fetching from ${s.toString()}: [${n.status} ${n.statusText}] ${o}`,n.status,n.statusText,c)}function or(n){const s={};if((n==null?void 0:n.signal)!==void 0||(n==null?void 0:n.timeout)>=0){const o=new AbortController;(n==null?void 0:n.timeout)>=0&&setTimeout(()=>o.abort(),n.timeout),n!=null&&n.signal&&n.signal.addEventListener("abort",()=>{o.abort()}),s.signal=o.signal}return s}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),He(n.candidates[0]))throw new Re(`${me(n)}`,n);return ir(n)}else if(n.promptFeedback)throw new Re(`Text not available. ${me(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),He(n.candidates[0]))throw new Re(`${me(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),xt(n)[0]}else if(n.promptFeedback)throw new Re(`Function call not available. ${me(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),He(n.candidates[0]))throw new Re(`${me(n)}`,n);return xt(n)}else if(n.promptFeedback)throw new Re(`Function call not available. ${me(n)}`,n)},n}function ir(n){var s,o,c,l;const f=[];if(!((o=(s=n.candidates)===null||s===void 0?void 0:s[0].content)===null||o===void 0)&&o.parts)for(const d of(l=(c=n.candidates)===null||c===void 0?void 0:c[0].content)===null||l===void 0?void 0:l.parts)d.text&&f.push(d.text),d.executableCode&&f.push("\n```"+d.executableCode.language+`
`+d.executableCode.code+"\n```\n"),d.codeExecutionResult&&f.push("\n```\n"+d.codeExecutionResult.output+"\n```\n");return f.length>0?f.join(""):""}function xt(n){var s,o,c,l;const f=[];if(!((o=(s=n.candidates)===null||s===void 0?void 0:s[0].content)===null||o===void 0)&&o.parts)for(const d of(l=(c=n.candidates)===null||c===void 0?void 0:c[0].content)===null||l===void 0?void 0:l.parts)d.functionCall&&f.push(d.functionCall);if(f.length>0)return f}const sr=[Ne.RECITATION,Ne.SAFETY,Ne.LANGUAGE];function He(n){return!!n.finishReason&&sr.includes(n.finishReason)}function me(n){var s,o,c;let l="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)l+="Response was blocked",!((s=n.promptFeedback)===null||s===void 0)&&s.blockReason&&(l+=` due to ${n.promptFeedback.blockReason}`),!((o=n.promptFeedback)===null||o===void 0)&&o.blockReasonMessage&&(l+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((c=n.candidates)===null||c===void 0)&&c[0]){const f=n.candidates[0];He(f)&&(l+=`Candidate was blocked due to ${f.finishReason}`,f.finishMessage&&(l+=`: ${f.finishMessage}`))}return l}function Pe(n){return this instanceof Pe?(this.v=n,this):new Pe(n)}function ar(n,s,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=o.apply(n,s||[]),l,f=[];return l={},d("next"),d("throw"),d("return"),l[Symbol.asyncIterator]=function(){return this},l;function d(_){c[_]&&(l[_]=function(m){return new Promise(function(x,y){f.push([_,m,x,y])>1||a(_,m)})})}function a(_,m){try{g(c[_](m))}catch(x){v(f[0][3],x)}}function g(_){_.value instanceof Pe?Promise.resolve(_.value.v).then(w,T):v(f[0][2],_)}function w(_){a("next",_)}function T(_){a("throw",_)}function v(_,m){_(m),f.shift(),f.length&&a(f[0][0],f[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const It=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function cr(n){const s=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),o=dr(s),[c,l]=o.tee();return{stream:ur(c),response:lr(l)}}async function lr(n){const s=[],o=n.getReader();for(;;){const{done:c,value:l}=await o.read();if(c)return ht(fr(s));s.push(l)}}function ur(n){return ar(this,arguments,function*(){const o=n.getReader();for(;;){const{value:c,done:l}=yield Pe(o.read());if(l)break;yield yield Pe(ht(c))}})}function dr(n){const s=n.getReader();return new ReadableStream({start(c){let l="";return f();function f(){return s.read().then(({value:d,done:a})=>{if(a){if(l.trim()){c.error(new Y("Failed to parse stream"));return}c.close();return}l+=d;let g=l.match(It),w;for(;g;){try{w=JSON.parse(g[1])}catch{c.error(new Y(`Error parsing JSON response: "${g[1]}"`));return}c.enqueue(w),l=l.substring(g[0].length),g=l.match(It)}return f()}).catch(d=>{let a=d;throw a.stack=d.stack,a.name==="AbortError"?a=new ft("Request aborted when reading from the stream"):a=new Y("Error reading from the stream"),a})}}})}function fr(n){const s=n[n.length-1],o={promptFeedback:s==null?void 0:s.promptFeedback};for(const c of n){if(c.candidates){let l=0;for(const f of c.candidates)if(o.candidates||(o.candidates=[]),o.candidates[l]||(o.candidates[l]={index:l}),o.candidates[l].citationMetadata=f.citationMetadata,o.candidates[l].groundingMetadata=f.groundingMetadata,o.candidates[l].finishReason=f.finishReason,o.candidates[l].finishMessage=f.finishMessage,o.candidates[l].safetyRatings=f.safetyRatings,f.content&&f.content.parts){o.candidates[l].content||(o.candidates[l].content={role:f.content.role||"user",parts:[]});const d={};for(const a of f.content.parts)a.text&&(d.text=a.text),a.functionCall&&(d.functionCall=a.functionCall),a.executableCode&&(d.executableCode=a.executableCode),a.codeExecutionResult&&(d.codeExecutionResult=a.codeExecutionResult),Object.keys(d).length===0&&(d.text=""),o.candidates[l].content.parts.push(d)}l++}c.usageMetadata&&(o.usageMetadata=c.usageMetadata)}return o}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mt(n,s,o,c){const l=await De(s,ve.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(o),c);return cr(l)}async function Ft(n,s,o,c){const f=await(await De(s,ve.GENERATE_CONTENT,n,!1,JSON.stringify(o),c)).json();return{response:ht(f)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function Ue(n){let s=[];if(typeof n=="string")s=[{text:n}];else for(const o of n)typeof o=="string"?s.push({text:o}):s.push(o);return hr(s)}function hr(n){const s={role:"user",parts:[]},o={role:"function",parts:[]};let c=!1,l=!1;for(const f of n)"functionResponse"in f?(o.parts.push(f),l=!0):(s.parts.push(f),c=!0);if(c&&l)throw new Y("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!c&&!l)throw new Y("No content is provided for sending chat message.");return c?s:o}function pr(n,s){var o;let c={model:s==null?void 0:s.model,generationConfig:s==null?void 0:s.generationConfig,safetySettings:s==null?void 0:s.safetySettings,tools:s==null?void 0:s.tools,toolConfig:s==null?void 0:s.toolConfig,systemInstruction:s==null?void 0:s.systemInstruction,cachedContent:(o=s==null?void 0:s.cachedContent)===null||o===void 0?void 0:o.name,contents:[]};const l=n.generateContentRequest!=null;if(n.contents){if(l)throw new fe("CountTokensRequest must have one of contents or generateContentRequest, not both.");c.contents=n.contents}else if(l)c=Object.assign(Object.assign({},c),n.generateContentRequest);else{const f=Ue(n);c.contents=[f]}return{generateContentRequest:c}}function Ct(n){let s;return n.contents?s=n:s={contents:[Ue(n)]},n.systemInstruction&&(s.systemInstruction=Lt(n.systemInstruction)),s}function gr(n){return typeof n=="string"||Array.isArray(n)?{content:Ue(n)}:n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],mr={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function yr(n){let s=!1;for(const o of n){const{role:c,parts:l}=o;if(!s&&c!=="user")throw new Y(`First content should be with role 'user', got ${c}`);if(!Qe.includes(c))throw new Y(`Each item should include role field. Got ${c} but valid roles are: ${JSON.stringify(Qe)}`);if(!Array.isArray(l))throw new Y("Content should have 'parts' property with an array of Parts");if(l.length===0)throw new Y("Each Content should have at least one part");const f={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const a of l)for(const g of St)g in a&&(f[g]+=1);const d=mr[c];for(const a of St)if(!d.includes(a)&&f[a]>0)throw new Y(`Content with role '${c}' can't contain '${a}' part`);s=!0}}function Tt(n){var s;if(n.candidates===void 0||n.candidates.length===0)return!1;const o=(s=n.candidates[0])===null||s===void 0?void 0:s.content;if(o===void 0||o.parts===void 0||o.parts.length===0)return!1;for(const c of o.parts)if(c===void 0||Object.keys(c).length===0||c.text!==void 0&&c.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rt="SILENT_ERROR";class Pt{constructor(s,o,c,l={}){this.model=o,this.params=c,this._requestOptions=l,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=s,c!=null&&c.history&&(yr(c.history),this._history=c.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(s,o={}){var c,l,f,d,a,g;await this._sendPromise;const w=Ue(s),T={safetySettings:(c=this.params)===null||c===void 0?void 0:c.safetySettings,generationConfig:(l=this.params)===null||l===void 0?void 0:l.generationConfig,tools:(f=this.params)===null||f===void 0?void 0:f.tools,toolConfig:(d=this.params)===null||d===void 0?void 0:d.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(g=this.params)===null||g===void 0?void 0:g.cachedContent,contents:[...this._history,w]},v=Object.assign(Object.assign({},this._requestOptions),o);let _;return this._sendPromise=this._sendPromise.then(()=>Ft(this._apiKey,this.model,T,v)).then(m=>{var x;if(Tt(m.response)){this._history.push(w);const y=Object.assign({parts:[],role:"model"},(x=m.response.candidates)===null||x===void 0?void 0:x[0].content);this._history.push(y)}else{const y=me(m.response);y&&console.warn(`sendMessage() was unsuccessful. ${y}. Inspect response object for details.`)}_=m}),await this._sendPromise,_}async sendMessageStream(s,o={}){var c,l,f,d,a,g;await this._sendPromise;const w=Ue(s),T={safetySettings:(c=this.params)===null||c===void 0?void 0:c.safetySettings,generationConfig:(l=this.params)===null||l===void 0?void 0:l.generationConfig,tools:(f=this.params)===null||f===void 0?void 0:f.tools,toolConfig:(d=this.params)===null||d===void 0?void 0:d.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(g=this.params)===null||g===void 0?void 0:g.cachedContent,contents:[...this._history,w]},v=Object.assign(Object.assign({},this._requestOptions),o),_=Mt(this._apiKey,this.model,T,v);return this._sendPromise=this._sendPromise.then(()=>_).catch(m=>{throw new Error(Rt)}).then(m=>m.response).then(m=>{if(Tt(m)){this._history.push(w);const x=Object.assign({},m.candidates[0].content);x.role||(x.role="model"),this._history.push(x)}else{const x=me(m);x&&console.warn(`sendMessageStream() was unsuccessful. ${x}. Inspect response object for details.`)}}).catch(m=>{m.message!==Rt&&console.error(m)}),_}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Er(n,s,o,c){return(await De(s,ve.COUNT_TOKENS,n,!1,JSON.stringify(o),c)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wr(n,s,o,c){return(await De(s,ve.EMBED_CONTENT,n,!1,JSON.stringify(o),c)).json()}async function xr(n,s,o,c){const l=o.requests.map(d=>Object.assign(Object.assign({},d),{model:s}));return(await De(s,ve.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:l}),c)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(s,o,c={}){this.apiKey=s,this._requestOptions=c,o.model.includes("/")?this.model=o.model:this.model=`models/${o.model}`,this.generationConfig=o.generationConfig||{},this.safetySettings=o.safetySettings||[],this.tools=o.tools,this.toolConfig=o.toolConfig,this.systemInstruction=Lt(o.systemInstruction),this.cachedContent=o.cachedContent}async generateContent(s,o={}){var c;const l=Ct(s),f=Object.assign(Object.assign({},this._requestOptions),o);return Ft(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(c=this.cachedContent)===null||c===void 0?void 0:c.name},l),f)}async generateContentStream(s,o={}){var c;const l=Ct(s),f=Object.assign(Object.assign({},this._requestOptions),o);return Mt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(c=this.cachedContent)===null||c===void 0?void 0:c.name},l),f)}startChat(s){var o;return new Pt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(o=this.cachedContent)===null||o===void 0?void 0:o.name},s),this._requestOptions)}async countTokens(s,o={}){const c=pr(s,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),l=Object.assign(Object.assign({},this._requestOptions),o);return Er(this.apiKey,this.model,c,l)}async embedContent(s,o={}){const c=gr(s),l=Object.assign(Object.assign({},this._requestOptions),o);return wr(this.apiKey,this.model,c,l)}async batchEmbedContents(s,o={}){const c=Object.assign(Object.assign({},this._requestOptions),o);return xr(this.apiKey,this.model,s,c)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(s){this.apiKey=s}getGenerativeModel(s,o){if(!s.model)throw new Y("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new ot(this.apiKey,s,o)}getGenerativeModelFromCachedContent(s,o,c){if(!s.name)throw new fe("Cached content must contain a `name` field.");if(!s.model)throw new fe("Cached content must contain a `model` field.");const l=["model","systemInstruction"];for(const d of l)if(o!=null&&o[d]&&s[d]&&(o==null?void 0:o[d])!==s[d]){if(d==="model"){const a=o.model.startsWith("models/")?o.model.replace("models/",""):o.model,g=s.model.startsWith("models/")?s.model.replace("models/",""):s.model;if(a===g)continue}throw new fe(`Different value for "${d}" specified in modelParams (${o[d]}) and cachedContent (${s[d]})`)}const f=Object.assign(Object.assign({},o),{model:s.model,tools:s.tools,toolConfig:s.toolConfig,systemInstruction:s.systemInstruction,cachedContent:s});return new ot(this.apiKey,f,c)}}const Cr=Object.freeze(Object.defineProperty({__proto__:null,get BlockReason(){return et},ChatSession:Pt,get DynamicRetrievalMode(){return rt},get ExecutableCodeLanguage(){return Xe},get FinishReason(){return Ne},get FunctionCallingMode(){return nt},GenerativeModel:ot,GoogleGenerativeAI:Ir,GoogleGenerativeAIAbortError:ft,GoogleGenerativeAIError:Y,GoogleGenerativeAIFetchError:dt,GoogleGenerativeAIRequestInputError:fe,GoogleGenerativeAIResponseError:Re,get HarmBlockThreshold(){return Ee},get HarmCategory(){return ye},get HarmProbability(){return Ze},get Outcome(){return ze},POSSIBLE_ROLES:Qe,get SchemaType(){return Je},get TaskType(){return tt}},Symbol.toStringTag,{value:"Module"}));var We={},Fe={},vt;function Sr(){if(vt)return Fe;vt=1,Fe.byteLength=a,Fe.toByteArray=w,Fe.fromByteArray=_;for(var n=[],s=[],o=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,f=c.length;l<f;++l)n[l]=c[l],s[c.charCodeAt(l)]=l;s[45]=62,s[95]=63;function d(m){var x=m.length;if(x%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=m.indexOf("=");y===-1&&(y=x);var S=y===x?0:4-y%4;return[y,S]}function a(m){var x=d(m),y=x[0],S=x[1];return(y+S)*3/4-S}function g(m,x,y){return(x+y)*3/4-y}function w(m){var x,y=d(m),S=y[0],A=y[1],I=new o(g(m,S,A)),R=0,G=A>0?S-4:S,O;for(O=0;O<G;O+=4)x=s[m.charCodeAt(O)]<<18|s[m.charCodeAt(O+1)]<<12|s[m.charCodeAt(O+2)]<<6|s[m.charCodeAt(O+3)],I[R++]=x>>16&255,I[R++]=x>>8&255,I[R++]=x&255;return A===2&&(x=s[m.charCodeAt(O)]<<2|s[m.charCodeAt(O+1)]>>4,I[R++]=x&255),A===1&&(x=s[m.charCodeAt(O)]<<10|s[m.charCodeAt(O+1)]<<4|s[m.charCodeAt(O+2)]>>2,I[R++]=x>>8&255,I[R++]=x&255),I}function T(m){return n[m>>18&63]+n[m>>12&63]+n[m>>6&63]+n[m&63]}function v(m,x,y){for(var S,A=[],I=x;I<y;I+=3)S=(m[I]<<16&16711680)+(m[I+1]<<8&65280)+(m[I+2]&255),A.push(T(S));return A.join("")}function _(m){for(var x,y=m.length,S=y%3,A=[],I=16383,R=0,G=y-S;R<G;R+=I)A.push(v(m,R,R+I>G?G:R+I));return S===1?(x=m[y-1],A.push(n[x>>2]+n[x<<4&63]+"==")):S===2&&(x=(m[y-2]<<8)+m[y-1],A.push(n[x>>10]+n[x>>4&63]+n[x<<2&63]+"=")),A.join("")}return Fe}var Ge={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var _t;function Tr(){return _t||(_t=1,Ge.read=function(n,s,o,c,l){var f,d,a=l*8-c-1,g=(1<<a)-1,w=g>>1,T=-7,v=o?l-1:0,_=o?-1:1,m=n[s+v];for(v+=_,f=m&(1<<-T)-1,m>>=-T,T+=a;T>0;f=f*256+n[s+v],v+=_,T-=8);for(d=f&(1<<-T)-1,f>>=-T,T+=c;T>0;d=d*256+n[s+v],v+=_,T-=8);if(f===0)f=1-w;else{if(f===g)return d?NaN:(m?-1:1)*(1/0);d=d+Math.pow(2,c),f=f-w}return(m?-1:1)*d*Math.pow(2,f-c)},Ge.write=function(n,s,o,c,l,f){var d,a,g,w=f*8-l-1,T=(1<<w)-1,v=T>>1,_=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=c?0:f-1,x=c?1:-1,y=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(a=isNaN(s)?1:0,d=T):(d=Math.floor(Math.log(s)/Math.LN2),s*(g=Math.pow(2,-d))<1&&(d--,g*=2),d+v>=1?s+=_/g:s+=_*Math.pow(2,1-v),s*g>=2&&(d++,g/=2),d+v>=T?(a=0,d=T):d+v>=1?(a=(s*g-1)*Math.pow(2,l),d=d+v):(a=s*Math.pow(2,v-1)*Math.pow(2,l),d=0));l>=8;n[o+m]=a&255,m+=x,a/=256,l-=8);for(d=d<<l|a,w+=l;w>0;n[o+m]=d&255,m+=x,d/=256,w-=8);n[o+m-x]|=y*128}),Ge}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var At;function Rr(){return At||(At=1,function(n){const s=Sr(),o=Tr(),c=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=a,n.SlowBuffer=I,n.INSPECT_MAX_BYTES=50;const l=2147483647;n.kMaxLength=l,a.TYPED_ARRAY_SUPPORT=f(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{const r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function d(r){if(r>l)throw new RangeError('The value "'+r+'" is invalid for option "size"');const e=new Uint8Array(r);return Object.setPrototypeOf(e,a.prototype),e}function a(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(r)}return g(r,e,t)}a.poolSize=8192;function g(r,e,t){if(typeof r=="string")return _(r,e);if(ArrayBuffer.isView(r))return x(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(ce(r,ArrayBuffer)||r&&ce(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ce(r,SharedArrayBuffer)||r&&ce(r.buffer,SharedArrayBuffer)))return y(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return a.from(i,e,t);const u=S(r);if(u)return u;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return a.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}a.from=function(r,e,t){return g(r,e,t)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function w(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function T(r,e,t){return w(r),r<=0?d(r):e!==void 0?typeof t=="string"?d(r).fill(e,t):d(r).fill(e):d(r)}a.alloc=function(r,e,t){return T(r,e,t)};function v(r){return w(r),d(r<0?0:A(r)|0)}a.allocUnsafe=function(r){return v(r)},a.allocUnsafeSlow=function(r){return v(r)};function _(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=R(r,e)|0;let i=d(t);const u=i.write(r,e);return u!==t&&(i=i.slice(0,u)),i}function m(r){const e=r.length<0?0:A(r.length)|0,t=d(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function x(r){if(ce(r,Uint8Array)){const e=new Uint8Array(r);return y(e.buffer,e.byteOffset,e.byteLength)}return m(r)}function y(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,a.prototype),i}function S(r){if(a.isBuffer(r)){const e=A(r.length)|0,t=d(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||qe(r.length)?d(0):m(r);if(r.type==="Buffer"&&Array.isArray(r.data))return m(r.data)}function A(r){if(r>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return r|0}function I(r){return+r!=r&&(r=0),a.alloc(+r)}a.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==a.prototype},a.compare=function(e,t){if(ce(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),ce(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,u=t.length;for(let h=0,p=Math.min(i,u);h<p;++h)if(e[h]!==t[h]){i=e[h],u=t[h];break}return i<u?-1:u<i?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return a.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;const u=a.allocUnsafe(t);let h=0;for(i=0;i<e.length;++i){let p=e[i];if(ce(p,Uint8Array))h+p.length>u.length?(a.isBuffer(p)||(p=a.from(p)),p.copy(u,h)):Uint8Array.prototype.set.call(u,p,h);else if(a.isBuffer(p))p.copy(u,h);else throw new TypeError('"list" argument must be an Array of Buffers');h+=p.length}return u};function R(r,e){if(a.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||ce(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let u=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Te(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return mt(r).length;default:if(u)return i?-1:Te(r).length;e=(""+e).toLowerCase(),u=!0}}a.byteLength=R;function G(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return ae(this,e,t);case"utf8":case"utf-8":return z(this,e,t);case"ascii":return Z(this,e,t);case"latin1":case"binary":return re(this,e,t);case"base64":return se(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oe(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}a.prototype._isBuffer=!0;function O(r,e,t){const i=r[e];r[e]=r[t],r[t]=i}a.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)O(this,t,t+1);return this},a.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)O(this,t,t+3),O(this,t+1,t+2);return this},a.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)O(this,t,t+7),O(this,t+1,t+6),O(this,t+2,t+5),O(this,t+3,t+4);return this},a.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?z(this,0,e):G.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:a.compare(this,e)===0},a.prototype.inspect=function(){let e="";const t=n.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},c&&(a.prototype[c]=a.prototype.inspect),a.prototype.compare=function(e,t,i,u,h){if(ce(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),u===void 0&&(u=0),h===void 0&&(h=this.length),t<0||i>e.length||u<0||h>this.length)throw new RangeError("out of range index");if(u>=h&&t>=i)return 0;if(u>=h)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,u>>>=0,h>>>=0,this===e)return 0;let p=h-u,b=i-t;const k=Math.min(p,b),U=this.slice(u,h),j=e.slice(t,i);for(let L=0;L<k;++L)if(U[L]!==j[L]){p=U[L],b=j[L];break}return p<b?-1:b<p?1:0};function he(r,e,t,i,u){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,qe(t)&&(t=u?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(u)return-1;t=r.length-1}else if(t<0)if(u)t=0;else return-1;if(typeof e=="string"&&(e=a.from(e,i)),a.isBuffer(e))return e.length===0?-1:$(r,e,t,i,u);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?u?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):$(r,[e],t,i,u);throw new TypeError("val must be string, number or Buffer")}function $(r,e,t,i,u){let h=1,p=r.length,b=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;h=2,p/=2,b/=2,t/=2}function k(j,L){return h===1?j[L]:j.readUInt16BE(L*h)}let U;if(u){let j=-1;for(U=t;U<p;U++)if(k(r,U)===k(e,j===-1?0:U-j)){if(j===-1&&(j=U),U-j+1===b)return j*h}else j!==-1&&(U-=U-j),j=-1}else for(t+b>p&&(t=p-b),U=t;U>=0;U--){let j=!0;for(let L=0;L<b;L++)if(k(r,U+L)!==k(e,L)){j=!1;break}if(j)return U}return-1}a.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1},a.prototype.indexOf=function(e,t,i){return he(this,e,t,i,!0)},a.prototype.lastIndexOf=function(e,t,i){return he(this,e,t,i,!1)};function X(r,e,t,i){t=Number(t)||0;const u=r.length-t;i?(i=Number(i),i>u&&(i=u)):i=u;const h=e.length;i>h/2&&(i=h/2);let p;for(p=0;p<i;++p){const b=parseInt(e.substr(p*2,2),16);if(qe(b))return p;r[t+p]=b}return p}function ie(r,e,t,i){return je(Te(e,r.length-t),r,t,i)}function ue(r,e,t,i){return je(Cn(e),r,t,i)}function te(r,e,t,i){return je(mt(e),r,t,i)}function ne(r,e,t,i){return je(Sn(e,r.length-t),r,t,i)}a.prototype.write=function(e,t,i,u){if(t===void 0)u="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")u=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,u===void 0&&(u="utf8")):(u=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const h=this.length-t;if((i===void 0||i>h)&&(i=h),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");u||(u="utf8");let p=!1;for(;;)switch(u){case"hex":return X(this,e,t,i);case"utf8":case"utf-8":return ie(this,e,t,i);case"ascii":case"latin1":case"binary":return ue(this,e,t,i);case"base64":return te(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,e,t,i);default:if(p)throw new TypeError("Unknown encoding: "+u);u=(""+u).toLowerCase(),p=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function se(r,e,t){return e===0&&t===r.length?s.fromByteArray(r):s.fromByteArray(r.slice(e,t))}function z(r,e,t){t=Math.min(r.length,t);const i=[];let u=e;for(;u<t;){const h=r[u];let p=null,b=h>239?4:h>223?3:h>191?2:1;if(u+b<=t){let k,U,j,L;switch(b){case 1:h<128&&(p=h);break;case 2:k=r[u+1],(k&192)===128&&(L=(h&31)<<6|k&63,L>127&&(p=L));break;case 3:k=r[u+1],U=r[u+2],(k&192)===128&&(U&192)===128&&(L=(h&15)<<12|(k&63)<<6|U&63,L>2047&&(L<55296||L>57343)&&(p=L));break;case 4:k=r[u+1],U=r[u+2],j=r[u+3],(k&192)===128&&(U&192)===128&&(j&192)===128&&(L=(h&15)<<18|(k&63)<<12|(U&63)<<6|j&63,L>65535&&L<1114112&&(p=L))}}p===null?(p=65533,b=1):p>65535&&(p-=65536,i.push(p>>>10&1023|55296),p=56320|p&1023),i.push(p),u+=b}return q(i)}const Q=4096;function q(r){const e=r.length;if(e<=Q)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=Q));return t}function Z(r,e,t){let i="";t=Math.min(r.length,t);for(let u=e;u<t;++u)i+=String.fromCharCode(r[u]&127);return i}function re(r,e,t){let i="";t=Math.min(r.length,t);for(let u=e;u<t;++u)i+=String.fromCharCode(r[u]);return i}function ae(r,e,t){const i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let u="";for(let h=e;h<t;++h)u+=Tn[r[h]];return u}function Oe(r,e,t){const i=r.slice(e,t);let u="";for(let h=0;h<i.length-1;h+=2)u+=String.fromCharCode(i[h]+i[h+1]*256);return u}a.prototype.slice=function(e,t){const i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);const u=this.subarray(e,t);return Object.setPrototypeOf(u,a.prototype),u};function D(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||D(e,t,this.length);let u=this[e],h=1,p=0;for(;++p<t&&(h*=256);)u+=this[e+p]*h;return u},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||D(e,t,this.length);let u=this[e+--t],h=1;for(;t>0&&(h*=256);)u+=this[e+--t]*h;return u},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e=e>>>0,t||D(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||D(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||D(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||D(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=ge(function(e){e=e>>>0,W(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&J(e,this.length-8);const u=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,h=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(u)+(BigInt(h)<<BigInt(32))}),a.prototype.readBigUInt64BE=ge(function(e){e=e>>>0,W(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&J(e,this.length-8);const u=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],h=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(u)<<BigInt(32))+BigInt(h)}),a.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||D(e,t,this.length);let u=this[e],h=1,p=0;for(;++p<t&&(h*=256);)u+=this[e+p]*h;return h*=128,u>=h&&(u-=Math.pow(2,8*t)),u},a.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||D(e,t,this.length);let u=t,h=1,p=this[e+--u];for(;u>0&&(h*=256);)p+=this[e+--u]*h;return h*=128,p>=h&&(p-=Math.pow(2,8*t)),p},a.prototype.readInt8=function(e,t){return e=e>>>0,t||D(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},a.prototype.readInt16LE=function(e,t){e=e>>>0,t||D(e,2,this.length);const i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i},a.prototype.readInt16BE=function(e,t){e=e>>>0,t||D(e,2,this.length);const i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i},a.prototype.readInt32LE=function(e,t){return e=e>>>0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e=e>>>0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=ge(function(e){e=e>>>0,W(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&J(e,this.length-8);const u=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(u)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),a.prototype.readBigInt64BE=ge(function(e){e=e>>>0,W(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&J(e,this.length-8);const u=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(u)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)}),a.prototype.readFloatLE=function(e,t){return e=e>>>0,t||D(e,4,this.length),o.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e=e>>>0,t||D(e,4,this.length),o.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||D(e,8,this.length),o.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||D(e,8,this.length),o.read(this,e,!1,52,8)};function H(r,e,t,i,u,h){if(!a.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>u||e<h)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,i,u){if(e=+e,t=t>>>0,i=i>>>0,!u){const b=Math.pow(2,8*i)-1;H(this,e,t,i,b,0)}let h=1,p=0;for(this[t]=e&255;++p<i&&(h*=256);)this[t+p]=e/h&255;return t+i},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,i,u){if(e=+e,t=t>>>0,i=i>>>0,!u){const b=Math.pow(2,8*i)-1;H(this,e,t,i,b,0)}let h=i-1,p=1;for(this[t+h]=e&255;--h>=0&&(p*=256);)this[t+h]=e/p&255;return t+i},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,1,255,0),this[t]=e&255,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function Ae(r,e,t,i,u){M(e,i,u,r,t,7);let h=Number(e&BigInt(4294967295));r[t++]=h,h=h>>8,r[t++]=h,h=h>>8,r[t++]=h,h=h>>8,r[t++]=h;let p=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=p,p=p>>8,r[t++]=p,p=p>>8,r[t++]=p,p=p>>8,r[t++]=p,t}function de(r,e,t,i,u){M(e,i,u,r,t,7);let h=Number(e&BigInt(4294967295));r[t+7]=h,h=h>>8,r[t+6]=h,h=h>>8,r[t+5]=h,h=h>>8,r[t+4]=h;let p=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=p,p=p>>8,r[t+2]=p,p=p>>8,r[t+1]=p,p=p>>8,r[t]=p,t+8}a.prototype.writeBigUInt64LE=ge(function(e,t=0){return Ae(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=ge(function(e,t=0){return de(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(e,t,i,u){if(e=+e,t=t>>>0,!u){const k=Math.pow(2,8*i-1);H(this,e,t,i,k-1,-k)}let h=0,p=1,b=0;for(this[t]=e&255;++h<i&&(p*=256);)e<0&&b===0&&this[t+h-1]!==0&&(b=1),this[t+h]=(e/p>>0)-b&255;return t+i},a.prototype.writeIntBE=function(e,t,i,u){if(e=+e,t=t>>>0,!u){const k=Math.pow(2,8*i-1);H(this,e,t,i,k-1,-k)}let h=i-1,p=1,b=0;for(this[t+h]=e&255;--h>=0&&(p*=256);)e<0&&b===0&&this[t+h+1]!==0&&(b=1),this[t+h]=(e/p>>0)-b&255;return t+i},a.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},a.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},a.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},a.prototype.writeBigInt64LE=ge(function(e,t=0){return Ae(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=ge(function(e,t=0){return de(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Se(r,e,t,i,u,h){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function pe(r,e,t,i,u){return e=+e,t=t>>>0,u||Se(r,e,t,4),o.write(r,e,t,i,23,4),t+4}a.prototype.writeFloatLE=function(e,t,i){return pe(this,e,t,!0,i)},a.prototype.writeFloatBE=function(e,t,i){return pe(this,e,t,!1,i)};function N(r,e,t,i,u){return e=+e,t=t>>>0,u||Se(r,e,t,8),o.write(r,e,t,i,52,8),t+8}a.prototype.writeDoubleLE=function(e,t,i){return N(this,e,t,!0,i)},a.prototype.writeDoubleBE=function(e,t,i){return N(this,e,t,!1,i)},a.prototype.copy=function(e,t,i,u){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!u&&u!==0&&(u=this.length),t>=e.length&&(t=e.length),t||(t=0),u>0&&u<i&&(u=i),u===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("sourceEnd out of bounds");u>this.length&&(u=this.length),e.length-t<u-i&&(u=e.length-t+i);const h=u-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,u):Uint8Array.prototype.set.call(e,this.subarray(i,u),t),h},a.prototype.fill=function(e,t,i,u){if(typeof e=="string"){if(typeof t=="string"?(u=t,t=0,i=this.length):typeof i=="string"&&(u=i,i=this.length),u!==void 0&&typeof u!="string")throw new TypeError("encoding must be a string");if(typeof u=="string"&&!a.isEncoding(u))throw new TypeError("Unknown encoding: "+u);if(e.length===1){const p=e.charCodeAt(0);(u==="utf8"&&p<128||u==="latin1")&&(e=p)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let h;if(typeof e=="number")for(h=t;h<i;++h)this[h]=e;else{const p=a.isBuffer(e)?e:a.from(e,u),b=p.length;if(b===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(h=0;h<i-t;++h)this[h+t]=p[h%b]}return this};const B={};function V(r,e,t){B[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(u){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:u,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}V("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),V("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),V("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,u=t;return Number.isInteger(t)&&Math.abs(t)>2**32?u=P(String(t)):typeof t=="bigint"&&(u=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(u=P(u)),u+="n"),i+=` It must be ${e}. Received ${u}`,i},RangeError);function P(r){let e="",t=r.length;const i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function F(r,e,t){W(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&J(e,r.length-(t+1))}function M(r,e,t,i,u,h){if(r>t||r<e){const p=typeof e=="bigint"?"n":"";let b;throw e===0||e===BigInt(0)?b=`>= 0${p} and < 2${p} ** ${(h+1)*8}${p}`:b=`>= -(2${p} ** ${(h+1)*8-1}${p}) and < 2 ** ${(h+1)*8-1}${p}`,new B.ERR_OUT_OF_RANGE("value",b,r)}F(i,u,h)}function W(r,e){if(typeof r!="number")throw new B.ERR_INVALID_ARG_TYPE(e,"number",r)}function J(r,e,t){throw Math.floor(r)!==r?(W(r,t),new B.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new B.ERR_BUFFER_OUT_OF_BOUNDS:new B.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}const Be=/[^+/0-9A-Za-z-_]/g;function Me(r){if(r=r.split("=")[0],r=r.trim().replace(Be,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Te(r,e){e=e||1/0;let t;const i=r.length;let u=null;const h=[];for(let p=0;p<i;++p){if(t=r.charCodeAt(p),t>55295&&t<57344){if(!u){if(t>56319){(e-=3)>-1&&h.push(239,191,189);continue}else if(p+1===i){(e-=3)>-1&&h.push(239,191,189);continue}u=t;continue}if(t<56320){(e-=3)>-1&&h.push(239,191,189),u=t;continue}t=(u-55296<<10|t-56320)+65536}else u&&(e-=3)>-1&&h.push(239,191,189);if(u=null,t<128){if((e-=1)<0)break;h.push(t)}else if(t<2048){if((e-=2)<0)break;h.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;h.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;h.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return h}function Cn(r){const e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Sn(r,e){let t,i,u;const h=[];for(let p=0;p<r.length&&!((e-=2)<0);++p)t=r.charCodeAt(p),i=t>>8,u=t%256,h.push(u),h.push(i);return h}function mt(r){return s.toByteArray(Me(r))}function je(r,e,t,i){let u;for(u=0;u<i&&!(u+t>=e.length||u>=r.length);++u)e[u+t]=r[u];return u}function ce(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function qe(r){return r!==r}const Tn=function(){const r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const i=t*16;for(let u=0;u<16;++u)e[i+u]=r[t]+r[u]}return e}();function ge(r){return typeof BigInt>"u"?Rn:r}function Rn(){throw new Error("BigInt not supported")}}(We)),We}var Ut=Rr();typeof window<"u"&&!window.Buffer&&(window.Buffer=Ut.Buffer);const pt=async(n,s,o)=>{try{const{GoogleGenerativeAI:c}=await yt(async()=>{const{GoogleGenerativeAI:S}=await Promise.resolve().then(()=>Cr);return{GoogleGenerativeAI:S}},void 0),{GoogleAIFileManager:l}=await yt(async()=>{const{GoogleAIFileManager:S}=await import("./index-Q9_myv3Q.js");return{GoogleAIFileManager:S}},[]),f={},d=new c(s),a=new l(s),g=[{category:ye.HARM_CATEGORY_HARASSMENT,threshold:Ee.BLOCK_NONE},{category:ye.HARM_CATEGORY_HATE_SPEECH,threshold:Ee.BLOCK_NONE},{category:ye.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Ee.BLOCK_NONE},{category:ye.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Ee.BLOCK_NONE},{category:ye.HARM_CATEGORY_CIVIC_INTEGRITY,threshold:Ee.BLOCK_NONE}],w=[];for(const S of n){const A=await S.arrayBuffer(),I=await a.uploadFile(Ut.Buffer.from(A),{mimeType:S.type,displayName:S.name});w.push({file:I.file,originalFile:S})}const T={model:o.modelName,systemInstruction:o.systemInstruction};o.tools&&Object.assign(T,{tools:o.tools});const v=d.getGenerativeModel(T,f),m=[...w.map(({file:S,originalFile:A})=>({fileData:{mimeType:A.type,fileUri:S.uri}}))];o.chatText&&m.push({text:o.chatText});const x=[{role:"model",parts:[{text:o.systemInstruction}]},{role:"user",parts:m}],y=await v.generateContent({safetySettings:g,contents:x,generationConfig:{...o.generationConfig,responseMimeType:o.responseMimeType||"text/plain"}});return vr(y.response)}catch(c){return console.error("Gemini Error:",c),{thinking:`Error processing the images: ${c.message||"Unknown error"}`,ocrText:`Error processing images. ${c.message||"Please try again."}`,hasError:!0}}};function vr(n){var s;if(n.candidates&&n.candidates.length>0&&((s=n.candidates[0].content.parts[0])!=null&&s.inlineData)){const o=n.candidates[0].content.parts[0].inlineData;return{thinking:"Image processed successfully.",hasError:!1,imageData:`data:${o.mimeType};base64,${o.data}`}}else return n.text&&n.text()?{thinking:"Text processed successfully.",ocrText:n.text(),hasError:!1}:{thinking:"No output generated.",ocrText:"No output generated.",hasError:!0}}const lo=async(n,s,o,c,l)=>pt(n,s,{modelName:o,systemInstruction:c||`The user wants me to extract text from the image(s) and present it as a single line of text for each dialogue bubble.
I need to identify the dialogue bubbles in the image(s) and then use OCR to extract the text from each bubble.
I must ensure the extracted text does not include watermarks like 'Colamanga.com' or 'AcloudMerge.com'.

I must identify and extract each dialogue bubble's text as a single continuous line, even if it has multiple lines inside one bubble.
I must present the extracted text exactly as requested by the user—just the text, with no additional formatting or descriptions. Just text. Everything answer to user is the text inside the image.


`,generationConfig:{temperature:1,topP:.95,topK:64,maxOutputTokens:65536},chatText:"",responseMimeType:"text/plain"}),uo=async(n,s,o,c)=>pt(n,o,{modelName:c,systemInstruction:"You are a helpful assistant that responds to user queries with text, images, or both. If the user provides images, analyze them and respond to any questions about them. If the user provides only text, respond to their questions or statements appropriately. Be concise, helpful, and direct in your responses.",generationConfig:{temperature:.7,topP:.95,topK:32,maxOutputTokens:65536},chatText:s,responseMimeType:"text/plain"}),fo=async(n,s,o,c,l)=>{const f=`
You are a skilled translator that uses the provided mapping table and relationships table to guide your translations.
The mapping table provides specific terms and their translations.
The relationships table describes how characters relate to each other and how they address one another.
Ensure your translation maintains the nuances of these relationships and uses the correct terms from the mapping table.
`,d=`
# TRANSLATE: Mandarin to Vietnamese with Professional Accuracy

Translate Mandarin text into Vietnamese with complete accuracy and cultural nuance by following these comprehensive guidelines:

---

### 🔹 DELIVER precise translations that:

- CAPTURE every single word, preserving the **exact meaning, tone, and nuance** of the original
- MAINTAIN **stylistic fidelity**, including:
  - Formality level (trang trọng, suồng sã, thân mật…)
  - Emotional undertones
  - Cultural or historical references
- ENSURE **pronoun consistency** throughout (e.g. ta, ngươi, người, hắn, nàng, muội, chàng) as appropriate to character and context
- RESPECT the original **sentence structure**, but rewrite for **natural Vietnamese flow** where necessary without losing meaning

---

### 🔹 ENSURE emotional and stylistic authenticity:

- MATCH the original **emotional intensity** — never exaggerate or understate the mood
- REPLICATE the tone precisely — formal stays formal, casual stays casual
- PRESERVE **character-specific speech styles**, such as unique patterns, dialects, or quirks

---

### 🔹 HANDLE names, terms, and references as follows:

- USE **Sino-Vietnamese phonetic transcription** for common historical/cultural nouns if appropriate
- RETAIN **established translations** for character and place names
- PREFER **English equivalents** for Western mythological or biblical references
- DO NOT localize or adapt terms unless required for clarity

---

### 🔹 MAINTAIN contextual and narrative integrity:

- TRANSLATE with attention to the **broader context** — ensure meaning carries across lines and paragraphs
- PRESERVE **subtext and implication**, without adding interpretation or explanation
- DO NOT omit, simplify, or condense the content — translate **everything** as faithfully as possible
- SPLIT long or complex Chinese sentences into manageable Vietnamese ones **without altering their meaning**

---

### 🔹 RELATIONSHIPS & ADDRESS TERMS:

- PRESERVE exact **modes of address** between characters:  
  (e.g. huynh – muội, ngươi – ta, nàng – thiếp, ca – đệ…)
- DISTINGUISH between:
  - **Dialogue speech**
  - **Narration by a character**
  - **Character's internal thoughts**
- ADAPT address and tone appropriately to **each narrative layer** (dialogue, monologue, narration)

---

### 🔹 QUALITY CONTROL CHECKLIST:

- ✅ No omissions – every word is translated
- ✅ No stylistic deviation from original
- ✅ Emotional tone precisely mirrored
- ✅ Consistent vocabulary, names, and pronouns
- ✅ Cultural authenticity maintained

---

## 🔹 AFTER TRANSLATION – PROVIDE COMPLETE TERMINOLOGY MAPPING TABLES:

1. **TERM MAPPING TABLE**:
   After each translation section, include a table listing:

${s||"No mapping table provided."}

   - First include **new proper nouns or terms** introduced in the section
   - Then provide the **COMPLETE UPDATED MAPPING** including all terms from previous sections

2. **RELATIONSHIPS & ADDRESS TERMS TABLE**:
   After each translation section, also include a detailed relationships table:

${o||"No relationships table provided."}

TEXT TO TRANSLATE:
${n}

---

## 🔹 BEFORE TRANSLATION – REQUIRE THE FOLLOWING CONTEXT:

Before beginning the translation:

1. **CONTEXT AND REFERENCE INFORMATION**:  
   
   - Summary of the story or scene  
   - World background if relevant (historical, fantasy, modern…)

2. **ADDRESS RELATIONSHIPS**:  
   
   - Character names, their **genders**, and **relationships** with each other  
   - Specific **ways characters address each other** in:  
     - Dialogue  
     - Narration  
     - Inner thoughts

3. **STYLE & TONE OF NARRATOR**:  
   
   - E.g. omniscient formal narrator, or a character's personal internal monologue  

---
`;return pt([],c,{modelName:l,systemInstruction:f,generationConfig:{temperature:.3,topP:.95,topK:32,maxOutputTokens:65536},chatText:d,responseMimeType:"text/plain"})};var _r=[" ","Enter","ArrowUp","ArrowDown"],Ar=[" ","Enter"],ke="Select",[Ve,Ke,Nr]=Nn(ke),[be,ho]=An(ke,[Nr,bt]),Ye=bt(),[br,Ie]=be(ke),[Or,Br]=be(ke),Dt=n=>{const{__scopeSelect:s,children:o,open:c,defaultOpen:l,onOpenChange:f,value:d,defaultValue:a,onValueChange:g,dir:w,name:T,autoComplete:v,disabled:_,required:m,form:x}=n,y=Ye(s),[S,A]=E.useState(null),[I,R]=E.useState(null),[G,O]=E.useState(!1),he=vn(w),[$=!1,X]=Et({prop:c,defaultProp:l,onChange:f}),[ie,ue]=Et({prop:d,defaultProp:a,onChange:g}),te=E.useRef(null),ne=S?x||!!S.closest("form"):!0,[se,z]=E.useState(new Set),Q=Array.from(se).map(q=>q.props.value).join(";");return C.jsx(_n,{...y,children:C.jsxs(br,{required:m,scope:s,trigger:S,onTriggerChange:A,valueNode:I,onValueNodeChange:R,valueNodeHasChildren:G,onValueNodeHasChildrenChange:O,contentId:ut(),value:ie,onValueChange:ue,open:$,onOpenChange:X,dir:he,triggerPointerDownPosRef:te,disabled:_,children:[C.jsx(Ve.Provider,{scope:s,children:C.jsx(Or,{scope:n.__scopeSelect,onNativeOptionAdd:E.useCallback(q=>{z(Z=>new Set(Z).add(q))},[]),onNativeOptionRemove:E.useCallback(q=>{z(Z=>{const re=new Set(Z);return re.delete(q),re})},[]),children:o})}),ne?C.jsxs(un,{"aria-hidden":!0,required:m,tabIndex:-1,name:T,autoComplete:v,value:ie,onChange:q=>ue(q.target.value),disabled:_,form:x,children:[ie===void 0?C.jsx("option",{value:""}):null,Array.from(se)]},Q):null]})})};Dt.displayName=ke;var kt="SelectTrigger",jt=E.forwardRef((n,s)=>{const{__scopeSelect:o,disabled:c=!1,...l}=n,f=Ye(o),d=Ie(kt,o),a=d.disabled||c,g=le(s,d.onTriggerChange),w=Ke(o),T=E.useRef("touch"),[v,_,m]=dn(y=>{const S=w().filter(R=>!R.disabled),A=S.find(R=>R.value===d.value),I=fn(S,y,A);I!==void 0&&d.onValueChange(I.value)}),x=y=>{a||(d.onOpenChange(!0),m()),y&&(d.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return C.jsx(bn,{asChild:!0,...f,children:C.jsx(ee.button,{type:"button",role:"combobox","aria-controls":d.contentId,"aria-expanded":d.open,"aria-required":d.required,"aria-autocomplete":"none",dir:d.dir,"data-state":d.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":ln(d.value)?"":void 0,...l,ref:g,onClick:K(l.onClick,y=>{y.currentTarget.focus(),T.current!=="mouse"&&x(y)}),onPointerDown:K(l.onPointerDown,y=>{T.current=y.pointerType;const S=y.target;S.hasPointerCapture(y.pointerId)&&S.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(x(y),y.preventDefault())}),onKeyDown:K(l.onKeyDown,y=>{const S=v.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&_(y.key),!(S&&y.key===" ")&&_r.includes(y.key)&&(x(),y.preventDefault())})})})});jt.displayName=kt;var Gt="SelectValue",Ht=E.forwardRef((n,s)=>{const{__scopeSelect:o,className:c,style:l,children:f,placeholder:d="",...a}=n,g=Ie(Gt,o),{onValueNodeHasChildrenChange:w}=g,T=f!==void 0,v=le(s,g.onValueNodeChange);return we(()=>{w(T)},[w,T]),C.jsx(ee.span,{...a,ref:v,style:{pointerEvents:"none"},children:ln(g.value)?C.jsx(C.Fragment,{children:d}):f})});Ht.displayName=Gt;var Mr="SelectIcon",$t=E.forwardRef((n,s)=>{const{__scopeSelect:o,children:c,...l}=n;return C.jsx(ee.span,{"aria-hidden":!0,...l,ref:s,children:c||"▼"})});$t.displayName=Mr;var Fr="SelectPortal",Vt=n=>C.jsx(On,{asChild:!0,...n});Vt.displayName=Fr;var _e="SelectContent",Kt=E.forwardRef((n,s)=>{const o=Ie(_e,n.__scopeSelect),[c,l]=E.useState();if(we(()=>{l(new DocumentFragment)},[]),!o.open){const f=c;return f?Ot.createPortal(C.jsx(Yt,{scope:n.__scopeSelect,children:C.jsx(Ve.Slot,{scope:n.__scopeSelect,children:C.jsx("div",{children:n.children})})}),f):null}return C.jsx(qt,{...n,ref:s})});Kt.displayName=_e;var oe=10,[Yt,Ce]=be(_e),Lr="SelectContentImpl",qt=E.forwardRef((n,s)=>{const{__scopeSelect:o,position:c="item-aligned",onCloseAutoFocus:l,onEscapeKeyDown:f,onPointerDownOutside:d,side:a,sideOffset:g,align:w,alignOffset:T,arrowPadding:v,collisionBoundary:_,collisionPadding:m,sticky:x,hideWhenDetached:y,avoidCollisions:S,...A}=n,I=Ie(_e,o),[R,G]=E.useState(null),[O,he]=E.useState(null),$=le(s,N=>G(N)),[X,ie]=E.useState(null),[ue,te]=E.useState(null),ne=Ke(o),[se,z]=E.useState(!1),Q=E.useRef(!1);E.useEffect(()=>{if(R)return Mn(R)},[R]),Fn();const q=E.useCallback(N=>{const[B,...V]=ne().map(M=>M.ref.current),[P]=V.slice(-1),F=document.activeElement;for(const M of N)if(M===F||(M==null||M.scrollIntoView({block:"nearest"}),M===B&&O&&(O.scrollTop=0),M===P&&O&&(O.scrollTop=O.scrollHeight),M==null||M.focus(),document.activeElement!==F))return},[ne,O]),Z=E.useCallback(()=>q([X,R]),[q,X,R]);E.useEffect(()=>{se&&Z()},[se,Z]);const{onOpenChange:re,triggerPointerDownPosRef:ae}=I;E.useEffect(()=>{if(R){let N={x:0,y:0};const B=P=>{var F,M;N={x:Math.abs(Math.round(P.pageX)-(((F=ae.current)==null?void 0:F.x)??0)),y:Math.abs(Math.round(P.pageY)-(((M=ae.current)==null?void 0:M.y)??0))}},V=P=>{N.x<=10&&N.y<=10?P.preventDefault():R.contains(P.target)||re(!1),document.removeEventListener("pointermove",B),ae.current=null};return ae.current!==null&&(document.addEventListener("pointermove",B),document.addEventListener("pointerup",V,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",V,{capture:!0})}}},[R,re,ae]),E.useEffect(()=>{const N=()=>re(!1);return window.addEventListener("blur",N),window.addEventListener("resize",N),()=>{window.removeEventListener("blur",N),window.removeEventListener("resize",N)}},[re]);const[Oe,D]=dn(N=>{const B=ne().filter(F=>!F.disabled),V=B.find(F=>F.ref.current===document.activeElement),P=fn(B,N,V);P&&setTimeout(()=>P.ref.current.focus())}),H=E.useCallback((N,B,V)=>{const P=!Q.current&&!V;(I.value!==void 0&&I.value===B||P)&&(ie(N),P&&(Q.current=!0))},[I.value]),Ae=E.useCallback(()=>R==null?void 0:R.focus(),[R]),de=E.useCallback((N,B,V)=>{const P=!Q.current&&!V;(I.value!==void 0&&I.value===B||P)&&te(N)},[I.value]),Se=c==="popper"?it:Wt,pe=Se===it?{side:a,sideOffset:g,align:w,alignOffset:T,arrowPadding:v,collisionBoundary:_,collisionPadding:m,sticky:x,hideWhenDetached:y,avoidCollisions:S}:{};return C.jsx(Yt,{scope:o,content:R,viewport:O,onViewportChange:he,itemRefCallback:H,selectedItem:X,onItemLeave:Ae,itemTextRefCallback:de,focusSelectedItem:Z,selectedItemText:ue,position:c,isPositioned:se,searchRef:Oe,children:C.jsx(Ln,{as:Pn,allowPinchZoom:!0,children:C.jsx(Un,{asChild:!0,trapped:I.open,onMountAutoFocus:N=>{N.preventDefault()},onUnmountAutoFocus:K(l,N=>{var B;(B=I.trigger)==null||B.focus({preventScroll:!0}),N.preventDefault()}),children:C.jsx(Dn,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:N=>N.preventDefault(),onDismiss:()=>I.onOpenChange(!1),children:C.jsx(Se,{role:"listbox",id:I.contentId,"data-state":I.open?"open":"closed",dir:I.dir,onContextMenu:N=>N.preventDefault(),...A,...pe,onPlaced:()=>z(!0),ref:$,style:{display:"flex",flexDirection:"column",outline:"none",...A.style},onKeyDown:K(A.onKeyDown,N=>{const B=N.ctrlKey||N.altKey||N.metaKey;if(N.key==="Tab"&&N.preventDefault(),!B&&N.key.length===1&&D(N.key),["ArrowUp","ArrowDown","Home","End"].includes(N.key)){let P=ne().filter(F=>!F.disabled).map(F=>F.ref.current);if(["ArrowUp","End"].includes(N.key)&&(P=P.slice().reverse()),["ArrowUp","ArrowDown"].includes(N.key)){const F=N.target,M=P.indexOf(F);P=P.slice(M+1)}setTimeout(()=>q(P)),N.preventDefault()}})})})})})})});qt.displayName=Lr;var Pr="SelectItemAlignedPosition",Wt=E.forwardRef((n,s)=>{const{__scopeSelect:o,onPlaced:c,...l}=n,f=Ie(_e,o),d=Ce(_e,o),[a,g]=E.useState(null),[w,T]=E.useState(null),v=le(s,$=>T($)),_=Ke(o),m=E.useRef(!1),x=E.useRef(!0),{viewport:y,selectedItem:S,selectedItemText:A,focusSelectedItem:I}=d,R=E.useCallback(()=>{if(f.trigger&&f.valueNode&&a&&w&&y&&S&&A){const $=f.trigger.getBoundingClientRect(),X=w.getBoundingClientRect(),ie=f.valueNode.getBoundingClientRect(),ue=A.getBoundingClientRect();if(f.dir!=="rtl"){const F=ue.left-X.left,M=ie.left-F,W=$.left-M,J=$.width+W,Be=Math.max(J,X.width),Me=window.innerWidth-oe,Te=wt(M,[oe,Math.max(oe,Me-Be)]);a.style.minWidth=J+"px",a.style.left=Te+"px"}else{const F=X.right-ue.right,M=window.innerWidth-ie.right-F,W=window.innerWidth-$.right-M,J=$.width+W,Be=Math.max(J,X.width),Me=window.innerWidth-oe,Te=wt(M,[oe,Math.max(oe,Me-Be)]);a.style.minWidth=J+"px",a.style.right=Te+"px"}const te=_(),ne=window.innerHeight-oe*2,se=y.scrollHeight,z=window.getComputedStyle(w),Q=parseInt(z.borderTopWidth,10),q=parseInt(z.paddingTop,10),Z=parseInt(z.borderBottomWidth,10),re=parseInt(z.paddingBottom,10),ae=Q+q+se+re+Z,Oe=Math.min(S.offsetHeight*5,ae),D=window.getComputedStyle(y),H=parseInt(D.paddingTop,10),Ae=parseInt(D.paddingBottom,10),de=$.top+$.height/2-oe,Se=ne-de,pe=S.offsetHeight/2,N=S.offsetTop+pe,B=Q+q+N,V=ae-B;if(B<=de){const F=te.length>0&&S===te[te.length-1].ref.current;a.style.bottom="0px";const M=w.clientHeight-y.offsetTop-y.offsetHeight,W=Math.max(Se,pe+(F?Ae:0)+M+Z),J=B+W;a.style.height=J+"px"}else{const F=te.length>0&&S===te[0].ref.current;a.style.top="0px";const W=Math.max(de,Q+y.offsetTop+(F?H:0)+pe)+V;a.style.height=W+"px",y.scrollTop=B-de+y.offsetTop}a.style.margin=`${oe}px 0`,a.style.minHeight=Oe+"px",a.style.maxHeight=ne+"px",c==null||c(),requestAnimationFrame(()=>m.current=!0)}},[_,f.trigger,f.valueNode,a,w,y,S,A,f.dir,c]);we(()=>R(),[R]);const[G,O]=E.useState();we(()=>{w&&O(window.getComputedStyle(w).zIndex)},[w]);const he=E.useCallback($=>{$&&x.current===!0&&(R(),I==null||I(),x.current=!1)},[R,I]);return C.jsx(Dr,{scope:o,contentWrapper:a,shouldExpandOnScrollRef:m,onScrollButtonChange:he,children:C.jsx("div",{ref:g,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:G},children:C.jsx(ee.div,{...l,ref:v,style:{boxSizing:"border-box",maxHeight:"100%",...l.style}})})})});Wt.displayName=Pr;var Ur="SelectPopperPosition",it=E.forwardRef((n,s)=>{const{__scopeSelect:o,align:c="start",collisionPadding:l=oe,...f}=n,d=Ye(o);return C.jsx(kn,{...d,...f,ref:s,align:c,collisionPadding:l,style:{boxSizing:"border-box",...f.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});it.displayName=Ur;var[Dr,gt]=be(_e,{}),st="SelectViewport",Jt=E.forwardRef((n,s)=>{const{__scopeSelect:o,nonce:c,...l}=n,f=Ce(st,o),d=gt(st,o),a=le(s,f.onViewportChange),g=E.useRef(0);return C.jsxs(C.Fragment,{children:[C.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:c}),C.jsx(Ve.Slot,{scope:o,children:C.jsx(ee.div,{"data-radix-select-viewport":"",role:"presentation",...l,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...l.style},onScroll:K(l.onScroll,w=>{const T=w.currentTarget,{contentWrapper:v,shouldExpandOnScrollRef:_}=d;if(_!=null&&_.current&&v){const m=Math.abs(g.current-T.scrollTop);if(m>0){const x=window.innerHeight-oe*2,y=parseFloat(v.style.minHeight),S=parseFloat(v.style.height),A=Math.max(y,S);if(A<x){const I=A+m,R=Math.min(x,I),G=I-R;v.style.height=R+"px",v.style.bottom==="0px"&&(T.scrollTop=G>0?G:0,v.style.justifyContent="flex-end")}}}g.current=T.scrollTop})})})]})});Jt.displayName=st;var Xt="SelectGroup",[kr,jr]=be(Xt),Gr=E.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n,l=ut();return C.jsx(kr,{scope:o,id:l,children:C.jsx(ee.div,{role:"group","aria-labelledby":l,...c,ref:s})})});Gr.displayName=Xt;var zt="SelectLabel",Qt=E.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n,l=jr(zt,o);return C.jsx(ee.div,{id:l.id,...c,ref:s})});Qt.displayName=zt;var $e="SelectItem",[Hr,Zt]=be($e),en=E.forwardRef((n,s)=>{const{__scopeSelect:o,value:c,disabled:l=!1,textValue:f,...d}=n,a=Ie($e,o),g=Ce($e,o),w=a.value===c,[T,v]=E.useState(f??""),[_,m]=E.useState(!1),x=le(s,I=>{var R;return(R=g.itemRefCallback)==null?void 0:R.call(g,I,c,l)}),y=ut(),S=E.useRef("touch"),A=()=>{l||(a.onValueChange(c),a.onOpenChange(!1))};if(c==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return C.jsx(Hr,{scope:o,value:c,disabled:l,textId:y,isSelected:w,onItemTextChange:E.useCallback(I=>{v(R=>R||((I==null?void 0:I.textContent)??"").trim())},[]),children:C.jsx(Ve.ItemSlot,{scope:o,value:c,disabled:l,textValue:T,children:C.jsx(ee.div,{role:"option","aria-labelledby":y,"data-highlighted":_?"":void 0,"aria-selected":w&&_,"data-state":w?"checked":"unchecked","aria-disabled":l||void 0,"data-disabled":l?"":void 0,tabIndex:l?void 0:-1,...d,ref:x,onFocus:K(d.onFocus,()=>m(!0)),onBlur:K(d.onBlur,()=>m(!1)),onClick:K(d.onClick,()=>{S.current!=="mouse"&&A()}),onPointerUp:K(d.onPointerUp,()=>{S.current==="mouse"&&A()}),onPointerDown:K(d.onPointerDown,I=>{S.current=I.pointerType}),onPointerMove:K(d.onPointerMove,I=>{var R;S.current=I.pointerType,l?(R=g.onItemLeave)==null||R.call(g):S.current==="mouse"&&I.currentTarget.focus({preventScroll:!0})}),onPointerLeave:K(d.onPointerLeave,I=>{var R;I.currentTarget===document.activeElement&&((R=g.onItemLeave)==null||R.call(g))}),onKeyDown:K(d.onKeyDown,I=>{var G;((G=g.searchRef)==null?void 0:G.current)!==""&&I.key===" "||(Ar.includes(I.key)&&A(),I.key===" "&&I.preventDefault())})})})})});en.displayName=$e;var Le="SelectItemText",tn=E.forwardRef((n,s)=>{const{__scopeSelect:o,className:c,style:l,...f}=n,d=Ie(Le,o),a=Ce(Le,o),g=Zt(Le,o),w=Br(Le,o),[T,v]=E.useState(null),_=le(s,A=>v(A),g.onItemTextChange,A=>{var I;return(I=a.itemTextRefCallback)==null?void 0:I.call(a,A,g.value,g.disabled)}),m=T==null?void 0:T.textContent,x=E.useMemo(()=>C.jsx("option",{value:g.value,disabled:g.disabled,children:m},g.value),[g.disabled,g.value,m]),{onNativeOptionAdd:y,onNativeOptionRemove:S}=w;return we(()=>(y(x),()=>S(x)),[y,S,x]),C.jsxs(C.Fragment,{children:[C.jsx(ee.span,{id:g.textId,...f,ref:_}),g.isSelected&&d.valueNode&&!d.valueNodeHasChildren?Ot.createPortal(f.children,d.valueNode):null]})});tn.displayName=Le;var nn="SelectItemIndicator",rn=E.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n;return Zt(nn,o).isSelected?C.jsx(ee.span,{"aria-hidden":!0,...c,ref:s}):null});rn.displayName=nn;var at="SelectScrollUpButton",on=E.forwardRef((n,s)=>{const o=Ce(at,n.__scopeSelect),c=gt(at,n.__scopeSelect),[l,f]=E.useState(!1),d=le(s,c.onScrollButtonChange);return we(()=>{if(o.viewport&&o.isPositioned){let a=function(){const w=g.scrollTop>0;f(w)};const g=o.viewport;return a(),g.addEventListener("scroll",a),()=>g.removeEventListener("scroll",a)}},[o.viewport,o.isPositioned]),l?C.jsx(an,{...n,ref:d,onAutoScroll:()=>{const{viewport:a,selectedItem:g}=o;a&&g&&(a.scrollTop=a.scrollTop-g.offsetHeight)}}):null});on.displayName=at;var ct="SelectScrollDownButton",sn=E.forwardRef((n,s)=>{const o=Ce(ct,n.__scopeSelect),c=gt(ct,n.__scopeSelect),[l,f]=E.useState(!1),d=le(s,c.onScrollButtonChange);return we(()=>{if(o.viewport&&o.isPositioned){let a=function(){const w=g.scrollHeight-g.clientHeight,T=Math.ceil(g.scrollTop)<w;f(T)};const g=o.viewport;return a(),g.addEventListener("scroll",a),()=>g.removeEventListener("scroll",a)}},[o.viewport,o.isPositioned]),l?C.jsx(an,{...n,ref:d,onAutoScroll:()=>{const{viewport:a,selectedItem:g}=o;a&&g&&(a.scrollTop=a.scrollTop+g.offsetHeight)}}):null});sn.displayName=ct;var an=E.forwardRef((n,s)=>{const{__scopeSelect:o,onAutoScroll:c,...l}=n,f=Ce("SelectScrollButton",o),d=E.useRef(null),a=Ke(o),g=E.useCallback(()=>{d.current!==null&&(window.clearInterval(d.current),d.current=null)},[]);return E.useEffect(()=>()=>g(),[g]),we(()=>{var T;const w=a().find(v=>v.ref.current===document.activeElement);(T=w==null?void 0:w.ref.current)==null||T.scrollIntoView({block:"nearest"})},[a]),C.jsx(ee.div,{"aria-hidden":!0,...l,ref:s,style:{flexShrink:0,...l.style},onPointerDown:K(l.onPointerDown,()=>{d.current===null&&(d.current=window.setInterval(c,50))}),onPointerMove:K(l.onPointerMove,()=>{var w;(w=f.onItemLeave)==null||w.call(f),d.current===null&&(d.current=window.setInterval(c,50))}),onPointerLeave:K(l.onPointerLeave,()=>{g()})})}),$r="SelectSeparator",cn=E.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n;return C.jsx(ee.div,{"aria-hidden":!0,...c,ref:s})});cn.displayName=$r;var lt="SelectArrow",Vr=E.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n,l=Ye(o),f=Ie(lt,o),d=Ce(lt,o);return f.open&&d.position==="popper"?C.jsx(jn,{...l,...c,ref:s}):null});Vr.displayName=lt;function ln(n){return n===""||n===void 0}var un=E.forwardRef((n,s)=>{const{value:o,...c}=n,l=E.useRef(null),f=le(s,l),d=Hn(o);return E.useEffect(()=>{const a=l.current,g=window.HTMLSelectElement.prototype,T=Object.getOwnPropertyDescriptor(g,"value").set;if(d!==o&&T){const v=new Event("change",{bubbles:!0});T.call(a,o),a.dispatchEvent(v)}},[d,o]),C.jsx($n,{asChild:!0,children:C.jsx("select",{...c,ref:f,defaultValue:o})})});un.displayName="BubbleSelect";function dn(n){const s=Bn(n),o=E.useRef(""),c=E.useRef(0),l=E.useCallback(d=>{const a=o.current+d;s(a),function g(w){o.current=w,window.clearTimeout(c.current),w!==""&&(c.current=window.setTimeout(()=>g(""),1e3))}(a)},[s]),f=E.useCallback(()=>{o.current="",window.clearTimeout(c.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(c.current),[]),[o,l,f]}function fn(n,s,o){const l=s.length>1&&Array.from(s).every(w=>w===s[0])?s[0]:s,f=o?n.indexOf(o):-1;let d=Kr(n,Math.max(f,0));l.length===1&&(d=d.filter(w=>w!==o));const g=d.find(w=>w.textValue.toLowerCase().startsWith(l.toLowerCase()));return g!==o?g:void 0}function Kr(n,s){return n.map((o,c)=>n[(s+c)%n.length])}var Yr=Dt,hn=jt,qr=Ht,Wr=$t,Jr=Vt,pn=Kt,Xr=Jt,gn=Qt,mn=en,zr=tn,Qr=rn,yn=on,En=sn,wn=cn;const po=Yr,go=qr,Zr=E.forwardRef(({className:n,children:s,...o},c)=>C.jsxs(hn,{ref:c,className:xe("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...o,children:[s,C.jsx(Wr,{asChild:!0,children:C.jsx(Bt,{className:"h-4 w-4 opacity-50"})})]}));Zr.displayName=hn.displayName;const xn=E.forwardRef(({className:n,...s},o)=>C.jsx(yn,{ref:o,className:xe("flex cursor-default items-center justify-center py-1",n),...s,children:C.jsx(Yn,{className:"h-4 w-4"})}));xn.displayName=yn.displayName;const In=E.forwardRef(({className:n,...s},o)=>C.jsx(En,{ref:o,className:xe("flex cursor-default items-center justify-center py-1",n),...s,children:C.jsx(Bt,{className:"h-4 w-4"})}));In.displayName=En.displayName;const eo=E.forwardRef(({className:n,children:s,position:o="popper",...c},l)=>C.jsx(Jr,{children:C.jsxs(pn,{ref:l,className:xe("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",o==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:o,...c,children:[C.jsx(xn,{}),C.jsx(Xr,{className:xe("p-1",o==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),C.jsx(In,{})]})}));eo.displayName=pn.displayName;const to=E.forwardRef(({className:n,...s},o)=>C.jsx(gn,{ref:o,className:xe("px-2 py-1.5 text-sm font-semibold",n),...s}));to.displayName=gn.displayName;const no=E.forwardRef(({className:n,children:s,...o},c)=>C.jsxs(mn,{ref:c,className:xe("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...o,children:[C.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:C.jsx(Qr,{children:C.jsx(Gn,{className:"h-4 w-4"})})}),C.jsx(zr,{children:s})]}));no.displayName=mn.displayName;const ro=E.forwardRef(({className:n,...s},o)=>C.jsx(wn,{ref:o,className:xe("-mx-1 my-1 h-px bg-muted",n),...s}));ro.displayName=wn.displayName;export{Bt as C,po as S,Zr as a,go as b,eo as c,no as d,lo as e,fo as f,uo as r};
