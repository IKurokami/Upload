import{c as _,R as ne,j as e,g as c,h as O,D as ie,i as ce,B as v,k as de,l as R,r as o,u as P,b as ue,d as me,S as pe,m as T,L as xe}from"./index-WtJHjbLO.js";import{C as N,b,c as y,e as k,a as w,d as I}from"./card-BcLOqOzP.js";import{I as L}from"./input-D00uDdYR.js";import{S as ge,a as fe}from"./scroll-area-0WIcH05_.js";import{U as he,o as je,r as ve,d as De}from"./db-c5UTlzVM.js";import{A as Ae,T as Ne,c as F,R as be,W as ye,C as we,a as Ce,D as Se,b as M,P as Re,O as Ee,d as _e,e as Oe,f as Pe,g as Te,h as ke,i as Ie}from"./dialog-DbApNFDk.js";import{B as Le}from"./badge-BvVsmpoO.js";import{E}from"./eye-C4cYElPH.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],Me=_("EllipsisVertical",Fe);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Be=_("Search",$e),$=ne.forwardRef(({children:a,className:t,...s},r)=>e.jsxs("button",{ref:r,className:c("group relative w-auto cursor-pointer overflow-hidden rounded-full border bg-background p-2 px-6 text-center font-semibold",t),...s,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-2 w-2 rounded-full bg-primary transition-all duration-300 group-hover:scale-[100.8]"}),e.jsx("span",{className:"inline-block transition-all duration-300 group-hover:translate-x-12 group-hover:opacity-0",children:a})]}),e.jsxs("div",{className:"absolute top-0 z-10 flex h-full w-full translate-x-12 items-center justify-center gap-2 text-primary-foreground opacity-0 transition-all duration-300 group-hover:-translate-x-5 group-hover:opacity-100",children:[e.jsx("span",{children:a}),e.jsx(Ae,{})]})]}));$.displayName="InteractiveHoverButton";const ze=({album:a,onRename:t,onDelete:s})=>e.jsx("div",{className:"relative group h-full",children:e.jsxs(N,{className:"flex flex-col h-full",children:[e.jsx(b,{className:"flex flex-row items-center justify-between pb-2",children:e.jsxs("div",{className:"flex flex-col w-full overflow-hidden",children:[e.jsx(y,{className:"text-lg truncate w-full",title:a.albumName,children:a.albumName}),e.jsxs(k,{children:["Created at: ",new Date(a.createdAt).toLocaleDateString()]})]})}),e.jsx(w,{className:"pt-2 flex-grow",children:e.jsxs("p",{className:"text-sm flex items-center",children:[e.jsx(Le,{variant:"secondary",className:"mr-1",children:a.imageUrls.length})," ","images"]})}),e.jsxs(I,{className:"pt-2 flex justify-between items-center mt-auto",children:[e.jsx(O,{to:`/albums/${a.id}`,className:"flex-1 mr-2",children:e.jsx($,{className:"w-full",children:"View Album"})}),e.jsxs(ie,{children:[e.jsx(ce,{asChild:!0,children:e.jsx(v,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:e.jsx(Me,{className:"h-4 w-4"})})}),e.jsxs(de,{align:"end",children:[e.jsxs(R,{onClick:()=>t(a.id),children:[e.jsx(ge,{className:"mr-2 h-4 w-4"}),"Rename"]}),e.jsxs(R,{onClick:()=>s(a.id),className:"text-red-600",children:[e.jsx(Ne,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})]})});var B="AlertDialog",[He,wa]=ue(B,[F]),d=F(),z=a=>{const{__scopeAlertDialog:t,...s}=a,r=d(t);return e.jsx(be,{...r,...s,modal:!0})};z.displayName=B;var Ve="AlertDialogTrigger",qe=o.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,l=d(s);return e.jsx(_e,{...l,...r,ref:t})});qe.displayName=Ve;var Ue="AlertDialogPortal",H=a=>{const{__scopeAlertDialog:t,...s}=a,r=d(t);return e.jsx(Re,{...r,...s})};H.displayName=Ue;var Ge="AlertDialogOverlay",V=o.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,l=d(s);return e.jsx(Ee,{...l,...r,ref:t})});V.displayName=Ge;var h="AlertDialogContent",[We,Qe]=He(h),q=o.forwardRef((a,t)=>{const{__scopeAlertDialog:s,children:r,...l}=a,u=d(s),x=o.useRef(null),g=P(t,x),p=o.useRef(null);return e.jsx(ye,{contentName:h,titleName:U,docsSlug:"alert-dialog",children:e.jsx(We,{scope:s,cancelRef:p,children:e.jsxs(we,{role:"alertdialog",...u,...l,ref:g,onOpenAutoFocus:me(l.onOpenAutoFocus,m=>{var f;m.preventDefault(),(f=p.current)==null||f.focus({preventScroll:!0})}),onPointerDownOutside:m=>m.preventDefault(),onInteractOutside:m=>m.preventDefault(),children:[e.jsx(pe,{children:r}),e.jsx(Je,{contentRef:x})]})})})});q.displayName=h;var U="AlertDialogTitle",G=o.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,l=d(s);return e.jsx(Ce,{...l,...r,ref:t})});G.displayName=U;var W="AlertDialogDescription",Q=o.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,l=d(s);return e.jsx(Se,{...l,...r,ref:t})});Q.displayName=W;var Ye="AlertDialogAction",Y=o.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,l=d(s);return e.jsx(M,{...l,...r,ref:t})});Y.displayName=Ye;var J="AlertDialogCancel",K=o.forwardRef((a,t)=>{const{__scopeAlertDialog:s,...r}=a,{cancelRef:l}=Qe(J,s),u=d(s),x=P(t,l);return e.jsx(M,{...u,...r,ref:x})});K.displayName=J;var Je=({contentRef:a})=>{const t=`\`${h}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${h}\` by passing a \`${W}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${h}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return o.useEffect(()=>{var r;document.getElementById((r=a.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,a]),null},Ke=z,Xe=H,Ze=V,ea=q,aa=Y,ta=K,sa=G,ra=Q;function la({...a}){return e.jsx(Ke,{"data-slot":"alert-dialog",...a})}function oa({...a}){return e.jsx(Xe,{"data-slot":"alert-dialog-portal",...a})}function na({className:a,...t}){return e.jsx(Ze,{"data-slot":"alert-dialog-overlay",className:c("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...t})}function ia({className:a,...t}){return e.jsxs(oa,{children:[e.jsx(na,{}),e.jsx(ea,{"data-slot":"alert-dialog-content",className:c("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",a),...t})]})}function ca({className:a,...t}){return e.jsx("div",{"data-slot":"alert-dialog-header",className:c("flex flex-col gap-2 text-center sm:text-left",a),...t})}function da({className:a,...t}){return e.jsx("div",{"data-slot":"alert-dialog-footer",className:c("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",a),...t})}function ua({className:a,...t}){return e.jsx(sa,{"data-slot":"alert-dialog-title",className:c("text-lg font-semibold",a),...t})}function ma({className:a,...t}){return e.jsx(ra,{"data-slot":"alert-dialog-description",className:c("text-muted-foreground text-sm",a),...t})}function pa({className:a,...t}){return e.jsx(aa,{className:c(T(),a),...t})}function xa({className:a,...t}){return e.jsx(ta,{className:c(T({variant:"outline"}),a),...t})}const ga=({isOpen:a,onClose:t,onDelete:s})=>e.jsx(la,{open:a,onOpenChange:t,children:e.jsxs(ia,{children:[e.jsxs(ca,{children:[e.jsx(ua,{children:"Are you sure?"}),e.jsx(ma,{children:"This action cannot be undone. This will permanently delete the album and all its data."})]}),e.jsxs(da,{children:[e.jsx(xa,{children:"Cancel"}),e.jsx(pa,{onClick:s,children:"Delete"})]})]})}),fa=({isOpen:a,onClose:t,albumName:s,onRename:r,setAlbumName:l})=>e.jsx(Oe,{open:a,onOpenChange:t,children:e.jsxs(Pe,{children:[e.jsx(Te,{children:e.jsx(ke,{children:"Rename Album"})}),e.jsx("div",{className:"py-4",children:e.jsx(L,{value:s,onChange:u=>l(u.target.value),placeholder:"Enter new album name"})}),e.jsxs(Ie,{children:[e.jsx(v,{variant:"outline",onClick:t,children:"Cancel"}),e.jsx(v,{onClick:r,children:"Save"})]})]})}),Ca=()=>{const[a,t]=o.useState([]),[s,r]=o.useState(!0),[l,u]=o.useState(null),[x,g]=o.useState(!1),[p,m]=o.useState(""),[f,X]=o.useState(""),[C,Z]=o.useState([]),D=async()=>{r(!0);try{const A=(await je()).transaction(["htmlFiles"],"readonly").objectStore("htmlFiles").getAll();A.onsuccess=()=>{const oe=A.result||[];t(oe),r(!1)},A.onerror=()=>{console.error("Error loading albums from IndexedDB"),r(!1),alert("Failed to load albums.  Check the console for details.")}}catch(n){console.error("IndexedDB error:",n),alert("Failed to access albums database.  Check the console for details."),r(!1)}};o.useEffect(()=>{D()},[]),o.useEffect(()=>{const n=a.filter(i=>i.albumName.toLowerCase().includes(f.toLowerCase()));Z(n)},[f,a]);const ee=n=>{const i=a.find(S=>S.id===n);i&&(m(i.albumName),u(n),g(!0))},ae=n=>{u(n),j(!0)},[te,j]=o.useState(!1),se=async()=>{if(l!==null)try{await De(l),await D(),j(!1)}catch(n){console.error("Error deleting album:",n),alert("Failed to delete album. Please check the console for details."),j(!1)}},re=async()=>{if(l===null||!p.trim())return;if(a.some(i=>i.albumName.toLowerCase()===p.toLowerCase()&&i.id!==l)){alert("Album name already exists. Please choose a different name.");return}try{await ve(l,p),await D(),g(!1)}catch(i){console.error("Error renaming album:",i),alert("Failed to rename album. Please check the console for details."),g(!1)}},le=n=>{X(n.target.value)};return s?e.jsx("div",{className:"container mx-auto p-4 max-w-4xl",children:e.jsxs(N,{children:[e.jsx(b,{children:e.jsxs(y,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(E,{size:24}),"Albums"]})}),e.jsxs(w,{className:"p-4 flex justify-center items-center",children:[e.jsx(xe,{className:"h-6 w-6 animate-spin mr-2"})," Loading albums..."]})]})}):e.jsxs("div",{className:"container mx-auto p-4 max-w-4xl",children:[e.jsxs(N,{children:[e.jsxs(b,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(y,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(E,{size:24}),"Albums"]}),e.jsxs("div",{className:"relative",children:[e.jsx(L,{type:"text",placeholder:"Search albums...",value:f,onChange:le,className:"pr-10"}),e.jsx(Be,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500"})]})]}),e.jsx(k,{children:"View and manage your saved albums."})]}),e.jsx(w,{className:"p-4",children:e.jsx(fe,{className:"w-full h-[500px] rounded-md",children:e.jsx("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 grid-flow-row auto-rows-fr",children:C.length>0?C.map(n=>e.jsx(ze,{album:n,onRename:ee,onDelete:ae},n.id)):e.jsx("div",{className:"col-span-full text-center py-8",children:"No matching albums found."})})})}),e.jsx(I,{className:"p-4 border-t",children:e.jsx(O,{to:"/upload",children:e.jsxs(v,{variant:"outline",children:[e.jsx(he,{size:16,className:"mr-2"}),"Back to Uploader"]})})})]}),e.jsx(fa,{isOpen:x,onClose:()=>g(!1),albumName:p,onRename:re,setAlbumName:m}),e.jsx(ga,{isOpen:te,onClose:()=>j(!1),onDelete:se})]})};export{Ca as default};
