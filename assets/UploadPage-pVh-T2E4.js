import{c as P,j as e,r,P as A,a as G,u as le,b as ce,d as de,e as $,f as me,g as ue,B as O,L as he,h as B}from"./index-Dgd1V7eY.js";import{C as xe,b as pe,c as ge,a as fe,d as be}from"./card-BD3dnNld.js";import{T as z,a as R,b as w,c as S,u as je,C as ve}from"./index-CX4Kc-Fn.js";import{g as Ne,u as ke,i as ye}from"./db-CRqWljtf.js";import{B as Ce}from"./badge-2mIQrTcF.js";import{I as L,E as we}from"./input-OQKUk1Lb.js";import{L as F,T as Se,a as Ee}from"./index-DqtheOy2.js";import{A as J,a as Q,b as W,T as U,c as V,d as q,e as K}from"./tooltip-KXFi_NZF.js";import{U as Te}from"./upload-PEpE7PMf.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],Ie=P("Code",Pe);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],Fe=P("FileDown",Le);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],Re=P("ImagePlus",ze);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],_e=P("ListChecks",Ae),De=({albumName:s,setAlbumName:a,chapterNumber:t,setChapterNumber:i,customFileName:n,setCustomFileName:o,namingMethod:m,setNamingMethod:c,getFileName:x})=>e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"File Naming"}),e.jsxs(z,{value:m,onValueChange:c,className:"mb-4",children:[e.jsxs(R,{className:"grid grid-cols-2 w-full",children:[e.jsx(w,{value:"chapter",children:"Chapter + Album"}),e.jsx(w,{value:"custom",children:"Custom Name"})]}),e.jsx(S,{value:"chapter",className:"space-y-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(F,{className:"my-2",htmlFor:"chapterNumber",children:"Chapter Number"}),e.jsx(L,{id:"chapterNumber",value:t,onChange:l=>i(l.target.value),placeholder:"Enter chapter number"})]}),e.jsxs("div",{children:[e.jsx(F,{className:"my-2",htmlFor:"albumName",children:"Album Name"}),e.jsx(L,{id:"albumName",value:s,onChange:l=>a(l.target.value),placeholder:"Enter album name"})]})]})}),e.jsx(S,{value:"custom",className:"space-y-4",children:e.jsxs("div",{children:[e.jsx(F,{className:"my-2",htmlFor:"customFileName",children:"File Name"}),e.jsx(L,{id:"customFileName",value:n,onChange:l=>o(l.target.value),placeholder:"Enter file name"})]})})]}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["File will be named as:"," ",e.jsx(Ce,{variant:"secondary",children:x()})]})]});var Me="Separator",X="horizontal",He=["horizontal","vertical"],Y=r.forwardRef((s,a)=>{const{decorative:t,orientation:i=X,...n}=s,o=$e(i)?i:X,c=t?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return e.jsx(A.div,{"data-orientation":o,...c,...n,ref:a})});Y.displayName=Me;function $e(s){return He.includes(s)}var Oe=Y;function Be({className:s,orientation:a="horizontal",decorative:t=!0,...i}){return e.jsx(Oe,{"data-slot":"separator-root",decorative:t,orientation:a,className:G("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",s),...i})}var _="Checkbox",[Ue,ls]=de(_),[Ve,qe]=Ue(_),ee=r.forwardRef((s,a)=>{const{__scopeCheckbox:t,name:i,checked:n,defaultChecked:o,required:m,disabled:c,value:x="on",onCheckedChange:l,form:h,...b}=s,[u,j]=r.useState(null),E=le(a,d=>j(d)),T=r.useRef(!1),p=u?h||!!u.closest("form"):!0,[g=!1,k]=ce({prop:n,defaultProp:o,onChange:l}),I=r.useRef(g);return r.useEffect(()=>{const d=u==null?void 0:u.form;if(d){const v=()=>k(I.current);return d.addEventListener("reset",v),()=>d.removeEventListener("reset",v)}},[u,k]),e.jsxs(Ve,{scope:t,state:g,disabled:c,children:[e.jsx(A.button,{type:"button",role:"checkbox","aria-checked":f(g)?"mixed":g,"aria-required":m,"data-state":ae(g),"data-disabled":c?"":void 0,disabled:c,value:x,...b,ref:E,onKeyDown:$(s.onKeyDown,d=>{d.key==="Enter"&&d.preventDefault()}),onClick:$(s.onClick,d=>{k(v=>f(v)?!0:!v),p&&(T.current=d.isPropagationStopped(),T.current||d.stopPropagation())})}),p&&e.jsx(Ke,{control:u,bubbles:!T.current,name:i,value:x,checked:g,required:m,disabled:c,form:h,style:{transform:"translateX(-100%)"},defaultChecked:f(o)?!1:o})]})});ee.displayName=_;var se="CheckboxIndicator",te=r.forwardRef((s,a)=>{const{__scopeCheckbox:t,forceMount:i,...n}=s,o=qe(se,t);return e.jsx(me,{present:i||f(o.state)||o.state===!0,children:e.jsx(A.span,{"data-state":ae(o.state),"data-disabled":o.disabled?"":void 0,...n,ref:a,style:{pointerEvents:"none",...s.style}})})});te.displayName=se;var Ke=s=>{const{control:a,checked:t,bubbles:i=!0,defaultChecked:n,...o}=s,m=r.useRef(null),c=je(t),x=ue(a);r.useEffect(()=>{const h=m.current,b=window.HTMLInputElement.prototype,j=Object.getOwnPropertyDescriptor(b,"checked").set;if(c!==t&&j){const E=new Event("click",{bubbles:i});h.indeterminate=f(t),j.call(h,f(t)?!1:t),h.dispatchEvent(E)}},[c,t,i]);const l=r.useRef(f(t)?!1:t);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n??l.current,...o,tabIndex:-1,ref:m,style:{...s.style,...x,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function f(s){return s==="indeterminate"}function ae(s){return f(s)?"indeterminate":s?"checked":"unchecked"}var Xe=ee,Ze=te;function Ge({className:s,...a}){return e.jsx(Xe,{"data-slot":"checkbox",className:G("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...a,children:e.jsx(Ze,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(ve,{className:"size-3.5"})})})}const Je=({htmlContent:s,setHtmlContent:a,lazyLoad:t,setLazyLoad:i})=>e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"min-h-[150px] font-mono text-sm",value:s,onChange:n=>a(n.target.value),placeholder:"Paste your HTML or image links here..."}),e.jsxs("div",{className:"flex items-center space-x-2 my-4",children:[e.jsx(Ge,{id:"lazy-load",checked:t,onCheckedChange:n=>i(!!n)}),e.jsx(Ee,{htmlFor:"lazy-load",children:"Enable Lazy Loading for Images"})]}),e.jsx(Be,{className:"my-4"})]}),Qe=({extractedLinks:s})=>s.length>0&&e.jsxs(J,{className:"border-green-500 bg-green-50 dark:bg-green-900 dark:border-green-400",children:[e.jsxs(Q,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"text-green-600 dark:text-green-300"}),"Image Detection"]}),e.jsxs(W,{children:["Detected ",s.length," image link(s). Only the image URLs will be processed."]})]}),Z=({previewTab:s,extractedLinks:a,htmlContent:t,lazyLoad:i})=>{if(s==="visual")return a.length>0?e.jsx("div",{className:"flex flex-col items-center",children:a.map((n,o)=>e.jsx("img",{src:n,alt:`Image ${o+1}`,className:"max-w-full h-auto"},n))}):e.jsx("div",{dangerouslySetInnerHTML:{__html:t},className:"prose dark:prose-invert max-w-none"});{const n=a.length>0?a.map(o=>`<img src="${o}" alt="" ${i?'loading="lazy"':""}>`).join(`
`):t;return e.jsx("pre",{className:"bg-gray-100 dark:bg-gray-800 p-4 rounded-md overflow-auto",children:e.jsx("code",{className:"text-sm font-mono",children:n})})}},We=({htmlContent:s,extractedLinks:a,lazyLoad:t,fileName:i,albumName:n,chapterNumber:o,namingMethod:m,saving:c,setSaving:x,saveMessage:l,setSaveMessage:h,setSavedFiles:b})=>e.jsxs(e.Fragment,{children:[l&&e.jsxs(J,{variant:l.type==="error"?"destructive":"default",className:`mb-4 ${l.type==="error"?"bg-red-50 dark:bg-red-900":"bg-green-50 dark:bg-green-900"}`,children:[e.jsx(Q,{children:l.type==="error"?"Error":"Success"}),e.jsx(W,{children:l.text})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(U,{children:e.jsxs(V,{children:[e.jsx(q,{asChild:!0,children:e.jsxs(O,{variant:"outline",onClick:()=>Ne(a,s,t,i),disabled:!s.trim(),className:"w-32",children:[e.jsx(Fe,{size:16,className:"mr-2"}),"Download"]})}),e.jsx(K,{children:e.jsx("p",{children:"Download the generated HTML file"})})]})}),e.jsx(U,{children:e.jsxs(V,{children:[e.jsx(q,{asChild:!0,children:e.jsxs(O,{onClick:()=>ke(n,o,m,i,a,x,h,b),disabled:c||!s.trim(),className:"w-32",children:[c?e.jsx(he,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(Te,{size:16,className:"mr-2"}),"Upload"]})}),e.jsx(K,{children:e.jsx("p",{children:"Save the album to browser storage"})})]})})]})]}),cs=()=>{const[s,a]=r.useState(""),[t,i]=r.useState([]),[n,o]=r.useState("Album"),[m,c]=r.useState("1"),[x,l]=r.useState("my-file.html"),[h,b]=r.useState("chapter"),[u,j]=r.useState([]),[E,T]=r.useState(!1),[p,g]=r.useState(null),[k,I]=r.useState(null),[d,v]=r.useState(!0),[D,M]=r.useState("visual");r.useEffect(()=>{if(s.trim()){const N=/<img[^>]+src\s*=\s*(['"])(.*?)\1/gi;let y;const C=[];for(;(y=N.exec(s))!==null;)C.push(y[2]);const re=/<img[^>]+src\s*=\s*(['"])(data:image\/[a-zA-Z0-9+]+;base64,[^'"]+)\1/gi;for(;(y=re.exec(s))!==null;)C.push(y[2]);const ne=/background-image\s*:\s*url\((['"]?)([^'")]+)\1\)/gi;for(;(y=ne.exec(s))!==null;)C.push(y[2]);if(C.length===0){const oe=/https?:\/\/[^\s'"]+\.(jpg|jpeg|png|gif|webp|svg|bmp|tiff|ico|avif|jfif|pjpeg|pjp)(\?[^'"\s]*)?(\#[^'"\s]*)?/gi,ie=s.match(oe)||[];C.push(...ie)}i(C)}else i([])},[s]),r.useEffect(()=>{ye(N=>{j(N)})},[]),r.useEffect(()=>{if((p==null?void 0:p.type)==="success"&&u.length>0){const N=u[u.length-1];N&&typeof N.id=="number"&&I(N.id)}},[p,u]);const H=()=>h==="chapter"?`${m} - ${n}.html`:x;return e.jsx("div",{className:"container mx-auto p-4",children:e.jsxs(xe,{className:"shadow-lg",children:[e.jsxs(pe,{children:[e.jsxs(ge,{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(Re,{size:24,className:"text-blue-600"}),"HTML Image Uploader"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Create HTML files from image links or HTML content."})]}),e.jsx(fe,{children:e.jsxs(z,{defaultValue:"edit",className:"w-full space-y-4",children:[e.jsxs(R,{className:"grid grid-cols-2",children:[e.jsxs(w,{value:"edit",className:"flex items-center gap-2",children:[e.jsx(Ie,{size:16})," Editor"]}),e.jsxs(w,{value:"preview",className:"flex items-center gap-2",children:[e.jsx(we,{size:16})," Preview"]})]}),e.jsxs(S,{value:"edit",children:[e.jsx(Je,{htmlContent:s,setHtmlContent:a,lazyLoad:d,setLazyLoad:v}),e.jsx(De,{albumName:n,setAlbumName:o,chapterNumber:m,setChapterNumber:c,customFileName:x,setCustomFileName:l,namingMethod:h,setNamingMethod:b,getFileName:H}),e.jsx(Qe,{extractedLinks:t})]}),e.jsx(S,{value:"preview",children:e.jsxs(z,{defaultValue:"visual",className:"w-full space-y-4",children:[e.jsxs(R,{className:"grid grid-cols-2",children:[e.jsx(w,{value:"visual",onClick:()=>M("visual"),children:"Visual Preview"}),e.jsx(w,{value:"code",onClick:()=>M("code"),children:"Code Preview"})]}),e.jsx(S,{value:"visual",children:e.jsx(Z,{previewTab:D,extractedLinks:t,htmlContent:s,lazyLoad:d})}),e.jsx(S,{value:"code",children:e.jsx(Z,{previewTab:D,extractedLinks:t,htmlContent:s,lazyLoad:d})})]})})]})}),e.jsxs(be,{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[u.length," file(s) saved in browser storage."," ",e.jsx(B,{to:"/albums",className:"text-blue-500 hover:underline",children:"View Albums"}),k!==null&&(p==null?void 0:p.type)==="success"&&e.jsxs(e.Fragment,{children:[" | ",e.jsx(B,{to:`/albums/${k}`,className:"text-green-600 hover:underline font-semibold",children:"Go to Album"})]})]}),e.jsx(We,{htmlContent:s,extractedLinks:t,lazyLoad:d,fileName:H(),albumName:n,chapterNumber:m,namingMethod:h,saving:E,setSaving:T,saveMessage:p,setSaveMessage:g,setSavedFiles:j})]})]})})};export{cs as default};
