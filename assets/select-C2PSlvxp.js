import{c as Nt,af as yt,r as I,q as bt,a6 as mn,b as Et,j as C,t as yn,d as En,s as ut,ag as wn,u as le,A as xn,P as ee,e as K,a7 as we,v as In,o as Ot,I as Cn,a4 as Sn,a9 as Tn,a5 as vn,S as Rn,aa as _n,x as An,C as Nn,w as bn,a as Ne}from"./index-CfufUkBK.js";import{c as wt}from"./index-BdQq_4o_.js";import{u as On,C as Bn}from"./index-BmwI4Zvt.js";import{V as Mn}from"./index-D9MUpxve.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fn=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Bt=Nt("ChevronDown",Fn);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ln=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Pn=Nt("ChevronUp",Ln);var ze;(function(n){n.STRING="string",n.NUMBER="number",n.INTEGER="integer",n.BOOLEAN="boolean",n.ARRAY="array",n.OBJECT="object"})(ze||(ze={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe;(function(n){n.LANGUAGE_UNSPECIFIED="language_unspecified",n.PYTHON="python"})(Xe||(Xe={}));var Je;(function(n){n.OUTCOME_UNSPECIFIED="outcome_unspecified",n.OUTCOME_OK="outcome_ok",n.OUTCOME_FAILED="outcome_failed",n.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(Je||(Je={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qe=["user","model","function","system"];var ye;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(ye||(ye={}));var Ee;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(Ee||(Ee={}));var Ze;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Ze||(Ze={}));var et;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER"})(et||(et={}));var Ae;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.OTHER="OTHER"})(Ae||(Ae={}));var tt;(function(n){n.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",n.RETRIEVAL_QUERY="RETRIEVAL_QUERY",n.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",n.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",n.CLASSIFICATION="CLASSIFICATION",n.CLUSTERING="CLUSTERING"})(tt||(tt={}));var nt;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(nt||(nt={}));var rt;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(rt||(rt={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y extends Error{constructor(s){super(`[GoogleGenerativeAI Error]: ${s}`)}}class Te extends Y{constructor(s,o){super(s),this.response=o}}class dt extends Y{constructor(s,o,c,l){super(s),this.status=o,this.statusText=c,this.errorDetails=l}}class fe extends Y{}class ft extends Y{}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Un="https://generativelanguage.googleapis.com",Dn="v1beta",kn="0.24.0",jn="genai-js";var ve;(function(n){n.GENERATE_CONTENT="generateContent",n.STREAM_GENERATE_CONTENT="streamGenerateContent",n.COUNT_TOKENS="countTokens",n.EMBED_CONTENT="embedContent",n.BATCH_EMBED_CONTENTS="batchEmbedContents"})(ve||(ve={}));class Gn{constructor(s,o,c,l,f){this.model=s,this.task=o,this.apiKey=c,this.stream=l,this.requestOptions=f}toString(){var s,o;const c=((s=this.requestOptions)===null||s===void 0?void 0:s.apiVersion)||Dn;let f=`${((o=this.requestOptions)===null||o===void 0?void 0:o.baseUrl)||Un}/${c}/${this.model}:${this.task}`;return this.stream&&(f+="?alt=sse"),f}}function Hn(n){const s=[];return n!=null&&n.apiClient&&s.push(n.apiClient),s.push(`${jn}/${kn}`),s.join(" ")}async function $n(n){var s;const o=new Headers;o.append("Content-Type","application/json"),o.append("x-goog-api-client",Hn(n.requestOptions)),o.append("x-goog-api-key",n.apiKey);let c=(s=n.requestOptions)===null||s===void 0?void 0:s.customHeaders;if(c){if(!(c instanceof Headers))try{c=new Headers(c)}catch(l){throw new fe(`unable to convert customHeaders value ${JSON.stringify(c)} to Headers: ${l.message}`)}for(const[l,f]of c.entries()){if(l==="x-goog-api-key")throw new fe(`Cannot set reserved header name ${l}`);if(l==="x-goog-api-client")throw new fe(`Header name ${l} can only be set using the apiClient field`);o.append(l,f)}}return o}async function Vn(n,s,o,c,l,f){const d=new Gn(n,s,o,c,f);return{url:d.toString(),fetchOptions:Object.assign(Object.assign({},Wn(f)),{method:"POST",headers:await $n(d),body:l})}}async function De(n,s,o,c,l,f={},d=fetch){const{url:a,fetchOptions:g}=await Vn(n,s,o,c,l,f);return Kn(a,g,d)}async function Kn(n,s,o=fetch){let c;try{c=await o(n,s)}catch(l){Yn(l,n)}return c.ok||await qn(c,n),c}function Yn(n,s){let o=n;throw o.name==="AbortError"?(o=new ft(`Request aborted when fetching ${s.toString()}: ${n.message}`),o.stack=n.stack):n instanceof dt||n instanceof fe||(o=new Y(`Error fetching from ${s.toString()}: ${n.message}`),o.stack=n.stack),o}async function qn(n,s){let o="",c;try{const l=await n.json();o=l.error.message,l.error.details&&(o+=` ${JSON.stringify(l.error.details)}`,c=l.error.details)}catch{}throw new dt(`Error fetching from ${s.toString()}: [${n.status} ${n.statusText}] ${o}`,n.status,n.statusText,c)}function Wn(n){const s={};if((n==null?void 0:n.signal)!==void 0||(n==null?void 0:n.timeout)>=0){const o=new AbortController;(n==null?void 0:n.timeout)>=0&&setTimeout(()=>o.abort(),n.timeout),n!=null&&n.signal&&n.signal.addEventListener("abort",()=>{o.abort()}),s.signal=o.signal}return s}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ht(n){return n.text=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning text from the first candidate only. Access response.candidates directly to use the other candidates.`),He(n.candidates[0]))throw new Te(`${me(n)}`,n);return zn(n)}else if(n.promptFeedback)throw new Te(`Text not available. ${me(n)}`,n);return""},n.functionCall=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),He(n.candidates[0]))throw new Te(`${me(n)}`,n);return console.warn("response.functionCall() is deprecated. Use response.functionCalls() instead."),xt(n)[0]}else if(n.promptFeedback)throw new Te(`Function call not available. ${me(n)}`,n)},n.functionCalls=()=>{if(n.candidates&&n.candidates.length>0){if(n.candidates.length>1&&console.warn(`This response had ${n.candidates.length} candidates. Returning function calls from the first candidate only. Access response.candidates directly to use the other candidates.`),He(n.candidates[0]))throw new Te(`${me(n)}`,n);return xt(n)}else if(n.promptFeedback)throw new Te(`Function call not available. ${me(n)}`,n)},n}function zn(n){var s,o,c,l;const f=[];if(!((o=(s=n.candidates)===null||s===void 0?void 0:s[0].content)===null||o===void 0)&&o.parts)for(const d of(l=(c=n.candidates)===null||c===void 0?void 0:c[0].content)===null||l===void 0?void 0:l.parts)d.text&&f.push(d.text),d.executableCode&&f.push("\n```"+d.executableCode.language+`
`+d.executableCode.code+"\n```\n"),d.codeExecutionResult&&f.push("\n```\n"+d.codeExecutionResult.output+"\n```\n");return f.length>0?f.join(""):""}function xt(n){var s,o,c,l;const f=[];if(!((o=(s=n.candidates)===null||s===void 0?void 0:s[0].content)===null||o===void 0)&&o.parts)for(const d of(l=(c=n.candidates)===null||c===void 0?void 0:c[0].content)===null||l===void 0?void 0:l.parts)d.functionCall&&f.push(d.functionCall);if(f.length>0)return f}const Xn=[Ae.RECITATION,Ae.SAFETY,Ae.LANGUAGE];function He(n){return!!n.finishReason&&Xn.includes(n.finishReason)}function me(n){var s,o,c;let l="";if((!n.candidates||n.candidates.length===0)&&n.promptFeedback)l+="Response was blocked",!((s=n.promptFeedback)===null||s===void 0)&&s.blockReason&&(l+=` due to ${n.promptFeedback.blockReason}`),!((o=n.promptFeedback)===null||o===void 0)&&o.blockReasonMessage&&(l+=`: ${n.promptFeedback.blockReasonMessage}`);else if(!((c=n.candidates)===null||c===void 0)&&c[0]){const f=n.candidates[0];He(f)&&(l+=`Candidate was blocked due to ${f.finishReason}`,f.finishMessage&&(l+=`: ${f.finishMessage}`))}return l}function Pe(n){return this instanceof Pe?(this.v=n,this):new Pe(n)}function Jn(n,s,o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c=o.apply(n,s||[]),l,f=[];return l={},d("next"),d("throw"),d("return"),l[Symbol.asyncIterator]=function(){return this},l;function d(_){c[_]&&(l[_]=function(m){return new Promise(function(w,y){f.push([_,m,w,y])>1||a(_,m)})})}function a(_,m){try{g(c[_](m))}catch(w){R(f[0][3],w)}}function g(_){_.value instanceof Pe?Promise.resolve(_.value.v).then(E,T):R(f[0][2],_)}function E(_){a("next",_)}function T(_){a("throw",_)}function R(_,m){_(m),f.shift(),f.length&&a(f[0][0],f[0][1])}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const It=/^data\: (.*)(?:\n\n|\r\r|\r\n\r\n)/;function Qn(n){const s=n.body.pipeThrough(new TextDecoderStream("utf8",{fatal:!0})),o=tr(s),[c,l]=o.tee();return{stream:er(c),response:Zn(l)}}async function Zn(n){const s=[],o=n.getReader();for(;;){const{done:c,value:l}=await o.read();if(c)return ht(nr(s));s.push(l)}}function er(n){return Jn(this,arguments,function*(){const o=n.getReader();for(;;){const{value:c,done:l}=yield Pe(o.read());if(l)break;yield yield Pe(ht(c))}})}function tr(n){const s=n.getReader();return new ReadableStream({start(c){let l="";return f();function f(){return s.read().then(({value:d,done:a})=>{if(a){if(l.trim()){c.error(new Y("Failed to parse stream"));return}c.close();return}l+=d;let g=l.match(It),E;for(;g;){try{E=JSON.parse(g[1])}catch{c.error(new Y(`Error parsing JSON response: "${g[1]}"`));return}c.enqueue(E),l=l.substring(g[0].length),g=l.match(It)}return f()}).catch(d=>{let a=d;throw a.stack=d.stack,a.name==="AbortError"?a=new ft("Request aborted when reading from the stream"):a=new Y("Error reading from the stream"),a})}}})}function nr(n){const s=n[n.length-1],o={promptFeedback:s==null?void 0:s.promptFeedback};for(const c of n){if(c.candidates){let l=0;for(const f of c.candidates)if(o.candidates||(o.candidates=[]),o.candidates[l]||(o.candidates[l]={index:l}),o.candidates[l].citationMetadata=f.citationMetadata,o.candidates[l].groundingMetadata=f.groundingMetadata,o.candidates[l].finishReason=f.finishReason,o.candidates[l].finishMessage=f.finishMessage,o.candidates[l].safetyRatings=f.safetyRatings,f.content&&f.content.parts){o.candidates[l].content||(o.candidates[l].content={role:f.content.role||"user",parts:[]});const d={};for(const a of f.content.parts)a.text&&(d.text=a.text),a.functionCall&&(d.functionCall=a.functionCall),a.executableCode&&(d.executableCode=a.executableCode),a.codeExecutionResult&&(d.codeExecutionResult=a.codeExecutionResult),Object.keys(d).length===0&&(d.text=""),o.candidates[l].content.parts.push(d)}l++}c.usageMetadata&&(o.usageMetadata=c.usageMetadata)}return o}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mt(n,s,o,c){const l=await De(s,ve.STREAM_GENERATE_CONTENT,n,!0,JSON.stringify(o),c);return Qn(l)}async function Ft(n,s,o,c){const f=await(await De(s,ve.GENERATE_CONTENT,n,!1,JSON.stringify(o),c)).json();return{response:ht(f)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(n){if(n!=null){if(typeof n=="string")return{role:"system",parts:[{text:n}]};if(n.text)return{role:"system",parts:[n]};if(n.parts)return n.role?n:{role:"system",parts:n.parts}}}function Ue(n){let s=[];if(typeof n=="string")s=[{text:n}];else for(const o of n)typeof o=="string"?s.push({text:o}):s.push(o);return rr(s)}function rr(n){const s={role:"user",parts:[]},o={role:"function",parts:[]};let c=!1,l=!1;for(const f of n)"functionResponse"in f?(o.parts.push(f),l=!0):(s.parts.push(f),c=!0);if(c&&l)throw new Y("Within a single message, FunctionResponse cannot be mixed with other type of part in the request for sending chat message.");if(!c&&!l)throw new Y("No content is provided for sending chat message.");return c?s:o}function or(n,s){var o;let c={model:s==null?void 0:s.model,generationConfig:s==null?void 0:s.generationConfig,safetySettings:s==null?void 0:s.safetySettings,tools:s==null?void 0:s.tools,toolConfig:s==null?void 0:s.toolConfig,systemInstruction:s==null?void 0:s.systemInstruction,cachedContent:(o=s==null?void 0:s.cachedContent)===null||o===void 0?void 0:o.name,contents:[]};const l=n.generateContentRequest!=null;if(n.contents){if(l)throw new fe("CountTokensRequest must have one of contents or generateContentRequest, not both.");c.contents=n.contents}else if(l)c=Object.assign(Object.assign({},c),n.generateContentRequest);else{const f=Ue(n);c.contents=[f]}return{generateContentRequest:c}}function Ct(n){let s;return n.contents?s=n:s={contents:[Ue(n)]},n.systemInstruction&&(s.systemInstruction=Lt(n.systemInstruction)),s}function ir(n){return typeof n=="string"||Array.isArray(n)?{content:Ue(n)}:n}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const St=["text","inlineData","functionCall","functionResponse","executableCode","codeExecutionResult"],sr={user:["text","inlineData"],function:["functionResponse"],model:["text","functionCall","executableCode","codeExecutionResult"],system:["text"]};function ar(n){let s=!1;for(const o of n){const{role:c,parts:l}=o;if(!s&&c!=="user")throw new Y(`First content should be with role 'user', got ${c}`);if(!Qe.includes(c))throw new Y(`Each item should include role field. Got ${c} but valid roles are: ${JSON.stringify(Qe)}`);if(!Array.isArray(l))throw new Y("Content should have 'parts' property with an array of Parts");if(l.length===0)throw new Y("Each Content should have at least one part");const f={text:0,inlineData:0,functionCall:0,functionResponse:0,fileData:0,executableCode:0,codeExecutionResult:0};for(const a of l)for(const g of St)g in a&&(f[g]+=1);const d=sr[c];for(const a of St)if(!d.includes(a)&&f[a]>0)throw new Y(`Content with role '${c}' can't contain '${a}' part`);s=!0}}function Tt(n){var s;if(n.candidates===void 0||n.candidates.length===0)return!1;const o=(s=n.candidates[0])===null||s===void 0?void 0:s.content;if(o===void 0||o.parts===void 0||o.parts.length===0)return!1;for(const c of o.parts)if(c===void 0||Object.keys(c).length===0||c.text!==void 0&&c.text==="")return!1;return!0}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vt="SILENT_ERROR";class Pt{constructor(s,o,c,l={}){this.model=o,this.params=c,this._requestOptions=l,this._history=[],this._sendPromise=Promise.resolve(),this._apiKey=s,c!=null&&c.history&&(ar(c.history),this._history=c.history)}async getHistory(){return await this._sendPromise,this._history}async sendMessage(s,o={}){var c,l,f,d,a,g;await this._sendPromise;const E=Ue(s),T={safetySettings:(c=this.params)===null||c===void 0?void 0:c.safetySettings,generationConfig:(l=this.params)===null||l===void 0?void 0:l.generationConfig,tools:(f=this.params)===null||f===void 0?void 0:f.tools,toolConfig:(d=this.params)===null||d===void 0?void 0:d.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(g=this.params)===null||g===void 0?void 0:g.cachedContent,contents:[...this._history,E]},R=Object.assign(Object.assign({},this._requestOptions),o);let _;return this._sendPromise=this._sendPromise.then(()=>Ft(this._apiKey,this.model,T,R)).then(m=>{var w;if(Tt(m.response)){this._history.push(E);const y=Object.assign({parts:[],role:"model"},(w=m.response.candidates)===null||w===void 0?void 0:w[0].content);this._history.push(y)}else{const y=me(m.response);y&&console.warn(`sendMessage() was unsuccessful. ${y}. Inspect response object for details.`)}_=m}),await this._sendPromise,_}async sendMessageStream(s,o={}){var c,l,f,d,a,g;await this._sendPromise;const E=Ue(s),T={safetySettings:(c=this.params)===null||c===void 0?void 0:c.safetySettings,generationConfig:(l=this.params)===null||l===void 0?void 0:l.generationConfig,tools:(f=this.params)===null||f===void 0?void 0:f.tools,toolConfig:(d=this.params)===null||d===void 0?void 0:d.toolConfig,systemInstruction:(a=this.params)===null||a===void 0?void 0:a.systemInstruction,cachedContent:(g=this.params)===null||g===void 0?void 0:g.cachedContent,contents:[...this._history,E]},R=Object.assign(Object.assign({},this._requestOptions),o),_=Mt(this._apiKey,this.model,T,R);return this._sendPromise=this._sendPromise.then(()=>_).catch(m=>{throw new Error(vt)}).then(m=>m.response).then(m=>{if(Tt(m)){this._history.push(E);const w=Object.assign({},m.candidates[0].content);w.role||(w.role="model"),this._history.push(w)}else{const w=me(m);w&&console.warn(`sendMessageStream() was unsuccessful. ${w}. Inspect response object for details.`)}}).catch(m=>{m.message!==vt&&console.error(m)}),_}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cr(n,s,o,c){return(await De(s,ve.COUNT_TOKENS,n,!1,JSON.stringify(o),c)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lr(n,s,o,c){return(await De(s,ve.EMBED_CONTENT,n,!1,JSON.stringify(o),c)).json()}async function ur(n,s,o,c){const l=o.requests.map(d=>Object.assign(Object.assign({},d),{model:s}));return(await De(s,ve.BATCH_EMBED_CONTENTS,n,!1,JSON.stringify({requests:l}),c)).json()}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(s,o,c={}){this.apiKey=s,this._requestOptions=c,o.model.includes("/")?this.model=o.model:this.model=`models/${o.model}`,this.generationConfig=o.generationConfig||{},this.safetySettings=o.safetySettings||[],this.tools=o.tools,this.toolConfig=o.toolConfig,this.systemInstruction=Lt(o.systemInstruction),this.cachedContent=o.cachedContent}async generateContent(s,o={}){var c;const l=Ct(s),f=Object.assign(Object.assign({},this._requestOptions),o);return Ft(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(c=this.cachedContent)===null||c===void 0?void 0:c.name},l),f)}async generateContentStream(s,o={}){var c;const l=Ct(s),f=Object.assign(Object.assign({},this._requestOptions),o);return Mt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(c=this.cachedContent)===null||c===void 0?void 0:c.name},l),f)}startChat(s){var o;return new Pt(this.apiKey,this.model,Object.assign({generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:(o=this.cachedContent)===null||o===void 0?void 0:o.name},s),this._requestOptions)}async countTokens(s,o={}){const c=or(s,{model:this.model,generationConfig:this.generationConfig,safetySettings:this.safetySettings,tools:this.tools,toolConfig:this.toolConfig,systemInstruction:this.systemInstruction,cachedContent:this.cachedContent}),l=Object.assign(Object.assign({},this._requestOptions),o);return cr(this.apiKey,this.model,c,l)}async embedContent(s,o={}){const c=ir(s),l=Object.assign(Object.assign({},this._requestOptions),o);return lr(this.apiKey,this.model,c,l)}async batchEmbedContents(s,o={}){const c=Object.assign(Object.assign({},this._requestOptions),o);return ur(this.apiKey,this.model,s,c)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(s){this.apiKey=s}getGenerativeModel(s,o){if(!s.model)throw new Y("Must provide a model name. Example: genai.getGenerativeModel({ model: 'my-model-name' })");return new ot(this.apiKey,s,o)}getGenerativeModelFromCachedContent(s,o,c){if(!s.name)throw new fe("Cached content must contain a `name` field.");if(!s.model)throw new fe("Cached content must contain a `model` field.");const l=["model","systemInstruction"];for(const d of l)if(o!=null&&o[d]&&s[d]&&(o==null?void 0:o[d])!==s[d]){if(d==="model"){const a=o.model.startsWith("models/")?o.model.replace("models/",""):o.model,g=s.model.startsWith("models/")?s.model.replace("models/",""):s.model;if(a===g)continue}throw new fe(`Different value for "${d}" specified in modelParams (${o[d]}) and cachedContent (${s[d]})`)}const f=Object.assign(Object.assign({},o),{model:s.model,tools:s.tools,toolConfig:s.toolConfig,systemInstruction:s.systemInstruction,cachedContent:s});return new ot(this.apiKey,f,c)}}const fr=Object.freeze(Object.defineProperty({__proto__:null,get BlockReason(){return et},ChatSession:Pt,get DynamicRetrievalMode(){return rt},get ExecutableCodeLanguage(){return Xe},get FinishReason(){return Ae},get FunctionCallingMode(){return nt},GenerativeModel:ot,GoogleGenerativeAI:dr,GoogleGenerativeAIAbortError:ft,GoogleGenerativeAIError:Y,GoogleGenerativeAIFetchError:dt,GoogleGenerativeAIRequestInputError:fe,GoogleGenerativeAIResponseError:Te,get HarmBlockThreshold(){return Ee},get HarmCategory(){return ye},get HarmProbability(){return Ze},get Outcome(){return Je},POSSIBLE_ROLES:Qe,get SchemaType(){return ze},get TaskType(){return tt}},Symbol.toStringTag,{value:"Module"}));var We={},Fe={},Rt;function hr(){if(Rt)return Fe;Rt=1,Fe.byteLength=a,Fe.toByteArray=E,Fe.fromByteArray=_;for(var n=[],s=[],o=typeof Uint8Array<"u"?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,f=c.length;l<f;++l)n[l]=c[l],s[c.charCodeAt(l)]=l;s[45]=62,s[95]=63;function d(m){var w=m.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=m.indexOf("=");y===-1&&(y=w);var S=y===w?0:4-y%4;return[y,S]}function a(m){var w=d(m),y=w[0],S=w[1];return(y+S)*3/4-S}function g(m,w,y){return(w+y)*3/4-y}function E(m){var w,y=d(m),S=y[0],A=y[1],x=new o(g(m,S,A)),v=0,G=A>0?S-4:S,O;for(O=0;O<G;O+=4)w=s[m.charCodeAt(O)]<<18|s[m.charCodeAt(O+1)]<<12|s[m.charCodeAt(O+2)]<<6|s[m.charCodeAt(O+3)],x[v++]=w>>16&255,x[v++]=w>>8&255,x[v++]=w&255;return A===2&&(w=s[m.charCodeAt(O)]<<2|s[m.charCodeAt(O+1)]>>4,x[v++]=w&255),A===1&&(w=s[m.charCodeAt(O)]<<10|s[m.charCodeAt(O+1)]<<4|s[m.charCodeAt(O+2)]>>2,x[v++]=w>>8&255,x[v++]=w&255),x}function T(m){return n[m>>18&63]+n[m>>12&63]+n[m>>6&63]+n[m&63]}function R(m,w,y){for(var S,A=[],x=w;x<y;x+=3)S=(m[x]<<16&16711680)+(m[x+1]<<8&65280)+(m[x+2]&255),A.push(T(S));return A.join("")}function _(m){for(var w,y=m.length,S=y%3,A=[],x=16383,v=0,G=y-S;v<G;v+=x)A.push(R(m,v,v+x>G?G:v+x));return S===1?(w=m[y-1],A.push(n[w>>2]+n[w<<4&63]+"==")):S===2&&(w=(m[y-2]<<8)+m[y-1],A.push(n[w>>10]+n[w>>4&63]+n[w<<2&63]+"=")),A.join("")}return Fe}var Ge={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var _t;function pr(){return _t||(_t=1,Ge.read=function(n,s,o,c,l){var f,d,a=l*8-c-1,g=(1<<a)-1,E=g>>1,T=-7,R=o?l-1:0,_=o?-1:1,m=n[s+R];for(R+=_,f=m&(1<<-T)-1,m>>=-T,T+=a;T>0;f=f*256+n[s+R],R+=_,T-=8);for(d=f&(1<<-T)-1,f>>=-T,T+=c;T>0;d=d*256+n[s+R],R+=_,T-=8);if(f===0)f=1-E;else{if(f===g)return d?NaN:(m?-1:1)*(1/0);d=d+Math.pow(2,c),f=f-E}return(m?-1:1)*d*Math.pow(2,f-c)},Ge.write=function(n,s,o,c,l,f){var d,a,g,E=f*8-l-1,T=(1<<E)-1,R=T>>1,_=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=c?0:f-1,w=c?1:-1,y=s<0||s===0&&1/s<0?1:0;for(s=Math.abs(s),isNaN(s)||s===1/0?(a=isNaN(s)?1:0,d=T):(d=Math.floor(Math.log(s)/Math.LN2),s*(g=Math.pow(2,-d))<1&&(d--,g*=2),d+R>=1?s+=_/g:s+=_*Math.pow(2,1-R),s*g>=2&&(d++,g/=2),d+R>=T?(a=0,d=T):d+R>=1?(a=(s*g-1)*Math.pow(2,l),d=d+R):(a=s*Math.pow(2,R-1)*Math.pow(2,l),d=0));l>=8;n[o+m]=a&255,m+=w,a/=256,l-=8);for(d=d<<l|a,E+=l;E>0;n[o+m]=d&255,m+=w,d/=256,E-=8);n[o+m-w]|=y*128}),Ge}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var At;function gr(){return At||(At=1,function(n){const s=hr(),o=pr(),c=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=a,n.SlowBuffer=x,n.INSPECT_MAX_BYTES=50;const l=2147483647;n.kMaxLength=l,a.TYPED_ARRAY_SUPPORT=f(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function f(){try{const r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function d(r){if(r>l)throw new RangeError('The value "'+r+'" is invalid for option "size"');const e=new Uint8Array(r);return Object.setPrototypeOf(e,a.prototype),e}function a(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return R(r)}return g(r,e,t)}a.poolSize=8192;function g(r,e,t){if(typeof r=="string")return _(r,e);if(ArrayBuffer.isView(r))return w(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(ce(r,ArrayBuffer)||r&&ce(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ce(r,SharedArrayBuffer)||r&&ce(r.buffer,SharedArrayBuffer)))return y(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return a.from(i,e,t);const u=S(r);if(u)return u;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return a.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}a.from=function(r,e,t){return g(r,e,t)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function E(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function T(r,e,t){return E(r),r<=0?d(r):e!==void 0?typeof t=="string"?d(r).fill(e,t):d(r).fill(e):d(r)}a.alloc=function(r,e,t){return T(r,e,t)};function R(r){return E(r),d(r<0?0:A(r)|0)}a.allocUnsafe=function(r){return R(r)},a.allocUnsafeSlow=function(r){return R(r)};function _(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=v(r,e)|0;let i=d(t);const u=i.write(r,e);return u!==t&&(i=i.slice(0,u)),i}function m(r){const e=r.length<0?0:A(r.length)|0,t=d(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function w(r){if(ce(r,Uint8Array)){const e=new Uint8Array(r);return y(e.buffer,e.byteOffset,e.byteLength)}return m(r)}function y(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,a.prototype),i}function S(r){if(a.isBuffer(r)){const e=A(r.length)|0,t=d(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||qe(r.length)?d(0):m(r);if(r.type==="Buffer"&&Array.isArray(r.data))return m(r.data)}function A(r){if(r>=l)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+l.toString(16)+" bytes");return r|0}function x(r){return+r!=r&&(r=0),a.alloc(+r)}a.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==a.prototype},a.compare=function(e,t){if(ce(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),ce(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,u=t.length;for(let h=0,p=Math.min(i,u);h<p;++h)if(e[h]!==t[h]){i=e[h],u=t[h];break}return i<u?-1:u<i?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return a.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;const u=a.allocUnsafe(t);let h=0;for(i=0;i<e.length;++i){let p=e[i];if(ce(p,Uint8Array))h+p.length>u.length?(a.isBuffer(p)||(p=a.from(p)),p.copy(u,h)):Uint8Array.prototype.set.call(u,p,h);else if(a.isBuffer(p))p.copy(u,h);else throw new TypeError('"list" argument must be an Array of Buffers');h+=p.length}return u};function v(r,e){if(a.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||ce(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let u=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Se(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return mt(r).length;default:if(u)return i?-1:Se(r).length;e=(""+e).toLowerCase(),u=!0}}a.byteLength=v;function G(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return ae(this,e,t);case"utf8":case"utf-8":return J(this,e,t);case"ascii":return Z(this,e,t);case"latin1":case"binary":return re(this,e,t);case"base64":return se(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Oe(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}a.prototype._isBuffer=!0;function O(r,e,t){const i=r[e];r[e]=r[t],r[t]=i}a.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)O(this,t,t+1);return this},a.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)O(this,t,t+3),O(this,t+1,t+2);return this},a.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)O(this,t,t+7),O(this,t+1,t+6),O(this,t+2,t+5),O(this,t+3,t+4);return this},a.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?J(this,0,e):G.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:a.compare(this,e)===0},a.prototype.inspect=function(){let e="";const t=n.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},c&&(a.prototype[c]=a.prototype.inspect),a.prototype.compare=function(e,t,i,u,h){if(ce(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),u===void 0&&(u=0),h===void 0&&(h=this.length),t<0||i>e.length||u<0||h>this.length)throw new RangeError("out of range index");if(u>=h&&t>=i)return 0;if(u>=h)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,u>>>=0,h>>>=0,this===e)return 0;let p=h-u,b=i-t;const k=Math.min(p,b),U=this.slice(u,h),j=e.slice(t,i);for(let L=0;L<k;++L)if(U[L]!==j[L]){p=U[L],b=j[L];break}return p<b?-1:b<p?1:0};function he(r,e,t,i,u){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,qe(t)&&(t=u?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(u)return-1;t=r.length-1}else if(t<0)if(u)t=0;else return-1;if(typeof e=="string"&&(e=a.from(e,i)),a.isBuffer(e))return e.length===0?-1:$(r,e,t,i,u);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?u?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):$(r,[e],t,i,u);throw new TypeError("val must be string, number or Buffer")}function $(r,e,t,i,u){let h=1,p=r.length,b=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;h=2,p/=2,b/=2,t/=2}function k(j,L){return h===1?j[L]:j.readUInt16BE(L*h)}let U;if(u){let j=-1;for(U=t;U<p;U++)if(k(r,U)===k(e,j===-1?0:U-j)){if(j===-1&&(j=U),U-j+1===b)return j*h}else j!==-1&&(U-=U-j),j=-1}else for(t+b>p&&(t=p-b),U=t;U>=0;U--){let j=!0;for(let L=0;L<b;L++)if(k(r,U+L)!==k(e,L)){j=!1;break}if(j)return U}return-1}a.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1},a.prototype.indexOf=function(e,t,i){return he(this,e,t,i,!0)},a.prototype.lastIndexOf=function(e,t,i){return he(this,e,t,i,!1)};function X(r,e,t,i){t=Number(t)||0;const u=r.length-t;i?(i=Number(i),i>u&&(i=u)):i=u;const h=e.length;i>h/2&&(i=h/2);let p;for(p=0;p<i;++p){const b=parseInt(e.substr(p*2,2),16);if(qe(b))return p;r[t+p]=b}return p}function ie(r,e,t,i){return je(Se(e,r.length-t),r,t,i)}function ue(r,e,t,i){return je(fn(e),r,t,i)}function te(r,e,t,i){return je(mt(e),r,t,i)}function ne(r,e,t,i){return je(hn(e,r.length-t),r,t,i)}a.prototype.write=function(e,t,i,u){if(t===void 0)u="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")u=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,u===void 0&&(u="utf8")):(u=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const h=this.length-t;if((i===void 0||i>h)&&(i=h),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");u||(u="utf8");let p=!1;for(;;)switch(u){case"hex":return X(this,e,t,i);case"utf8":case"utf-8":return ie(this,e,t,i);case"ascii":case"latin1":case"binary":return ue(this,e,t,i);case"base64":return te(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ne(this,e,t,i);default:if(p)throw new TypeError("Unknown encoding: "+u);u=(""+u).toLowerCase(),p=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function se(r,e,t){return e===0&&t===r.length?s.fromByteArray(r):s.fromByteArray(r.slice(e,t))}function J(r,e,t){t=Math.min(r.length,t);const i=[];let u=e;for(;u<t;){const h=r[u];let p=null,b=h>239?4:h>223?3:h>191?2:1;if(u+b<=t){let k,U,j,L;switch(b){case 1:h<128&&(p=h);break;case 2:k=r[u+1],(k&192)===128&&(L=(h&31)<<6|k&63,L>127&&(p=L));break;case 3:k=r[u+1],U=r[u+2],(k&192)===128&&(U&192)===128&&(L=(h&15)<<12|(k&63)<<6|U&63,L>2047&&(L<55296||L>57343)&&(p=L));break;case 4:k=r[u+1],U=r[u+2],j=r[u+3],(k&192)===128&&(U&192)===128&&(j&192)===128&&(L=(h&15)<<18|(k&63)<<12|(U&63)<<6|j&63,L>65535&&L<1114112&&(p=L))}}p===null?(p=65533,b=1):p>65535&&(p-=65536,i.push(p>>>10&1023|55296),p=56320|p&1023),i.push(p),u+=b}return q(i)}const Q=4096;function q(r){const e=r.length;if(e<=Q)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=Q));return t}function Z(r,e,t){let i="";t=Math.min(r.length,t);for(let u=e;u<t;++u)i+=String.fromCharCode(r[u]&127);return i}function re(r,e,t){let i="";t=Math.min(r.length,t);for(let u=e;u<t;++u)i+=String.fromCharCode(r[u]);return i}function ae(r,e,t){const i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let u="";for(let h=e;h<t;++h)u+=pn[r[h]];return u}function Oe(r,e,t){const i=r.slice(e,t);let u="";for(let h=0;h<i.length-1;h+=2)u+=String.fromCharCode(i[h]+i[h+1]*256);return u}a.prototype.slice=function(e,t){const i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);const u=this.subarray(e,t);return Object.setPrototypeOf(u,a.prototype),u};function D(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||D(e,t,this.length);let u=this[e],h=1,p=0;for(;++p<t&&(h*=256);)u+=this[e+p]*h;return u},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||D(e,t,this.length);let u=this[e+--t],h=1;for(;t>0&&(h*=256);)u+=this[e+--t]*h;return u},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e=e>>>0,t||D(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||D(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||D(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||D(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=ge(function(e){e=e>>>0,W(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&z(e,this.length-8);const u=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,h=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(u)+(BigInt(h)<<BigInt(32))}),a.prototype.readBigUInt64BE=ge(function(e){e=e>>>0,W(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&z(e,this.length-8);const u=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],h=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(u)<<BigInt(32))+BigInt(h)}),a.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||D(e,t,this.length);let u=this[e],h=1,p=0;for(;++p<t&&(h*=256);)u+=this[e+p]*h;return h*=128,u>=h&&(u-=Math.pow(2,8*t)),u},a.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||D(e,t,this.length);let u=t,h=1,p=this[e+--u];for(;u>0&&(h*=256);)p+=this[e+--u]*h;return h*=128,p>=h&&(p-=Math.pow(2,8*t)),p},a.prototype.readInt8=function(e,t){return e=e>>>0,t||D(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},a.prototype.readInt16LE=function(e,t){e=e>>>0,t||D(e,2,this.length);const i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i},a.prototype.readInt16BE=function(e,t){e=e>>>0,t||D(e,2,this.length);const i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i},a.prototype.readInt32LE=function(e,t){return e=e>>>0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e=e>>>0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=ge(function(e){e=e>>>0,W(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&z(e,this.length-8);const u=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(u)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)}),a.prototype.readBigInt64BE=ge(function(e){e=e>>>0,W(e,"offset");const t=this[e],i=this[e+7];(t===void 0||i===void 0)&&z(e,this.length-8);const u=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(u)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)}),a.prototype.readFloatLE=function(e,t){return e=e>>>0,t||D(e,4,this.length),o.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e=e>>>0,t||D(e,4,this.length),o.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||D(e,8,this.length),o.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||D(e,8,this.length),o.read(this,e,!1,52,8)};function H(r,e,t,i,u,h){if(!a.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>u||e<h)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,i,u){if(e=+e,t=t>>>0,i=i>>>0,!u){const b=Math.pow(2,8*i)-1;H(this,e,t,i,b,0)}let h=1,p=0;for(this[t]=e&255;++p<i&&(h*=256);)this[t+p]=e/h&255;return t+i},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,i,u){if(e=+e,t=t>>>0,i=i>>>0,!u){const b=Math.pow(2,8*i)-1;H(this,e,t,i,b,0)}let h=i-1,p=1;for(this[t+h]=e&255;--h>=0&&(p*=256);)this[t+h]=e/p&255;return t+i},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,1,255,0),this[t]=e&255,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function _e(r,e,t,i,u){M(e,i,u,r,t,7);let h=Number(e&BigInt(4294967295));r[t++]=h,h=h>>8,r[t++]=h,h=h>>8,r[t++]=h,h=h>>8,r[t++]=h;let p=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=p,p=p>>8,r[t++]=p,p=p>>8,r[t++]=p,p=p>>8,r[t++]=p,t}function de(r,e,t,i,u){M(e,i,u,r,t,7);let h=Number(e&BigInt(4294967295));r[t+7]=h,h=h>>8,r[t+6]=h,h=h>>8,r[t+5]=h,h=h>>8,r[t+4]=h;let p=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=p,p=p>>8,r[t+2]=p,p=p>>8,r[t+1]=p,p=p>>8,r[t]=p,t+8}a.prototype.writeBigUInt64LE=ge(function(e,t=0){return _e(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=ge(function(e,t=0){return de(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(e,t,i,u){if(e=+e,t=t>>>0,!u){const k=Math.pow(2,8*i-1);H(this,e,t,i,k-1,-k)}let h=0,p=1,b=0;for(this[t]=e&255;++h<i&&(p*=256);)e<0&&b===0&&this[t+h-1]!==0&&(b=1),this[t+h]=(e/p>>0)-b&255;return t+i},a.prototype.writeIntBE=function(e,t,i,u){if(e=+e,t=t>>>0,!u){const k=Math.pow(2,8*i-1);H(this,e,t,i,k-1,-k)}let h=i-1,p=1,b=0;for(this[t+h]=e&255;--h>=0&&(p*=256);)e<0&&b===0&&this[t+h+1]!==0&&(b=1),this[t+h]=(e/p>>0)-b&255;return t+i},a.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},a.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},a.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||H(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},a.prototype.writeBigInt64LE=ge(function(e,t=0){return _e(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=ge(function(e,t=0){return de(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ce(r,e,t,i,u,h){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function pe(r,e,t,i,u){return e=+e,t=t>>>0,u||Ce(r,e,t,4),o.write(r,e,t,i,23,4),t+4}a.prototype.writeFloatLE=function(e,t,i){return pe(this,e,t,!0,i)},a.prototype.writeFloatBE=function(e,t,i){return pe(this,e,t,!1,i)};function N(r,e,t,i,u){return e=+e,t=t>>>0,u||Ce(r,e,t,8),o.write(r,e,t,i,52,8),t+8}a.prototype.writeDoubleLE=function(e,t,i){return N(this,e,t,!0,i)},a.prototype.writeDoubleBE=function(e,t,i){return N(this,e,t,!1,i)},a.prototype.copy=function(e,t,i,u){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!u&&u!==0&&(u=this.length),t>=e.length&&(t=e.length),t||(t=0),u>0&&u<i&&(u=i),u===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("sourceEnd out of bounds");u>this.length&&(u=this.length),e.length-t<u-i&&(u=e.length-t+i);const h=u-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,u):Uint8Array.prototype.set.call(e,this.subarray(i,u),t),h},a.prototype.fill=function(e,t,i,u){if(typeof e=="string"){if(typeof t=="string"?(u=t,t=0,i=this.length):typeof i=="string"&&(u=i,i=this.length),u!==void 0&&typeof u!="string")throw new TypeError("encoding must be a string");if(typeof u=="string"&&!a.isEncoding(u))throw new TypeError("Unknown encoding: "+u);if(e.length===1){const p=e.charCodeAt(0);(u==="utf8"&&p<128||u==="latin1")&&(e=p)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let h;if(typeof e=="number")for(h=t;h<i;++h)this[h]=e;else{const p=a.isBuffer(e)?e:a.from(e,u),b=p.length;if(b===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(h=0;h<i-t;++h)this[h+t]=p[h%b]}return this};const B={};function V(r,e,t){B[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(u){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:u,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}V("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),V("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),V("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,u=t;return Number.isInteger(t)&&Math.abs(t)>2**32?u=P(String(t)):typeof t=="bigint"&&(u=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(u=P(u)),u+="n"),i+=` It must be ${e}. Received ${u}`,i},RangeError);function P(r){let e="",t=r.length;const i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function F(r,e,t){W(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&z(e,r.length-(t+1))}function M(r,e,t,i,u,h){if(r>t||r<e){const p=typeof e=="bigint"?"n":"";let b;throw e===0||e===BigInt(0)?b=`>= 0${p} and < 2${p} ** ${(h+1)*8}${p}`:b=`>= -(2${p} ** ${(h+1)*8-1}${p}) and < 2 ** ${(h+1)*8-1}${p}`,new B.ERR_OUT_OF_RANGE("value",b,r)}F(i,u,h)}function W(r,e){if(typeof r!="number")throw new B.ERR_INVALID_ARG_TYPE(e,"number",r)}function z(r,e,t){throw Math.floor(r)!==r?(W(r,t),new B.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new B.ERR_BUFFER_OUT_OF_BOUNDS:new B.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}const Be=/[^+/0-9A-Za-z-_]/g;function Me(r){if(r=r.split("=")[0],r=r.trim().replace(Be,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Se(r,e){e=e||1/0;let t;const i=r.length;let u=null;const h=[];for(let p=0;p<i;++p){if(t=r.charCodeAt(p),t>55295&&t<57344){if(!u){if(t>56319){(e-=3)>-1&&h.push(239,191,189);continue}else if(p+1===i){(e-=3)>-1&&h.push(239,191,189);continue}u=t;continue}if(t<56320){(e-=3)>-1&&h.push(239,191,189),u=t;continue}t=(u-55296<<10|t-56320)+65536}else u&&(e-=3)>-1&&h.push(239,191,189);if(u=null,t<128){if((e-=1)<0)break;h.push(t)}else if(t<2048){if((e-=2)<0)break;h.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;h.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;h.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return h}function fn(r){const e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function hn(r,e){let t,i,u;const h=[];for(let p=0;p<r.length&&!((e-=2)<0);++p)t=r.charCodeAt(p),i=t>>8,u=t%256,h.push(u),h.push(i);return h}function mt(r){return s.toByteArray(Me(r))}function je(r,e,t,i){let u;for(u=0;u<i&&!(u+t>=e.length||u>=r.length);++u)e[u+t]=r[u];return u}function ce(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function qe(r){return r!==r}const pn=function(){const r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const i=t*16;for(let u=0;u<16;++u)e[i+u]=r[t]+r[u]}return e}();function ge(r){return typeof BigInt>"u"?gn:r}function gn(){throw new Error("BigInt not supported")}}(We)),We}var Ut=gr();typeof window<"u"&&!window.Buffer&&(window.Buffer=Ut.Buffer);const pt=async(n,s,o)=>{try{const{GoogleGenerativeAI:c}=await yt(async()=>{const{GoogleGenerativeAI:S}=await Promise.resolve().then(()=>fr);return{GoogleGenerativeAI:S}},void 0),{GoogleAIFileManager:l}=await yt(async()=>{const{GoogleAIFileManager:S}=await import("./index-Q9_myv3Q.js");return{GoogleAIFileManager:S}},[]),f={},d=new c(s),a=new l(s),g=[{category:ye.HARM_CATEGORY_HARASSMENT,threshold:Ee.BLOCK_NONE},{category:ye.HARM_CATEGORY_HATE_SPEECH,threshold:Ee.BLOCK_NONE},{category:ye.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Ee.BLOCK_NONE},{category:ye.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Ee.BLOCK_NONE},{category:ye.HARM_CATEGORY_CIVIC_INTEGRITY,threshold:Ee.BLOCK_NONE}],E=[];for(const S of n){const A=await S.arrayBuffer(),x=await a.uploadFile(Ut.Buffer.from(A),{mimeType:S.type,displayName:S.name});E.push({file:x.file,originalFile:S})}const T={model:o.modelName,systemInstruction:o.systemInstruction};o.tools&&Object.assign(T,{tools:o.tools});const R=d.getGenerativeModel(T,f),m=[...E.map(({file:S,originalFile:A})=>({fileData:{mimeType:A.type,fileUri:S.uri}}))];o.chatText&&m.push({text:o.chatText});const w=[{role:"model",parts:[{text:o.systemInstruction}]},{role:"user",parts:m}],y=await R.generateContent({safetySettings:g,contents:w,generationConfig:{...o.generationConfig,responseMimeType:o.responseMimeType||"text/plain"}});return mr(y.response)}catch(c){return console.error("Gemini Error:",c),{thinking:`Error processing the images: ${c.message||"Unknown error"}`,ocrText:`Error processing images. ${c.message||"Please try again."}`,hasError:!0}}};function mr(n){var s;if(n.candidates&&n.candidates.length>0&&((s=n.candidates[0].content.parts[0])!=null&&s.inlineData)){const o=n.candidates[0].content.parts[0].inlineData;return{thinking:"Image processed successfully.",hasError:!1,imageData:`data:${o.mimeType};base64,${o.data}`}}else return n.text&&n.text()?{thinking:"Text processed successfully.",ocrText:n.text(),hasError:!1}:{thinking:"No output generated.",ocrText:"No output generated.",hasError:!0}}const ro=async(n,s,o,c,l)=>pt(n,s,{modelName:o,systemInstruction:c||`The user wants me to extract text from the image(s) and present it as a single line of text for each dialogue bubble.
I need to identify the dialogue bubbles in the image(s) and then use OCR to extract the text from each bubble.
I must ensure the extracted text does not include watermarks like 'Colamanga.com' or 'AcloudMerge.com'.

I must identify and extract each dialogue bubble's text as a single continuous line, even if it has multiple lines inside one bubble.
I must present the extracted text exactly as requested by the user—just the text, with no additional formatting or descriptions. Just text. Everything answer to user is the text inside the image.


`,generationConfig:{temperature:1,topP:.95,topK:64,maxOutputTokens:65536},chatText:"",responseMimeType:"text/plain"}),oo=async(n,s,o,c)=>pt(n,o,{modelName:c,systemInstruction:"You are a helpful assistant that responds to user queries with text, images, or both. If the user provides images, analyze them and respond to any questions about them. If the user provides only text, respond to their questions or statements appropriately. Be concise, helpful, and direct in your responses.",generationConfig:{temperature:.7,topP:.95,topK:32,maxOutputTokens:65536},chatText:s,responseMimeType:"text/plain"}),io=async(n,s,o,c,l)=>{const f=`
You are a skilled translator that uses the provided mapping table and relationships table to guide your translations.
The mapping table provides specific terms and their translations.
The relationships table describes how characters relate to each other and how they address one another.
Ensure your translation maintains the nuances of these relationships and uses the correct terms from the mapping table.
`,d=`
# TRANSLATE: Mandarin to Vietnamese with Professional Accuracy

Translate Mandarin text into Vietnamese with complete accuracy and cultural nuance by following these comprehensive guidelines:

---

### 🔹 DELIVER precise translations that:

- CAPTURE every single word, preserving the **exact meaning, tone, and nuance** of the original
- MAINTAIN **stylistic fidelity**, including:
  - Formality level (trang trọng, suồng sã, thân mật…)
  - Emotional undertones
  - Cultural or historical references
- ENSURE **pronoun consistency** throughout (e.g. ta, ngươi, người, hắn, nàng, muội, chàng) as appropriate to character and context
- RESPECT the original **sentence structure**, but rewrite for **natural Vietnamese flow** where necessary without losing meaning

---

### 🔹 ENSURE emotional and stylistic authenticity:

- MATCH the original **emotional intensity** — never exaggerate or understate the mood
- REPLICATE the tone precisely — formal stays formal, casual stays casual
- PRESERVE **character-specific speech styles**, such as unique patterns, dialects, or quirks

---

### 🔹 HANDLE names, terms, and references as follows:

- USE **Sino-Vietnamese phonetic transcription** for common historical/cultural nouns if appropriate
- RETAIN **established translations** for character and place names
- PREFER **English equivalents** for Western mythological or biblical references
- DO NOT localize or adapt terms unless required for clarity

---

### 🔹 MAINTAIN contextual and narrative integrity:

- TRANSLATE with attention to the **broader context** — ensure meaning carries across lines and paragraphs
- PRESERVE **subtext and implication**, without adding interpretation or explanation
- DO NOT omit, simplify, or condense the content — translate **everything** as faithfully as possible
- SPLIT long or complex Chinese sentences into manageable Vietnamese ones **without altering their meaning**

---

### 🔹 RELATIONSHIPS & ADDRESS TERMS:

- PRESERVE exact **modes of address** between characters:  
  (e.g. huynh – muội, ngươi – ta, nàng – thiếp, ca – đệ…)
- DISTINGUISH between:
  - **Dialogue speech**
  - **Narration by a character**
  - **Character's internal thoughts**
- ADAPT address and tone appropriately to **each narrative layer** (dialogue, monologue, narration)

---

### 🔹 QUALITY CONTROL CHECKLIST:

- ✅ No omissions – every word is translated
- ✅ No stylistic deviation from original
- ✅ Emotional tone precisely mirrored
- ✅ Consistent vocabulary, names, and pronouns
- ✅ Cultural authenticity maintained

---

## 🔹 AFTER TRANSLATION – PROVIDE COMPLETE TERMINOLOGY MAPPING TABLES:

1. **TERM MAPPING TABLE**:
   After each translation section, include a table listing:

${s||"No mapping table provided."}

   - First include **new proper nouns or terms** introduced in the section
   - Then provide the **COMPLETE UPDATED MAPPING** including all terms from previous sections

2. **RELATIONSHIPS & ADDRESS TERMS TABLE**:
   After each translation section, also include a detailed relationships table:

${o||"No relationships table provided."}

TEXT TO TRANSLATE:
${n}

---

## 🔹 BEFORE TRANSLATION – REQUIRE THE FOLLOWING CONTEXT:

Before beginning the translation:

1. **CONTEXT AND REFERENCE INFORMATION**:  
   
   - Summary of the story or scene  
   - World background if relevant (historical, fantasy, modern…)

2. **ADDRESS RELATIONSHIPS**:  
   
   - Character names, their **genders**, and **relationships** with each other  
   - Specific **ways characters address each other** in:  
     - Dialogue  
     - Narration  
     - Inner thoughts

3. **STYLE & TONE OF NARRATOR**:  
   
   - E.g. omniscient formal narrator, or a character's personal internal monologue  

---
`;return pt([],c,{modelName:l,systemInstruction:f,generationConfig:{temperature:.3,topP:.95,topK:32,maxOutputTokens:65536},chatText:d,responseMimeType:"text/plain"})};var yr=[" ","Enter","ArrowUp","ArrowDown"],Er=[" ","Enter"],ke="Select",[Ve,Ke,wr]=wn(ke),[be,so]=En(ke,[wr,bt]),Ye=bt(),[xr,xe]=be(ke),[Ir,Cr]=be(ke),Dt=n=>{const{__scopeSelect:s,children:o,open:c,defaultOpen:l,onOpenChange:f,value:d,defaultValue:a,onValueChange:g,dir:E,name:T,autoComplete:R,disabled:_,required:m,form:w}=n,y=Ye(s),[S,A]=I.useState(null),[x,v]=I.useState(null),[G,O]=I.useState(!1),he=mn(E),[$=!1,X]=Et({prop:c,defaultProp:l,onChange:f}),[ie,ue]=Et({prop:d,defaultProp:a,onChange:g}),te=I.useRef(null),ne=S?w||!!S.closest("form"):!0,[se,J]=I.useState(new Set),Q=Array.from(se).map(q=>q.props.value).join(";");return C.jsx(yn,{...y,children:C.jsxs(xr,{required:m,scope:s,trigger:S,onTriggerChange:A,valueNode:x,onValueNodeChange:v,valueNodeHasChildren:G,onValueNodeHasChildrenChange:O,contentId:ut(),value:ie,onValueChange:ue,open:$,onOpenChange:X,dir:he,triggerPointerDownPosRef:te,disabled:_,children:[C.jsx(Ve.Provider,{scope:s,children:C.jsx(Ir,{scope:n.__scopeSelect,onNativeOptionAdd:I.useCallback(q=>{J(Z=>new Set(Z).add(q))},[]),onNativeOptionRemove:I.useCallback(q=>{J(Z=>{const re=new Set(Z);return re.delete(q),re})},[]),children:o})}),ne?C.jsxs(ln,{"aria-hidden":!0,required:m,tabIndex:-1,name:T,autoComplete:R,value:ie,onChange:q=>ue(q.target.value),disabled:_,form:w,children:[ie===void 0?C.jsx("option",{value:""}):null,Array.from(se)]},Q):null]})})};Dt.displayName=ke;var kt="SelectTrigger",jt=I.forwardRef((n,s)=>{const{__scopeSelect:o,disabled:c=!1,...l}=n,f=Ye(o),d=xe(kt,o),a=d.disabled||c,g=le(s,d.onTriggerChange),E=Ke(o),T=I.useRef("touch"),[R,_,m]=un(y=>{const S=E().filter(v=>!v.disabled),A=S.find(v=>v.value===d.value),x=dn(S,y,A);x!==void 0&&d.onValueChange(x.value)}),w=y=>{a||(d.onOpenChange(!0),m()),y&&(d.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return C.jsx(xn,{asChild:!0,...f,children:C.jsx(ee.button,{type:"button",role:"combobox","aria-controls":d.contentId,"aria-expanded":d.open,"aria-required":d.required,"aria-autocomplete":"none",dir:d.dir,"data-state":d.open?"open":"closed",disabled:a,"data-disabled":a?"":void 0,"data-placeholder":cn(d.value)?"":void 0,...l,ref:g,onClick:K(l.onClick,y=>{y.currentTarget.focus(),T.current!=="mouse"&&w(y)}),onPointerDown:K(l.onPointerDown,y=>{T.current=y.pointerType;const S=y.target;S.hasPointerCapture(y.pointerId)&&S.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(w(y),y.preventDefault())}),onKeyDown:K(l.onKeyDown,y=>{const S=R.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&_(y.key),!(S&&y.key===" ")&&yr.includes(y.key)&&(w(),y.preventDefault())})})})});jt.displayName=kt;var Gt="SelectValue",Ht=I.forwardRef((n,s)=>{const{__scopeSelect:o,className:c,style:l,children:f,placeholder:d="",...a}=n,g=xe(Gt,o),{onValueNodeHasChildrenChange:E}=g,T=f!==void 0,R=le(s,g.onValueNodeChange);return we(()=>{E(T)},[E,T]),C.jsx(ee.span,{...a,ref:R,style:{pointerEvents:"none"},children:cn(g.value)?C.jsx(C.Fragment,{children:d}):f})});Ht.displayName=Gt;var Sr="SelectIcon",$t=I.forwardRef((n,s)=>{const{__scopeSelect:o,children:c,...l}=n;return C.jsx(ee.span,{"aria-hidden":!0,...l,ref:s,children:c||"▼"})});$t.displayName=Sr;var Tr="SelectPortal",Vt=n=>C.jsx(In,{asChild:!0,...n});Vt.displayName=Tr;var Re="SelectContent",Kt=I.forwardRef((n,s)=>{const o=xe(Re,n.__scopeSelect),[c,l]=I.useState();if(we(()=>{l(new DocumentFragment)},[]),!o.open){const f=c;return f?Ot.createPortal(C.jsx(Yt,{scope:n.__scopeSelect,children:C.jsx(Ve.Slot,{scope:n.__scopeSelect,children:C.jsx("div",{children:n.children})})}),f):null}return C.jsx(qt,{...n,ref:s})});Kt.displayName=Re;var oe=10,[Yt,Ie]=be(Re),vr="SelectContentImpl",qt=I.forwardRef((n,s)=>{const{__scopeSelect:o,position:c="item-aligned",onCloseAutoFocus:l,onEscapeKeyDown:f,onPointerDownOutside:d,side:a,sideOffset:g,align:E,alignOffset:T,arrowPadding:R,collisionBoundary:_,collisionPadding:m,sticky:w,hideWhenDetached:y,avoidCollisions:S,...A}=n,x=xe(Re,o),[v,G]=I.useState(null),[O,he]=I.useState(null),$=le(s,N=>G(N)),[X,ie]=I.useState(null),[ue,te]=I.useState(null),ne=Ke(o),[se,J]=I.useState(!1),Q=I.useRef(!1);I.useEffect(()=>{if(v)return Sn(v)},[v]),Tn();const q=I.useCallback(N=>{const[B,...V]=ne().map(M=>M.ref.current),[P]=V.slice(-1),F=document.activeElement;for(const M of N)if(M===F||(M==null||M.scrollIntoView({block:"nearest"}),M===B&&O&&(O.scrollTop=0),M===P&&O&&(O.scrollTop=O.scrollHeight),M==null||M.focus(),document.activeElement!==F))return},[ne,O]),Z=I.useCallback(()=>q([X,v]),[q,X,v]);I.useEffect(()=>{se&&Z()},[se,Z]);const{onOpenChange:re,triggerPointerDownPosRef:ae}=x;I.useEffect(()=>{if(v){let N={x:0,y:0};const B=P=>{var F,M;N={x:Math.abs(Math.round(P.pageX)-(((F=ae.current)==null?void 0:F.x)??0)),y:Math.abs(Math.round(P.pageY)-(((M=ae.current)==null?void 0:M.y)??0))}},V=P=>{N.x<=10&&N.y<=10?P.preventDefault():v.contains(P.target)||re(!1),document.removeEventListener("pointermove",B),ae.current=null};return ae.current!==null&&(document.addEventListener("pointermove",B),document.addEventListener("pointerup",V,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",V,{capture:!0})}}},[v,re,ae]),I.useEffect(()=>{const N=()=>re(!1);return window.addEventListener("blur",N),window.addEventListener("resize",N),()=>{window.removeEventListener("blur",N),window.removeEventListener("resize",N)}},[re]);const[Oe,D]=un(N=>{const B=ne().filter(F=>!F.disabled),V=B.find(F=>F.ref.current===document.activeElement),P=dn(B,N,V);P&&setTimeout(()=>P.ref.current.focus())}),H=I.useCallback((N,B,V)=>{const P=!Q.current&&!V;(x.value!==void 0&&x.value===B||P)&&(ie(N),P&&(Q.current=!0))},[x.value]),_e=I.useCallback(()=>v==null?void 0:v.focus(),[v]),de=I.useCallback((N,B,V)=>{const P=!Q.current&&!V;(x.value!==void 0&&x.value===B||P)&&te(N)},[x.value]),Ce=c==="popper"?it:Wt,pe=Ce===it?{side:a,sideOffset:g,align:E,alignOffset:T,arrowPadding:R,collisionBoundary:_,collisionPadding:m,sticky:w,hideWhenDetached:y,avoidCollisions:S}:{};return C.jsx(Yt,{scope:o,content:v,viewport:O,onViewportChange:he,itemRefCallback:H,selectedItem:X,onItemLeave:_e,itemTextRefCallback:de,focusSelectedItem:Z,selectedItemText:ue,position:c,isPositioned:se,searchRef:Oe,children:C.jsx(vn,{as:Rn,allowPinchZoom:!0,children:C.jsx(_n,{asChild:!0,trapped:x.open,onMountAutoFocus:N=>{N.preventDefault()},onUnmountAutoFocus:K(l,N=>{var B;(B=x.trigger)==null||B.focus({preventScroll:!0}),N.preventDefault()}),children:C.jsx(An,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:f,onPointerDownOutside:d,onFocusOutside:N=>N.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:C.jsx(Ce,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:N=>N.preventDefault(),...A,...pe,onPlaced:()=>J(!0),ref:$,style:{display:"flex",flexDirection:"column",outline:"none",...A.style},onKeyDown:K(A.onKeyDown,N=>{const B=N.ctrlKey||N.altKey||N.metaKey;if(N.key==="Tab"&&N.preventDefault(),!B&&N.key.length===1&&D(N.key),["ArrowUp","ArrowDown","Home","End"].includes(N.key)){let P=ne().filter(F=>!F.disabled).map(F=>F.ref.current);if(["ArrowUp","End"].includes(N.key)&&(P=P.slice().reverse()),["ArrowUp","ArrowDown"].includes(N.key)){const F=N.target,M=P.indexOf(F);P=P.slice(M+1)}setTimeout(()=>q(P)),N.preventDefault()}})})})})})})});qt.displayName=vr;var Rr="SelectItemAlignedPosition",Wt=I.forwardRef((n,s)=>{const{__scopeSelect:o,onPlaced:c,...l}=n,f=xe(Re,o),d=Ie(Re,o),[a,g]=I.useState(null),[E,T]=I.useState(null),R=le(s,$=>T($)),_=Ke(o),m=I.useRef(!1),w=I.useRef(!0),{viewport:y,selectedItem:S,selectedItemText:A,focusSelectedItem:x}=d,v=I.useCallback(()=>{if(f.trigger&&f.valueNode&&a&&E&&y&&S&&A){const $=f.trigger.getBoundingClientRect(),X=E.getBoundingClientRect(),ie=f.valueNode.getBoundingClientRect(),ue=A.getBoundingClientRect();if(f.dir!=="rtl"){const F=ue.left-X.left,M=ie.left-F,W=$.left-M,z=$.width+W,Be=Math.max(z,X.width),Me=window.innerWidth-oe,Se=wt(M,[oe,Math.max(oe,Me-Be)]);a.style.minWidth=z+"px",a.style.left=Se+"px"}else{const F=X.right-ue.right,M=window.innerWidth-ie.right-F,W=window.innerWidth-$.right-M,z=$.width+W,Be=Math.max(z,X.width),Me=window.innerWidth-oe,Se=wt(M,[oe,Math.max(oe,Me-Be)]);a.style.minWidth=z+"px",a.style.right=Se+"px"}const te=_(),ne=window.innerHeight-oe*2,se=y.scrollHeight,J=window.getComputedStyle(E),Q=parseInt(J.borderTopWidth,10),q=parseInt(J.paddingTop,10),Z=parseInt(J.borderBottomWidth,10),re=parseInt(J.paddingBottom,10),ae=Q+q+se+re+Z,Oe=Math.min(S.offsetHeight*5,ae),D=window.getComputedStyle(y),H=parseInt(D.paddingTop,10),_e=parseInt(D.paddingBottom,10),de=$.top+$.height/2-oe,Ce=ne-de,pe=S.offsetHeight/2,N=S.offsetTop+pe,B=Q+q+N,V=ae-B;if(B<=de){const F=te.length>0&&S===te[te.length-1].ref.current;a.style.bottom="0px";const M=E.clientHeight-y.offsetTop-y.offsetHeight,W=Math.max(Ce,pe+(F?_e:0)+M+Z),z=B+W;a.style.height=z+"px"}else{const F=te.length>0&&S===te[0].ref.current;a.style.top="0px";const W=Math.max(de,Q+y.offsetTop+(F?H:0)+pe)+V;a.style.height=W+"px",y.scrollTop=B-de+y.offsetTop}a.style.margin=`${oe}px 0`,a.style.minHeight=Oe+"px",a.style.maxHeight=ne+"px",c==null||c(),requestAnimationFrame(()=>m.current=!0)}},[_,f.trigger,f.valueNode,a,E,y,S,A,f.dir,c]);we(()=>v(),[v]);const[G,O]=I.useState();we(()=>{E&&O(window.getComputedStyle(E).zIndex)},[E]);const he=I.useCallback($=>{$&&w.current===!0&&(v(),x==null||x(),w.current=!1)},[v,x]);return C.jsx(Ar,{scope:o,contentWrapper:a,shouldExpandOnScrollRef:m,onScrollButtonChange:he,children:C.jsx("div",{ref:g,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:G},children:C.jsx(ee.div,{...l,ref:R,style:{boxSizing:"border-box",maxHeight:"100%",...l.style}})})})});Wt.displayName=Rr;var _r="SelectPopperPosition",it=I.forwardRef((n,s)=>{const{__scopeSelect:o,align:c="start",collisionPadding:l=oe,...f}=n,d=Ye(o);return C.jsx(Nn,{...d,...f,ref:s,align:c,collisionPadding:l,style:{boxSizing:"border-box",...f.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});it.displayName=_r;var[Ar,gt]=be(Re,{}),st="SelectViewport",zt=I.forwardRef((n,s)=>{const{__scopeSelect:o,nonce:c,...l}=n,f=Ie(st,o),d=gt(st,o),a=le(s,f.onViewportChange),g=I.useRef(0);return C.jsxs(C.Fragment,{children:[C.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:c}),C.jsx(Ve.Slot,{scope:o,children:C.jsx(ee.div,{"data-radix-select-viewport":"",role:"presentation",...l,ref:a,style:{position:"relative",flex:1,overflow:"hidden auto",...l.style},onScroll:K(l.onScroll,E=>{const T=E.currentTarget,{contentWrapper:R,shouldExpandOnScrollRef:_}=d;if(_!=null&&_.current&&R){const m=Math.abs(g.current-T.scrollTop);if(m>0){const w=window.innerHeight-oe*2,y=parseFloat(R.style.minHeight),S=parseFloat(R.style.height),A=Math.max(y,S);if(A<w){const x=A+m,v=Math.min(w,x),G=x-v;R.style.height=v+"px",R.style.bottom==="0px"&&(T.scrollTop=G>0?G:0,R.style.justifyContent="flex-end")}}}g.current=T.scrollTop})})})]})});zt.displayName=st;var Xt="SelectGroup",[Nr,br]=be(Xt),Jt=I.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n,l=ut();return C.jsx(Nr,{scope:o,id:l,children:C.jsx(ee.div,{role:"group","aria-labelledby":l,...c,ref:s})})});Jt.displayName=Xt;var Qt="SelectLabel",Or=I.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n,l=br(Qt,o);return C.jsx(ee.div,{id:l.id,...c,ref:s})});Or.displayName=Qt;var $e="SelectItem",[Br,Zt]=be($e),en=I.forwardRef((n,s)=>{const{__scopeSelect:o,value:c,disabled:l=!1,textValue:f,...d}=n,a=xe($e,o),g=Ie($e,o),E=a.value===c,[T,R]=I.useState(f??""),[_,m]=I.useState(!1),w=le(s,x=>{var v;return(v=g.itemRefCallback)==null?void 0:v.call(g,x,c,l)}),y=ut(),S=I.useRef("touch"),A=()=>{l||(a.onValueChange(c),a.onOpenChange(!1))};if(c==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return C.jsx(Br,{scope:o,value:c,disabled:l,textId:y,isSelected:E,onItemTextChange:I.useCallback(x=>{R(v=>v||((x==null?void 0:x.textContent)??"").trim())},[]),children:C.jsx(Ve.ItemSlot,{scope:o,value:c,disabled:l,textValue:T,children:C.jsx(ee.div,{role:"option","aria-labelledby":y,"data-highlighted":_?"":void 0,"aria-selected":E&&_,"data-state":E?"checked":"unchecked","aria-disabled":l||void 0,"data-disabled":l?"":void 0,tabIndex:l?void 0:-1,...d,ref:w,onFocus:K(d.onFocus,()=>m(!0)),onBlur:K(d.onBlur,()=>m(!1)),onClick:K(d.onClick,()=>{S.current!=="mouse"&&A()}),onPointerUp:K(d.onPointerUp,()=>{S.current==="mouse"&&A()}),onPointerDown:K(d.onPointerDown,x=>{S.current=x.pointerType}),onPointerMove:K(d.onPointerMove,x=>{var v;S.current=x.pointerType,l?(v=g.onItemLeave)==null||v.call(g):S.current==="mouse"&&x.currentTarget.focus({preventScroll:!0})}),onPointerLeave:K(d.onPointerLeave,x=>{var v;x.currentTarget===document.activeElement&&((v=g.onItemLeave)==null||v.call(g))}),onKeyDown:K(d.onKeyDown,x=>{var G;((G=g.searchRef)==null?void 0:G.current)!==""&&x.key===" "||(Er.includes(x.key)&&A(),x.key===" "&&x.preventDefault())})})})})});en.displayName=$e;var Le="SelectItemText",tn=I.forwardRef((n,s)=>{const{__scopeSelect:o,className:c,style:l,...f}=n,d=xe(Le,o),a=Ie(Le,o),g=Zt(Le,o),E=Cr(Le,o),[T,R]=I.useState(null),_=le(s,A=>R(A),g.onItemTextChange,A=>{var x;return(x=a.itemTextRefCallback)==null?void 0:x.call(a,A,g.value,g.disabled)}),m=T==null?void 0:T.textContent,w=I.useMemo(()=>C.jsx("option",{value:g.value,disabled:g.disabled,children:m},g.value),[g.disabled,g.value,m]),{onNativeOptionAdd:y,onNativeOptionRemove:S}=E;return we(()=>(y(w),()=>S(w)),[y,S,w]),C.jsxs(C.Fragment,{children:[C.jsx(ee.span,{id:g.textId,...f,ref:_}),g.isSelected&&d.valueNode&&!d.valueNodeHasChildren?Ot.createPortal(f.children,d.valueNode):null]})});tn.displayName=Le;var nn="SelectItemIndicator",rn=I.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n;return Zt(nn,o).isSelected?C.jsx(ee.span,{"aria-hidden":!0,...c,ref:s}):null});rn.displayName=nn;var at="SelectScrollUpButton",on=I.forwardRef((n,s)=>{const o=Ie(at,n.__scopeSelect),c=gt(at,n.__scopeSelect),[l,f]=I.useState(!1),d=le(s,c.onScrollButtonChange);return we(()=>{if(o.viewport&&o.isPositioned){let a=function(){const E=g.scrollTop>0;f(E)};const g=o.viewport;return a(),g.addEventListener("scroll",a),()=>g.removeEventListener("scroll",a)}},[o.viewport,o.isPositioned]),l?C.jsx(an,{...n,ref:d,onAutoScroll:()=>{const{viewport:a,selectedItem:g}=o;a&&g&&(a.scrollTop=a.scrollTop-g.offsetHeight)}}):null});on.displayName=at;var ct="SelectScrollDownButton",sn=I.forwardRef((n,s)=>{const o=Ie(ct,n.__scopeSelect),c=gt(ct,n.__scopeSelect),[l,f]=I.useState(!1),d=le(s,c.onScrollButtonChange);return we(()=>{if(o.viewport&&o.isPositioned){let a=function(){const E=g.scrollHeight-g.clientHeight,T=Math.ceil(g.scrollTop)<E;f(T)};const g=o.viewport;return a(),g.addEventListener("scroll",a),()=>g.removeEventListener("scroll",a)}},[o.viewport,o.isPositioned]),l?C.jsx(an,{...n,ref:d,onAutoScroll:()=>{const{viewport:a,selectedItem:g}=o;a&&g&&(a.scrollTop=a.scrollTop+g.offsetHeight)}}):null});sn.displayName=ct;var an=I.forwardRef((n,s)=>{const{__scopeSelect:o,onAutoScroll:c,...l}=n,f=Ie("SelectScrollButton",o),d=I.useRef(null),a=Ke(o),g=I.useCallback(()=>{d.current!==null&&(window.clearInterval(d.current),d.current=null)},[]);return I.useEffect(()=>()=>g(),[g]),we(()=>{var T;const E=a().find(R=>R.ref.current===document.activeElement);(T=E==null?void 0:E.ref.current)==null||T.scrollIntoView({block:"nearest"})},[a]),C.jsx(ee.div,{"aria-hidden":!0,...l,ref:s,style:{flexShrink:0,...l.style},onPointerDown:K(l.onPointerDown,()=>{d.current===null&&(d.current=window.setInterval(c,50))}),onPointerMove:K(l.onPointerMove,()=>{var E;(E=f.onItemLeave)==null||E.call(f),d.current===null&&(d.current=window.setInterval(c,50))}),onPointerLeave:K(l.onPointerLeave,()=>{g()})})}),Mr="SelectSeparator",Fr=I.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n;return C.jsx(ee.div,{"aria-hidden":!0,...c,ref:s})});Fr.displayName=Mr;var lt="SelectArrow",Lr=I.forwardRef((n,s)=>{const{__scopeSelect:o,...c}=n,l=Ye(o),f=xe(lt,o),d=Ie(lt,o);return f.open&&d.position==="popper"?C.jsx(bn,{...l,...c,ref:s}):null});Lr.displayName=lt;function cn(n){return n===""||n===void 0}var ln=I.forwardRef((n,s)=>{const{value:o,...c}=n,l=I.useRef(null),f=le(s,l),d=On(o);return I.useEffect(()=>{const a=l.current,g=window.HTMLSelectElement.prototype,T=Object.getOwnPropertyDescriptor(g,"value").set;if(d!==o&&T){const R=new Event("change",{bubbles:!0});T.call(a,o),a.dispatchEvent(R)}},[d,o]),C.jsx(Mn,{asChild:!0,children:C.jsx("select",{...c,ref:f,defaultValue:o})})});ln.displayName="BubbleSelect";function un(n){const s=Cn(n),o=I.useRef(""),c=I.useRef(0),l=I.useCallback(d=>{const a=o.current+d;s(a),function g(E){o.current=E,window.clearTimeout(c.current),E!==""&&(c.current=window.setTimeout(()=>g(""),1e3))}(a)},[s]),f=I.useCallback(()=>{o.current="",window.clearTimeout(c.current)},[]);return I.useEffect(()=>()=>window.clearTimeout(c.current),[]),[o,l,f]}function dn(n,s,o){const l=s.length>1&&Array.from(s).every(E=>E===s[0])?s[0]:s,f=o?n.indexOf(o):-1;let d=Pr(n,Math.max(f,0));l.length===1&&(d=d.filter(E=>E!==o));const g=d.find(E=>E.textValue.toLowerCase().startsWith(l.toLowerCase()));return g!==o?g:void 0}function Pr(n,s){return n.map((o,c)=>n[(s+c)%n.length])}var Ur=Dt,Dr=jt,kr=Ht,jr=$t,Gr=Vt,Hr=Kt,$r=zt,Vr=Jt,Kr=en,Yr=tn,qr=rn,Wr=on,zr=sn;function ao({...n}){return C.jsx(Ur,{"data-slot":"select",...n})}function co({...n}){return C.jsx(Vr,{"data-slot":"select-group",...n})}function lo({...n}){return C.jsx(kr,{"data-slot":"select-value",...n})}function uo({className:n,children:s,...o}){return C.jsxs(Dr,{"data-slot":"select-trigger",className:Ne("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive flex h-9 w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),...o,children:[s,C.jsx(jr,{asChild:!0,children:C.jsx(Bt,{className:"size-4 opacity-50"})})]})}function fo({className:n,children:s,position:o="popper",...c}){return C.jsx(Gr,{children:C.jsxs(Hr,{"data-slot":"select-content",className:Ne("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border shadow-md",o==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:o,...c,children:[C.jsx(Xr,{}),C.jsx($r,{className:Ne("p-1",o==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:s}),C.jsx(Jr,{})]})})}function ho({className:n,children:s,...o}){return C.jsxs(Kr,{"data-slot":"select-item",className:Ne("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",n),...o,children:[C.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:C.jsx(qr,{children:C.jsx(Bn,{className:"size-4"})})}),C.jsx(Yr,{children:s})]})}function Xr({className:n,...s}){return C.jsx(Wr,{"data-slot":"select-scroll-up-button",className:Ne("flex cursor-default items-center justify-center py-1",n),...s,children:C.jsx(Pn,{className:"size-4"})})}function Jr({className:n,...s}){return C.jsx(zr,{"data-slot":"select-scroll-down-button",className:Ne("flex cursor-default items-center justify-center py-1",n),...s,children:C.jsx(Bt,{className:"size-4"})})}export{Bt as C,ao as S,uo as a,lo as b,fo as c,ho as d,co as e,ro as f,io as g,oo as r};
