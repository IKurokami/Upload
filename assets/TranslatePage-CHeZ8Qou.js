import{c as Ne,ai as ms,r as S,aj as fs,ak as ps,al as hs,am as xs,an as gs,ao as On,j as e,a as je,G as Bn,ap as ws,B as G,a3 as vs,l as Oe,aq as pa,R as z,v as re,F as ha,ar as bs,a4 as Ee,a5 as Kt}from"./index-Ckvq7I9n.js";import{C as Rt,a as wn,b as vn,e as ys}from"./card-D17j2lNr.js";import{S as Un,b as Fn,c as Vn,d as Wn,e as qn,a as En,G as js,C as kn,h as xa,f as ga,i as Ns}from"./select-COj-WXi_.js";import{T as Bt,a as Gn}from"./index-DcegKw9e.js";import{T as Pe,a as ke,b as Re,c as Ae}from"./tooltip-C0O0Z8Mg.js";import{B as Ze}from"./badge-CGBSUmDJ.js";import{A as Cs}from"./arrow-right-BCw_oodE.js";import{I as Ke}from"./input-CUIMh8Lh.js";import{S as Ot,X as an}from"./scroll-area-BsbvJ_aN.js";import{T as Ss,a as Ts,b as Yn,c as Kn}from"./index-Bzv8Xteh.js";import{T as Es,R as ks,C as Rs,P as As,O as zs}from"./index-WvJQoUTl.js";import{T as dt}from"./trash-2-hXoBso6J.js";import{C as wa}from"./copy-DRIDxEX4.js";import{F as va}from"./file-down-q-1Y-svD.js";/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Ms=Ne("Archive",Ps);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Rn=Ne("ArrowUp",Is);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]],ba=Ne("ChevronsDown",Ds);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],ya=Ne("ChevronsUp",$s);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Hs=Ne("CircleCheckBig",Ls);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Lt=Ne("CircleCheck",_s);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],bn=Ne("Clipboard",Os);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],Us=Ne("Database",Bs);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]],Vs=Ne("Eraser",Fs);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],ja=Ne("FilePlus",Ws);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Gs=Ne("FileText",qs);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],yn=Ne("Folder",Ys);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Na=Ne("History",Ks);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],Ca=Ne("Lightbulb",Xs);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]],Zs=Ne("Network",Js);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],er=Ne("Pencil",Qs);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tr=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],An=Ne("Plus",tr);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nr=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],jn=Ne("RotateCcw",nr);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ar=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],sr=Ne("Sparkles",ar);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rr=[["path",{d:"M15 3v18",key:"14nvp0"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M21 9H3",key:"1338ky"}],["path",{d:"M21 15H3",key:"9uk58r"}]],ir=Ne("TableProperties",rr);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lr=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],or=Ne("Text",lr);/**
 * @license lucide-react v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cr=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],Xn=Ne("Users",cr);function Nn(t){const a=ms(()=>ps(t)),{isStatic:n}=S.useContext(fs);if(n){const[,s]=S.useState(t);S.useEffect(()=>a.on("change",s),[])}return a}function dr(t,a){const n=Nn(a()),s=()=>n.set(a());return s(),hs(()=>{const i=()=>xs.preRender(s,!1,!0),r=t.map(o=>o.on("change",i));return()=>{r.forEach(o=>o()),gs(s)}}),n}function ur(t,...a){const n=t.length;function s(){let i="";for(let r=0;r<n;r++){i+=t[r];const o=a[r];o&&(i+=On(o)?o.get():o)}return i}return dr(a.filter(On),s)}const mr=({text:t,className:a})=>{let n=Nn(0),s=Nn(0);const[i,r]=S.useState(""),[o,d]=S.useState(null);S.useEffect(()=>{if(o){const{width:v,height:b}=o.getBoundingClientRect(),x=v*b,u=Math.floor(x/36),y=Jn(u);r(y)}},[o]);function c({currentTarget:v,clientX:b,clientY:x}){let{left:u,top:y}=v.getBoundingClientRect();n.set(b-u),s.set(x-y);const{width:E,height:k}=v.getBoundingClientRect(),I=E*k,f=Math.floor(I/36),T=Jn(f);r(T)}return e.jsx("div",{className:je("p-0.5 bg-transparent flex items-center justify-center w-full h-full relative",a),children:e.jsxs("div",{ref:d,onMouseMove:c,className:"group/card rounded w-full relative overflow-hidden bg-transparent flex items-center justify-center h-full",children:[e.jsx(fr,{mouseX:n,mouseY:s,randomString:i}),e.jsx("div",{className:"relative z-10 flex items-center justify-center w-full h-full",children:e.jsxs("div",{className:"relative h-full w-full max-w-[80%] max-h-[80%] rounded-full flex items-center justify-center text-white font-bold",children:[e.jsx("div",{className:"absolute w-full h-full bg-white/[0.8] dark:bg-black/[0.8] blur-sm rounded-full"}),e.jsx("span",{className:"dark:text-white text-black z-20 text-xl lg:text-3xl",children:t})]})})]})})};function fr({mouseX:t,mouseY:a,randomString:n}){let s=ur`radial-gradient(500px at ${t}px ${a}px, white, transparent)`,i={maskImage:s,WebkitMaskImage:s};return e.jsxs("div",{className:"pointer-events-none",children:[e.jsx("div",{className:"absolute inset-0"}),e.jsx(Bn.div,{className:"absolute inset-0 bg-gradient-to-r from-green-500 to-blue-700 opacity-0 group-hover/card:opacity-100 backdrop-blur-xl transition duration-500",style:i}),e.jsx(Bn.div,{className:"absolute inset-0 opacity-0 mix-blend-overlay  group-hover/card:opacity-100",style:i,children:e.jsx("p",{className:"absolute inset-x-0 text-4xl h-full break-words whitespace-pre-wrap text-white font-mono font-bold transition duration-500",children:n})})]})}const Xt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Jn=t=>{let a="";for(let n=0;n<t;n++)a+=Xt.charAt(Math.floor(Math.random()*(Xt==null?void 0:Xt.length)));return a},Zn=32e3,pr=({inputText:t,setInputText:a,translatedText:n,isTranslating:s,error:i,isCopied:r,onTranslate:o,onCopy:d,selectedModel:c,onModelChange:v,models:b,selectedCollectionId:x,collections:u,onCollectionChange:y,isCollectionManagementVisible:E,onToggleCollectionManagement:k,arcrylicBg:I,modelDescriptions:f,clearInputText:T,setErrorMessage:D})=>{var R;const P=(t==null?void 0:t.length)||0;return e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 md:gap-8 min-h-[650px] max-h-[calc(100vh-200px)] w-full overflow-hidden",children:[e.jsxs(Rt,{className:je("flex-1 flex flex-col shadow-lg rounded-xl border-0 mb-6 lg:mb-0",I&&"arcrylic-blur"),children:[e.jsx(wn,{className:"pb-2 border-b border-muted/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(vn,{className:"text-xl sm:text-2xl font-bold tracking-tight",children:"ðŸ“ Translate Text"}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(Ze,{variant:"outline",className:"px-2 sm:px-3 py-1 h-auto rounded-full text-sm sm:text-base bg-muted/40",children:[e.jsx(ws,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),e.jsx("span",{className:"truncate max-w-[100px] sm:max-w-none",children:c})]})}),e.jsxs(Ae,{side:"left",children:[e.jsx("p",{className:"text-xs",children:"Current translation model"}),f&&f[c]&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:f[c]})]})]})})]})}),e.jsxs("div",{className:"flex-1 flex flex-col px-4 sm:px-6 py-3 sm:py-4 overflow-hidden",children:[e.jsxs("div",{className:"relative flex-1 overflow-hidden",children:[e.jsx(Bt,{id:"inputText",placeholder:"Type or paste text to translate...",className:"min-h-[200px] sm:min-h-[300px] h-full text-sm sm:text-lg leading-relaxed rounded-xl p-3 sm:p-4 pr-12 sm:pr-16 focus-visible:ring-1 focus-visible:ring-primary/30 transition-all resize-none shadow-sm max-h-[calc(100vh-200px)] overflow-auto break-words break-all whitespace-pre-wrap",value:t,maxLength:Zn,onChange:M=>a(M.target.value),"aria-label":"Input text to translate"}),e.jsxs("span",{className:"absolute bottom-2 right-4 text-xs text-muted-foreground/70",children:[P,"/",Zn]}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{variant:"ghost",size:"icon",onClick:T,disabled:!t.trim()||s,className:"absolute top-2 right-2 rounded-full","aria-label":"Clear input",children:e.jsx(jn,{className:"h-5 w-5"})})}),e.jsx(Ae,{side:"left",children:e.jsx("p",{className:"text-xs",children:"Clear input"})})]})})]}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 items-center w-full sm:w-auto",children:[e.jsxs(Un,{value:c,onValueChange:v,children:[e.jsx(Fn,{className:"h-8 text-xs font-medium px-2 py-1 rounded-full min-w-[90px] max-w-[110px]",children:e.jsx(Vn,{placeholder:"Model",children:e.jsx("span",{className:"truncate",children:c})})}),e.jsx(Wn,{className:"z-[100]",children:b.map(M=>e.jsx(qn,{value:M,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"truncate",children:M}),f&&f[M]&&e.jsx("span",{className:"text-xs text-muted-foreground",children:f[M]})]})},M))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsxs(Un,{value:x,onValueChange:y,children:[e.jsx(Fn,{className:"h-8 text-xs font-medium px-2 py-1 rounded-full min-w-[90px] max-w-[110px]",children:e.jsx(Vn,{placeholder:"Collection",children:e.jsx("span",{className:"truncate",children:((R=u.find(M=>M.id===x))==null?void 0:R.name)||"Collection"})})}),e.jsx(Wn,{className:"z-[100]",children:u.map(M=>e.jsx(qn,{value:M.id,children:e.jsx("span",{className:"truncate",children:M.name})},M.id))})]}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{variant:E?"default":"outline",size:"icon",onClick:()=>k(x),className:"h-8 w-8 rounded-full ml-1","aria-label":"Manage collections",children:e.jsx(vs,{className:"h-3 w-3"})})}),e.jsx(Ae,{side:"top",children:e.jsx("p",{className:"text-xs",children:"Manage collections"})})]})})]})]}),e.jsx(G,{onClick:o,disabled:s||!t.trim(),className:"h-8 px-3 rounded-full shadow-sm text-sm w-full sm:w-auto",size:"default","aria-label":"Translate",children:s?e.jsxs(e.Fragment,{children:[e.jsx(Oe,{className:"mr-2 h-3.5 w-3.5 animate-spin"})," Translating..."]}):e.jsxs(e.Fragment,{children:["Translate ",e.jsx(Cs,{className:"ml-2 h-3.5 w-3.5"})]})})]})]})]}),e.jsxs(Rt,{className:je("flex-1 flex flex-col shadow-lg rounded-3xl border-0 relative",I&&"arcrylic-blur"),children:[e.jsx(wn,{className:"pb-2 border-b border-muted/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(vn,{className:"text-xl sm:text-2xl font-bold tracking-tight",children:"ðŸŒ Translation"}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{variant:"ghost",size:"icon",onClick:d,disabled:!n,className:"rounded-full","aria-label":"Copy translation",children:r?e.jsx(Lt,{className:"h-4 w-4 text-green-500"}):e.jsx(bn,{className:"h-4 w-4"})})}),e.jsx(Ae,{side:"left",children:e.jsx("p",{className:"text-xs",children:r?"Copied!":"Copy to clipboard"})})]})})]})}),e.jsx("div",{className:"p-3 sm:p-4 flex-1 overflow-hidden",children:i?e.jsxs("div",{className:"text-destructive flex items-start p-3 rounded-lg bg-destructive/10 mb-3",children:[e.jsx(En,{className:"h-5 w-5 mr-2 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm",children:i}),e.jsx(G,{variant:"ghost",size:"sm",className:"h-7 mt-2 text-xs px-2 py-1",onClick:()=>D(null),children:"Dismiss"})]})]}):e.jsx(e.Fragment,{children:n?e.jsx("div",{className:"rounded-xl h-full overflow-y-auto px-4 py-3 bg-muted/30",children:e.jsx("p",{className:"text-sm sm:text-base whitespace-pre-wrap break-words",children:n})}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center p-6 text-muted-foreground",children:[e.jsx(mr,{text:"Translation",className:"w-64 h-64 opacity-30 mb-4"}),e.jsx("p",{className:"text-sm",children:"Enter text and click Translate to see results here"})]})})})]})]})},{createElement:At,createContext:hr,forwardRef:Sa,useCallback:Ve,useContext:Ta,useEffect:ut,useImperativeHandle:Ea,useLayoutEffect:xr,useMemo:gr,useRef:We,useState:Et}=pa,Qn=pa[`useId${Math.random()}`.slice(0,5)],wr=xr,sn=hr(null);sn.displayName="PanelGroupContext";const mt=wr,vr=typeof Qn=="function"?Qn:()=>null;let br=0;function zn(t=null){const a=vr(),n=We(t||a||null);return n.current===null&&(n.current=""+br++),t??n.current}function ka({children:t,className:a="",collapsedSize:n,collapsible:s,defaultSize:i,forwardedRef:r,id:o,maxSize:d,minSize:c,onCollapse:v,onExpand:b,onResize:x,order:u,style:y,tagName:E="div",...k}){const I=Ta(sn);if(I===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:f,expandPanel:T,getPanelSize:D,getPanelStyle:P,groupId:R,isPanelCollapsed:M,reevaluatePanelConstraints:p,registerPanel:H,resizePanel:_,unregisterPanel:le}=I,O=zn(o),K=We({callbacks:{onCollapse:v,onExpand:b,onResize:x},constraints:{collapsedSize:n,collapsible:s,defaultSize:i,maxSize:d,minSize:c},id:O,idIsFromProps:o!==void 0,order:u});We({didLogMissingDefaultSizeWarning:!1}),mt(()=>{const{callbacks:Q,constraints:Z}=K.current,se={...Z};K.current.id=O,K.current.idIsFromProps=o!==void 0,K.current.order=u,Q.onCollapse=v,Q.onExpand=b,Q.onResize=x,Z.collapsedSize=n,Z.collapsible=s,Z.defaultSize=i,Z.maxSize=d,Z.minSize=c,(se.collapsedSize!==Z.collapsedSize||se.collapsible!==Z.collapsible||se.maxSize!==Z.maxSize||se.minSize!==Z.minSize)&&p(K.current,se)}),mt(()=>{const Q=K.current;return H(Q),()=>{le(Q)}},[u,O,H,le]),Ea(r,()=>({collapse:()=>{f(K.current)},expand:Q=>{T(K.current,Q)},getId(){return O},getSize(){return D(K.current)},isCollapsed(){return M(K.current)},isExpanded(){return!M(K.current)},resize:Q=>{_(K.current,Q)}}),[f,T,D,M,O,_]);const $=P(K.current,i);return At(E,{...k,children:t,className:a,id:o,style:{...$,...y},"data-panel":"","data-panel-collapsible":s||void 0,"data-panel-group-id":R,"data-panel-id":O,"data-panel-size":parseFloat(""+$.flexGrow).toFixed(1)})}const Ra=Sa((t,a)=>At(ka,{...t,forwardedRef:a}));ka.displayName="Panel";Ra.displayName="forwardRef(Panel)";let Cn=null,ct=null;function yr(t,a){if(a){const n=(a&Ia)!==0,s=(a&Da)!==0,i=(a&$a)!==0,r=(a&La)!==0;if(n)return i?"se-resize":r?"ne-resize":"e-resize";if(s)return i?"sw-resize":r?"nw-resize":"w-resize";if(i)return"s-resize";if(r)return"n-resize"}switch(t){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function jr(){ct!==null&&(document.head.removeChild(ct),Cn=null,ct=null)}function mn(t,a){const n=yr(t,a);Cn!==n&&(Cn=n,ct===null&&(ct=document.createElement("style"),document.head.appendChild(ct)),ct.innerHTML=`*{cursor: ${n}!important;}`)}function Aa(t){return t.type==="keydown"}function za(t){return t.type.startsWith("pointer")}function Pa(t){return t.type.startsWith("mouse")}function rn(t){if(za(t)){if(t.isPrimary)return{x:t.clientX,y:t.clientY}}else if(Pa(t))return{x:t.clientX,y:t.clientY};return{x:1/0,y:1/0}}function Nr(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function Cr(t,a,n){return t.x<a.x+a.width&&t.x+t.width>a.x&&t.y<a.y+a.height&&t.y+t.height>a.y}function Sr(t,a){if(t===a)throw new Error("Cannot compare node with itself");const n={a:na(t),b:na(a)};let s;for(;n.a.at(-1)===n.b.at(-1);)t=n.a.pop(),a=n.b.pop(),s=t;ne(s,"Stacking order can only be calculated for elements with a common ancestor");const i={a:ta(ea(n.a)),b:ta(ea(n.b))};if(i.a===i.b){const r=s.childNodes,o={a:n.a.at(-1),b:n.b.at(-1)};let d=r.length;for(;d--;){const c=r[d];if(c===o.a)return 1;if(c===o.b)return-1}}return Math.sign(i.a-i.b)}const Tr=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Er(t){var a;const n=getComputedStyle((a=Ma(t))!==null&&a!==void 0?a:t).display;return n==="flex"||n==="inline-flex"}function kr(t){const a=getComputedStyle(t);return!!(a.position==="fixed"||a.zIndex!=="auto"&&(a.position!=="static"||Er(t))||+a.opacity<1||"transform"in a&&a.transform!=="none"||"webkitTransform"in a&&a.webkitTransform!=="none"||"mixBlendMode"in a&&a.mixBlendMode!=="normal"||"filter"in a&&a.filter!=="none"||"webkitFilter"in a&&a.webkitFilter!=="none"||"isolation"in a&&a.isolation==="isolate"||Tr.test(a.willChange)||a.webkitOverflowScrolling==="touch")}function ea(t){let a=t.length;for(;a--;){const n=t[a];if(ne(n,"Missing node"),kr(n))return n}return null}function ta(t){return t&&Number(getComputedStyle(t).zIndex)||0}function na(t){const a=[];for(;t;)a.push(t),t=Ma(t);return a}function Ma(t){const{parentNode:a}=t;return a&&a instanceof ShadowRoot?a.host:a}const Ia=1,Da=2,$a=4,La=8,Rr=Nr()==="coarse";let Qe=[],kt=!1,rt=new Map,ln=new Map;const Ut=new Set;function Ar(t,a,n,s,i){var r;const{ownerDocument:o}=a,d={direction:n,element:a,hitAreaMargins:s,setResizeHandlerState:i},c=(r=rt.get(o))!==null&&r!==void 0?r:0;return rt.set(o,c+1),Ut.add(d),tn(),function(){var b;ln.delete(t),Ut.delete(d);const x=(b=rt.get(o))!==null&&b!==void 0?b:1;if(rt.set(o,x-1),tn(),x===1&&rt.delete(o),Qe.includes(d)){const u=Qe.indexOf(d);u>=0&&Qe.splice(u,1),Mn(),i("up",!0,null)}}}function aa(t){const{target:a}=t,{x:n,y:s}=rn(t);kt=!0,Pn({target:a,x:n,y:s}),tn(),Qe.length>0&&(nn("down",t),t.preventDefault(),t.stopPropagation())}function It(t){const{x:a,y:n}=rn(t);if(kt&&t.buttons===0&&(kt=!1,nn("up",t)),!kt){const{target:s}=t;Pn({target:s,x:a,y:n})}nn("move",t),Mn(),Qe.length>0&&t.preventDefault()}function Nt(t){const{target:a}=t,{x:n,y:s}=rn(t);ln.clear(),kt=!1,Qe.length>0&&t.preventDefault(),nn("up",t),Pn({target:a,x:n,y:s}),Mn(),tn()}function Pn({target:t,x:a,y:n}){Qe.splice(0);let s=null;(t instanceof HTMLElement||t instanceof SVGElement)&&(s=t),Ut.forEach(i=>{const{element:r,hitAreaMargins:o}=i,d=r.getBoundingClientRect(),{bottom:c,left:v,right:b,top:x}=d,u=Rr?o.coarse:o.fine;if(a>=v-u&&a<=b+u&&n>=x-u&&n<=c+u){if(s!==null&&document.contains(s)&&r!==s&&!r.contains(s)&&!s.contains(r)&&Sr(s,r)>0){let E=s,k=!1;for(;E&&!E.contains(r);){if(Cr(E.getBoundingClientRect(),d)){k=!0;break}E=E.parentElement}if(k)return}Qe.push(i)}})}function fn(t,a){ln.set(t,a)}function Mn(){let t=!1,a=!1;Qe.forEach(s=>{const{direction:i}=s;i==="horizontal"?t=!0:a=!0});let n=0;ln.forEach(s=>{n|=s}),t&&a?mn("intersection",n):t?mn("horizontal",n):a?mn("vertical",n):jr()}function tn(){rt.forEach((t,a)=>{const{body:n}=a;n.removeEventListener("contextmenu",Nt),n.removeEventListener("pointerdown",aa),n.removeEventListener("pointerleave",It),n.removeEventListener("pointermove",It)}),window.removeEventListener("pointerup",Nt),window.removeEventListener("pointercancel",Nt),Ut.size>0&&(kt?(Qe.length>0&&rt.forEach((t,a)=>{const{body:n}=a;t>0&&(n.addEventListener("contextmenu",Nt),n.addEventListener("pointerleave",It),n.addEventListener("pointermove",It))}),window.addEventListener("pointerup",Nt),window.addEventListener("pointercancel",Nt)):rt.forEach((t,a)=>{const{body:n}=a;t>0&&(n.addEventListener("pointerdown",aa,{capture:!0}),n.addEventListener("pointermove",It))}))}function nn(t,a){Ut.forEach(n=>{const{setResizeHandlerState:s}=n,i=Qe.includes(n);s(t,i,a)})}function zr(){const[t,a]=Et(0);return Ve(()=>a(n=>n+1),[])}function ne(t,a){if(!t)throw console.error(a),Error(a)}const In=10;function ft(t,a,n=In){return t.toFixed(n)===a.toFixed(n)?0:t>a?1:-1}function at(t,a,n=In){return ft(t,a,n)===0}function Ye(t,a,n){return ft(t,a,n)===0}function Pr(t,a,n){if(t.length!==a.length)return!1;for(let s=0;s<t.length;s++){const i=t[s],r=a[s];if(!Ye(i,r,n))return!1}return!0}function Tt({panelConstraints:t,panelIndex:a,size:n}){const s=t[a];ne(s!=null,`Panel constraints not found for index ${a}`);let{collapsedSize:i=0,collapsible:r,maxSize:o=100,minSize:d=0}=s;if(ft(n,d)<0)if(r){const c=(i+d)/2;ft(n,c)<0?n=i:n=d}else n=d;return n=Math.min(o,n),n=parseFloat(n.toFixed(In)),n}function Ht({delta:t,initialLayout:a,panelConstraints:n,pivotIndices:s,prevLayout:i,trigger:r}){if(Ye(t,0))return a;const o=[...a],[d,c]=s;ne(d!=null,"Invalid first pivot index"),ne(c!=null,"Invalid second pivot index");let v=0;if(r==="keyboard"){{const x=t<0?c:d,u=n[x];ne(u,`Panel constraints not found for index ${x}`);const{collapsedSize:y=0,collapsible:E,minSize:k=0}=u;if(E){const I=a[x];if(ne(I!=null,`Previous layout not found for panel index ${x}`),Ye(I,y)){const f=k-I;ft(f,Math.abs(t))>0&&(t=t<0?0-f:f)}}}{const x=t<0?d:c,u=n[x];ne(u,`No panel constraints found for index ${x}`);const{collapsedSize:y=0,collapsible:E,minSize:k=0}=u;if(E){const I=a[x];if(ne(I!=null,`Previous layout not found for panel index ${x}`),Ye(I,k)){const f=I-y;ft(f,Math.abs(t))>0&&(t=t<0?0-f:f)}}}}{const x=t<0?1:-1;let u=t<0?c:d,y=0;for(;;){const k=a[u];ne(k!=null,`Previous layout not found for panel index ${u}`);const f=Tt({panelConstraints:n,panelIndex:u,size:100})-k;if(y+=f,u+=x,u<0||u>=n.length)break}const E=Math.min(Math.abs(t),Math.abs(y));t=t<0?0-E:E}{let u=t<0?d:c;for(;u>=0&&u<n.length;){const y=Math.abs(t)-Math.abs(v),E=a[u];ne(E!=null,`Previous layout not found for panel index ${u}`);const k=E-y,I=Tt({panelConstraints:n,panelIndex:u,size:k});if(!Ye(E,I)&&(v+=E-I,o[u]=I,v.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?u--:u++}}if(Pr(i,o))return i;{const x=t<0?c:d,u=a[x];ne(u!=null,`Previous layout not found for panel index ${x}`);const y=u+v,E=Tt({panelConstraints:n,panelIndex:x,size:y});if(o[x]=E,!Ye(E,y)){let k=y-E,f=t<0?c:d;for(;f>=0&&f<n.length;){const T=o[f];ne(T!=null,`Previous layout not found for panel index ${f}`);const D=T+k,P=Tt({panelConstraints:n,panelIndex:f,size:D});if(Ye(T,P)||(k-=P-T,o[f]=P),Ye(k,0))break;t>0?f--:f++}}}const b=o.reduce((x,u)=>u+x,0);return Ye(b,100)?o:i}function Mr({layout:t,panelsArray:a,pivotIndices:n}){let s=0,i=100,r=0,o=0;const d=n[0];ne(d!=null,"No pivot index found"),a.forEach((x,u)=>{const{constraints:y}=x,{maxSize:E=100,minSize:k=0}=y;u===d?(s=k,i=E):(r+=k,o+=E)});const c=Math.min(i,100-r),v=Math.max(s,100-o),b=t[d];return{valueMax:c,valueMin:v,valueNow:b}}function Ft(t,a=document){return Array.from(a.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`))}function Ha(t,a,n=document){const i=Ft(t,n).findIndex(r=>r.getAttribute("data-panel-resize-handle-id")===a);return i??null}function _a(t,a,n){const s=Ha(t,a,n);return s!=null?[s,s+1]:[-1,-1]}function Oa(t,a=document){var n;if(a instanceof HTMLElement&&(a==null||(n=a.dataset)===null||n===void 0?void 0:n.panelGroupId)==t)return a;const s=a.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return s||null}function on(t,a=document){const n=a.querySelector(`[data-panel-resize-handle-id="${t}"]`);return n||null}function Ir(t,a,n,s=document){var i,r,o,d;const c=on(a,s),v=Ft(t,s),b=c?v.indexOf(c):-1,x=(i=(r=n[b])===null||r===void 0?void 0:r.id)!==null&&i!==void 0?i:null,u=(o=(d=n[b+1])===null||d===void 0?void 0:d.id)!==null&&o!==void 0?o:null;return[x,u]}function Dr({committedValuesRef:t,eagerValuesRef:a,groupId:n,layout:s,panelDataArray:i,panelGroupElement:r,setLayout:o}){We({didWarnAboutMissingResizeHandle:!1}),mt(()=>{if(!r)return;const d=Ft(n,r);for(let c=0;c<i.length-1;c++){const{valueMax:v,valueMin:b,valueNow:x}=Mr({layout:s,panelsArray:i,pivotIndices:[c,c+1]}),u=d[c];if(u!=null){const y=i[c];ne(y,`No panel data found for index "${c}"`),u.setAttribute("aria-controls",y.id),u.setAttribute("aria-valuemax",""+Math.round(v)),u.setAttribute("aria-valuemin",""+Math.round(b)),u.setAttribute("aria-valuenow",x!=null?""+Math.round(x):"")}}return()=>{d.forEach((c,v)=>{c.removeAttribute("aria-controls"),c.removeAttribute("aria-valuemax"),c.removeAttribute("aria-valuemin"),c.removeAttribute("aria-valuenow")})}},[n,s,i,r]),ut(()=>{if(!r)return;const d=a.current;ne(d,"Eager values not found");const{panelDataArray:c}=d,v=Oa(n,r);ne(v!=null,`No group found for id "${n}"`);const b=Ft(n,r);ne(b,`No resize handles found for group id "${n}"`);const x=b.map(u=>{const y=u.getAttribute("data-panel-resize-handle-id");ne(y,"Resize handle element has no handle id attribute");const[E,k]=Ir(n,y,c,r);if(E==null||k==null)return()=>{};const I=f=>{if(!f.defaultPrevented)switch(f.key){case"Enter":{f.preventDefault();const T=c.findIndex(D=>D.id===E);if(T>=0){const D=c[T];ne(D,`No panel data found for index ${T}`);const P=s[T],{collapsedSize:R=0,collapsible:M,minSize:p=0}=D.constraints;if(P!=null&&M){const H=Ht({delta:Ye(P,R)?p-R:R-P,initialLayout:s,panelConstraints:c.map(_=>_.constraints),pivotIndices:_a(n,y,r),prevLayout:s,trigger:"keyboard"});s!==H&&o(H)}}break}}};return u.addEventListener("keydown",I),()=>{u.removeEventListener("keydown",I)}});return()=>{x.forEach(u=>u())}},[r,t,a,n,s,i,o])}function sa(t,a){if(t.length!==a.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==a[n])return!1;return!0}function Ba(t,a){const n=t==="horizontal",{x:s,y:i}=rn(a);return n?s:i}function $r(t,a,n,s,i){const r=n==="horizontal",o=on(a,i);ne(o,`No resize handle element found for id "${a}"`);const d=o.getAttribute("data-panel-group-id");ne(d,"Resize handle element has no group id attribute");let{initialCursorPosition:c}=s;const v=Ba(n,t),b=Oa(d,i);ne(b,`No group element found for id "${d}"`);const x=b.getBoundingClientRect(),u=r?x.width:x.height;return(v-c)/u*100}function Lr(t,a,n,s,i,r){if(Aa(t)){const o=n==="horizontal";let d=0;t.shiftKey?d=100:i!=null?d=i:d=10;let c=0;switch(t.key){case"ArrowDown":c=o?0:d;break;case"ArrowLeft":c=o?-d:0;break;case"ArrowRight":c=o?d:0;break;case"ArrowUp":c=o?0:-d;break;case"End":c=100;break;case"Home":c=-100;break}return c}else return s==null?0:$r(t,a,n,s,r)}function Hr({panelDataArray:t}){const a=Array(t.length),n=t.map(r=>r.constraints);let s=0,i=100;for(let r=0;r<t.length;r++){const o=n[r];ne(o,`Panel constraints not found for index ${r}`);const{defaultSize:d}=o;d!=null&&(s++,a[r]=d,i-=d)}for(let r=0;r<t.length;r++){const o=n[r];ne(o,`Panel constraints not found for index ${r}`);const{defaultSize:d}=o;if(d!=null)continue;const c=t.length-s,v=i/c;s++,a[r]=v,i-=v}return a}function Ct(t,a,n){a.forEach((s,i)=>{const r=t[i];ne(r,`Panel data not found for index ${i}`);const{callbacks:o,constraints:d,id:c}=r,{collapsedSize:v=0,collapsible:b}=d,x=n[c];if(x==null||s!==x){n[c]=s;const{onCollapse:u,onExpand:y,onResize:E}=o;E&&E(s,x),b&&(u||y)&&(y&&(x==null||at(x,v))&&!at(s,v)&&y(),u&&(x==null||!at(x,v))&&at(s,v)&&u())}})}function Jt(t,a){if(t.length!==a.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!=a[n])return!1;return!0}function _r({defaultSize:t,dragState:a,layout:n,panelData:s,panelIndex:i,precision:r=3}){const o=n[i];let d;return o==null?d=t!=null?t.toPrecision(r):"1":s.length===1?d="1":d=o.toPrecision(r),{flexBasis:0,flexGrow:d,flexShrink:1,overflow:"hidden",pointerEvents:a!==null?"none":void 0}}function Or(t,a=10){let n=null;return(...i)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{t(...i)},a)}}function ra(t){try{if(typeof localStorage<"u")t.getItem=a=>localStorage.getItem(a),t.setItem=(a,n)=>{localStorage.setItem(a,n)};else throw new Error("localStorage not supported in this environment")}catch(a){console.error(a),t.getItem=()=>null,t.setItem=()=>{}}}function Ua(t){return`react-resizable-panels:${t}`}function Fa(t){return t.map(a=>{const{constraints:n,id:s,idIsFromProps:i,order:r}=a;return i?s:r?`${r}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((a,n)=>a.localeCompare(n)).join(",")}function Va(t,a){try{const n=Ua(t),s=a.getItem(n);if(s){const i=JSON.parse(s);if(typeof i=="object"&&i!=null)return i}}catch{}return null}function Br(t,a,n){var s,i;const r=(s=Va(t,n))!==null&&s!==void 0?s:{},o=Fa(a);return(i=r[o])!==null&&i!==void 0?i:null}function Ur(t,a,n,s,i){var r;const o=Ua(t),d=Fa(a),c=(r=Va(t,i))!==null&&r!==void 0?r:{};c[d]={expandToSizes:Object.fromEntries(n.entries()),layout:s};try{i.setItem(o,JSON.stringify(c))}catch(v){console.error(v)}}function ia({layout:t,panelConstraints:a}){const n=[...t],s=n.reduce((r,o)=>r+o,0);if(n.length!==a.length)throw Error(`Invalid ${a.length} panel layout: ${n.map(r=>`${r}%`).join(", ")}`);if(!Ye(s,100)&&n.length>0)for(let r=0;r<a.length;r++){const o=n[r];ne(o!=null,`No layout data found for index ${r}`);const d=100/s*o;n[r]=d}let i=0;for(let r=0;r<a.length;r++){const o=n[r];ne(o!=null,`No layout data found for index ${r}`);const d=Tt({panelConstraints:a,panelIndex:r,size:o});o!=d&&(i+=o-d,n[r]=d)}if(!Ye(i,0))for(let r=0;r<a.length;r++){const o=n[r];ne(o!=null,`No layout data found for index ${r}`);const d=o+i,c=Tt({panelConstraints:a,panelIndex:r,size:d});if(o!==c&&(i-=c-o,n[r]=c,Ye(i,0)))break}return n}const Fr=100,_t={getItem:t=>(ra(_t),_t.getItem(t)),setItem:(t,a)=>{ra(_t),_t.setItem(t,a)}},la={};function Wa({autoSaveId:t=null,children:a,className:n="",direction:s,forwardedRef:i,id:r=null,onLayout:o=null,keyboardResizeBy:d=null,storage:c=_t,style:v,tagName:b="div",...x}){const u=zn(r),y=We(null),[E,k]=Et(null),[I,f]=Et([]),T=zr(),D=We({}),P=We(new Map),R=We(0),M=We({autoSaveId:t,direction:s,dragState:E,id:u,keyboardResizeBy:d,onLayout:o,storage:c}),p=We({layout:I,panelDataArray:[],panelDataArrayChanged:!1});We({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),Ea(i,()=>({getId:()=>M.current.id,getLayout:()=>{const{layout:j}=p.current;return j},setLayout:j=>{const{onLayout:F}=M.current,{layout:W,panelDataArray:V}=p.current,B=ia({layout:j,panelConstraints:V.map(Y=>Y.constraints)});sa(W,B)||(f(B),p.current.layout=B,F&&F(B),Ct(V,B,D.current))}}),[]),mt(()=>{M.current.autoSaveId=t,M.current.direction=s,M.current.dragState=E,M.current.id=u,M.current.onLayout=o,M.current.storage=c}),Dr({committedValuesRef:M,eagerValuesRef:p,groupId:u,layout:I,panelDataArray:p.current.panelDataArray,setLayout:f,panelGroupElement:y.current}),ut(()=>{const{panelDataArray:j}=p.current;if(t){if(I.length===0||I.length!==j.length)return;let F=la[t];F==null&&(F=Or(Ur,Fr),la[t]=F);const W=[...j],V=new Map(P.current);F(t,W,V,I,c)}},[t,I,c]),ut(()=>{});const H=Ve(j=>{const{onLayout:F}=M.current,{layout:W,panelDataArray:V}=p.current;if(j.constraints.collapsible){const B=V.map(me=>me.constraints),{collapsedSize:Y=0,panelSize:oe,pivotIndices:J}=ot(V,j,W);if(ne(oe!=null,`Panel size not found for panel "${j.id}"`),!at(oe,Y)){P.current.set(j.id,oe);const he=St(V,j)===V.length-1?oe-Y:Y-oe,ie=Ht({delta:he,initialLayout:W,panelConstraints:B,pivotIndices:J,prevLayout:W,trigger:"imperative-api"});Jt(W,ie)||(f(ie),p.current.layout=ie,F&&F(ie),Ct(V,ie,D.current))}}},[]),_=Ve((j,F)=>{const{onLayout:W}=M.current,{layout:V,panelDataArray:B}=p.current;if(j.constraints.collapsible){const Y=B.map(L=>L.constraints),{collapsedSize:oe=0,panelSize:J=0,minSize:me=0,pivotIndices:he}=ot(B,j,V),ie=F??me;if(at(J,oe)){const L=P.current.get(j.id),Le=L!=null&&L>=ie?L:ie,Ce=St(B,j)===B.length-1?J-Le:Le-J,Se=Ht({delta:Ce,initialLayout:V,panelConstraints:Y,pivotIndices:he,prevLayout:V,trigger:"imperative-api"});Jt(V,Se)||(f(Se),p.current.layout=Se,W&&W(Se),Ct(B,Se,D.current))}}},[]),le=Ve(j=>{const{layout:F,panelDataArray:W}=p.current,{panelSize:V}=ot(W,j,F);return ne(V!=null,`Panel size not found for panel "${j.id}"`),V},[]),O=Ve((j,F)=>{const{panelDataArray:W}=p.current,V=St(W,j);return _r({defaultSize:F,dragState:E,layout:I,panelData:W,panelIndex:V})},[E,I]),K=Ve(j=>{const{layout:F,panelDataArray:W}=p.current,{collapsedSize:V=0,collapsible:B,panelSize:Y}=ot(W,j,F);return ne(Y!=null,`Panel size not found for panel "${j.id}"`),B===!0&&at(Y,V)},[]),$=Ve(j=>{const{layout:F,panelDataArray:W}=p.current,{collapsedSize:V=0,collapsible:B,panelSize:Y}=ot(W,j,F);return ne(Y!=null,`Panel size not found for panel "${j.id}"`),!B||ft(Y,V)>0},[]),Q=Ve(j=>{const{panelDataArray:F}=p.current;F.push(j),F.sort((W,V)=>{const B=W.order,Y=V.order;return B==null&&Y==null?0:B==null?-1:Y==null?1:B-Y}),p.current.panelDataArrayChanged=!0,T()},[T]);mt(()=>{if(p.current.panelDataArrayChanged){p.current.panelDataArrayChanged=!1;const{autoSaveId:j,onLayout:F,storage:W}=M.current,{layout:V,panelDataArray:B}=p.current;let Y=null;if(j){const J=Br(j,B,W);J&&(P.current=new Map(Object.entries(J.expandToSizes)),Y=J.layout)}Y==null&&(Y=Hr({panelDataArray:B}));const oe=ia({layout:Y,panelConstraints:B.map(J=>J.constraints)});sa(V,oe)||(f(oe),p.current.layout=oe,F&&F(oe),Ct(B,oe,D.current))}}),mt(()=>{const j=p.current;return()=>{j.layout=[]}},[]);const Z=Ve(j=>{let F=!1;const W=y.current;return W&&window.getComputedStyle(W,null).getPropertyValue("direction")==="rtl"&&(F=!0),function(B){B.preventDefault();const Y=y.current;if(!Y)return()=>null;const{direction:oe,dragState:J,id:me,keyboardResizeBy:he,onLayout:ie}=M.current,{layout:L,panelDataArray:Le}=p.current,{initialLayout:$e}=J??{},Ce=_a(me,j,Y);let Se=Lr(B,j,oe,J,he,Y);const Be=oe==="horizontal";Be&&F&&(Se=-Se);const Ue=Le.map(ye=>ye.constraints),_e=Ht({delta:Se,initialLayout:$e??L,panelConstraints:Ue,pivotIndices:Ce,prevLayout:L,trigger:Aa(B)?"keyboard":"mouse-or-touch"}),be=!Jt(L,_e);(za(B)||Pa(B))&&R.current!=Se&&(R.current=Se,!be&&Se!==0?Be?fn(j,Se<0?Ia:Da):fn(j,Se<0?$a:La):fn(j,0)),be&&(f(_e),p.current.layout=_e,ie&&ie(_e),Ct(Le,_e,D.current))}},[]),se=Ve((j,F)=>{const{onLayout:W}=M.current,{layout:V,panelDataArray:B}=p.current,Y=B.map(L=>L.constraints),{panelSize:oe,pivotIndices:J}=ot(B,j,V);ne(oe!=null,`Panel size not found for panel "${j.id}"`);const he=St(B,j)===B.length-1?oe-F:F-oe,ie=Ht({delta:he,initialLayout:V,panelConstraints:Y,pivotIndices:J,prevLayout:V,trigger:"imperative-api"});Jt(V,ie)||(f(ie),p.current.layout=ie,W&&W(ie),Ct(B,ie,D.current))},[]),de=Ve((j,F)=>{const{layout:W,panelDataArray:V}=p.current,{collapsedSize:B=0,collapsible:Y}=F,{collapsedSize:oe=0,collapsible:J,maxSize:me=100,minSize:he=0}=j.constraints,{panelSize:ie}=ot(V,j,W);ie!=null&&(Y&&J&&at(ie,B)?at(B,oe)||se(j,oe):ie<he?se(j,he):ie>me&&se(j,me))},[se]),ue=Ve((j,F)=>{const{direction:W}=M.current,{layout:V}=p.current;if(!y.current)return;const B=on(j,y.current);ne(B,`Drag handle element not found for id "${j}"`);const Y=Ba(W,F);k({dragHandleId:j,dragHandleRect:B.getBoundingClientRect(),initialCursorPosition:Y,initialLayout:V})},[]),ee=Ve(()=>{k(null)},[]),te=Ve(j=>{const{panelDataArray:F}=p.current,W=St(F,j);W>=0&&(F.splice(W,1),delete D.current[j.id],p.current.panelDataArrayChanged=!0,T())},[T]),X=gr(()=>({collapsePanel:H,direction:s,dragState:E,expandPanel:_,getPanelSize:le,getPanelStyle:O,groupId:u,isPanelCollapsed:K,isPanelExpanded:$,reevaluatePanelConstraints:de,registerPanel:Q,registerResizeHandle:Z,resizePanel:se,startDragging:ue,stopDragging:ee,unregisterPanel:te,panelGroupElement:y.current}),[H,E,s,_,le,O,u,K,$,de,Q,Z,se,ue,ee,te]),Me={display:"flex",flexDirection:s==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return At(sn.Provider,{value:X},At(b,{...x,children:a,className:n,id:r,ref:y,style:{...Me,...v},"data-panel-group":"","data-panel-group-direction":s,"data-panel-group-id":u}))}const qa=Sa((t,a)=>At(Wa,{...t,forwardedRef:a}));Wa.displayName="PanelGroup";qa.displayName="forwardRef(PanelGroup)";function St(t,a){return t.findIndex(n=>n===a||n.id===a.id)}function ot(t,a,n){const s=St(t,a),r=s===t.length-1?[s-1,s]:[s,s+1],o=n[s];return{...a.constraints,panelSize:o,pivotIndices:r}}function Vr({disabled:t,handleId:a,resizeHandler:n,panelGroupElement:s}){ut(()=>{if(t||n==null||s==null)return;const i=on(a,s);if(i==null)return;const r=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),n(o);break}case"F6":{o.preventDefault();const d=i.getAttribute("data-panel-group-id");ne(d,`No group element found for id "${d}"`);const c=Ft(d,s),v=Ha(d,a,s);ne(v!==null,`No resize element found for id "${a}"`);const b=o.shiftKey?v>0?v-1:c.length-1:v+1<c.length?v+1:0;c[b].focus();break}}};return i.addEventListener("keydown",r),()=>{i.removeEventListener("keydown",r)}},[s,t,a,n])}function Ga({children:t=null,className:a="",disabled:n=!1,hitAreaMargins:s,id:i,onBlur:r,onDragging:o,onFocus:d,style:c={},tabIndex:v=0,tagName:b="div",...x}){var u,y;const E=We(null),k=We({onDragging:o});ut(()=>{k.current.onDragging=o});const I=Ta(sn);if(I===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:f,groupId:T,registerResizeHandle:D,startDragging:P,stopDragging:R,panelGroupElement:M}=I,p=zn(i),[H,_]=Et("inactive"),[le,O]=Et(!1),[K,$]=Et(null),Q=We({state:H});mt(()=>{Q.current.state=H}),ut(()=>{if(n)$(null);else{const ue=D(p);$(()=>ue)}},[n,p,D]);const Z=(u=s==null?void 0:s.coarse)!==null&&u!==void 0?u:15,se=(y=s==null?void 0:s.fine)!==null&&y!==void 0?y:5;return ut(()=>{if(n||K==null)return;const ue=E.current;return ne(ue,"Element ref not attached"),Ar(p,ue,f,{coarse:Z,fine:se},(te,X,Me)=>{if(X)switch(te){case"down":{_("drag"),ne(Me,'Expected event to be defined for "down" action'),P(p,Me);const{onDragging:j}=k.current;j&&j(!0);break}case"move":{const{state:j}=Q.current;j!=="drag"&&_("hover"),ne(Me,'Expected event to be defined for "move" action'),K(Me);break}case"up":{_("hover"),R();const{onDragging:j}=k.current;j&&j(!1);break}}else _("inactive")})},[Z,f,n,se,D,p,K,P,R]),Vr({disabled:n,handleId:p,resizeHandler:K,panelGroupElement:M}),At(b,{...x,children:t,className:a,id:i,onBlur:()=>{O(!1),r==null||r()},onFocus:()=>{O(!0),d==null||d()},ref:E,role:"separator",style:{...{touchAction:"none",userSelect:"none"},...c},tabIndex:v,"data-panel-group-direction":f,"data-panel-group-id":T,"data-resize-handle":"","data-resize-handle-active":H==="drag"?"pointer":le?"keyboard":void 0,"data-resize-handle-state":H,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":p})}Ga.displayName="PanelResizeHandle";function Wr({className:t,...a}){return e.jsx(qa,{"data-slot":"resizable-panel-group",className:je("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})}function oa({...t}){return e.jsx(Ra,{"data-slot":"resizable-panel",...t})}function qr({withHandle:t,className:a,...n}){return e.jsx(Ga,{"data-slot":"resizable-handle",className:je("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",a),...n,children:t&&e.jsx("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:e.jsx(js,{className:"size-2.5"})})})}function Gr(t){if(typeof document>"u")return;let a=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",a.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}const Ya=z.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),Vt=()=>{const t=z.useContext(Ya);if(!t)throw new Error("useDrawerContext must be used within a Drawer.Root");return t};Gr(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function Yr(){const t=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(t)&&/Mobile/.test(t)||/FxiOS/.test(t))}function Kr(){return Dn(/^Mac/)}function Xr(){return Dn(/^iPhone/)}function ca(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function Jr(){return Dn(/^iPad/)||Kr()&&navigator.maxTouchPoints>1}function Ka(){return Xr()||Jr()}function Dn(t){return typeof window<"u"&&window.navigator!=null?t.test(window.navigator.platform):void 0}const Zr=24,Qr=typeof window<"u"?S.useLayoutEffect:S.useEffect;function da(...t){return(...a)=>{for(let n of t)typeof n=="function"&&n(...a)}}const pn=typeof document<"u"&&window.visualViewport;function ua(t){let a=window.getComputedStyle(t);return/(auto|scroll)/.test(a.overflow+a.overflowX+a.overflowY)}function Xa(t){for(ua(t)&&(t=t.parentElement);t&&!ua(t);)t=t.parentElement;return t||document.scrollingElement||document.documentElement}const ei=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let Zt=0,hn;function ti(t={}){let{isDisabled:a}=t;Qr(()=>{if(!a)return Zt++,Zt===1&&Ka()&&(hn=ni()),()=>{Zt--,Zt===0&&(hn==null||hn())}},[a])}function ni(){let t,a=0,n=x=>{t=Xa(x.target),!(t===document.documentElement&&t===document.body)&&(a=x.changedTouches[0].pageY)},s=x=>{if(!t||t===document.documentElement||t===document.body){x.preventDefault();return}let u=x.changedTouches[0].pageY,y=t.scrollTop,E=t.scrollHeight-t.clientHeight;E!==0&&((y<=0&&u>a||y>=E&&u<a)&&x.preventDefault(),a=u)},i=x=>{let u=x.target;Sn(u)&&u!==document.activeElement&&(x.preventDefault(),u.style.transform="translateY(-2000px)",u.focus(),requestAnimationFrame(()=>{u.style.transform=""}))},r=x=>{let u=x.target;Sn(u)&&(u.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{u.style.transform="",pn&&(pn.height<window.innerHeight?requestAnimationFrame(()=>{ma(u)}):pn.addEventListener("resize",()=>ma(u),{once:!0}))}))},o=()=>{window.scrollTo(0,0)},d=window.pageXOffset,c=window.pageYOffset,v=da(ai(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let b=da(Dt(document,"touchstart",n,{passive:!1,capture:!0}),Dt(document,"touchmove",s,{passive:!1,capture:!0}),Dt(document,"touchend",i,{passive:!1,capture:!0}),Dt(document,"focus",r,!0),Dt(window,"scroll",o));return()=>{v(),b(),window.scrollTo(d,c)}}function ai(t,a,n){let s=t.style[a];return t.style[a]=n,()=>{t.style[a]=s}}function Dt(t,a,n,s){return t.addEventListener(a,n,s),()=>{t.removeEventListener(a,n,s)}}function ma(t){let a=document.scrollingElement||document.documentElement;for(;t&&t!==a;){let n=Xa(t);if(n!==document.documentElement&&n!==document.body&&n!==t){let s=n.getBoundingClientRect().top,i=t.getBoundingClientRect().top,r=t.getBoundingClientRect().bottom;const o=n.getBoundingClientRect().bottom+Zr;r>o&&(n.scrollTop+=i-s)}t=n.parentElement}}function Sn(t){return t instanceof HTMLInputElement&&!ei.has(t.type)||t instanceof HTMLTextAreaElement||t instanceof HTMLElement&&t.isContentEditable}function si(t,a){typeof t=="function"?t(a):t!=null&&(t.current=a)}function ri(...t){return a=>t.forEach(n=>si(n,a))}function Ja(...t){return S.useCallback(ri(...t),t)}const Za=new WeakMap;function Ie(t,a,n=!1){if(!t||!(t instanceof HTMLElement))return;let s={};Object.entries(a).forEach(([i,r])=>{if(i.startsWith("--")){t.style.setProperty(i,r);return}s[i]=t.style[i],t.style[i]=r}),!n&&Za.set(t,s)}function ii(t,a){if(!t||!(t instanceof HTMLElement))return;let n=Za.get(t);n&&(t.style[a]=n[a])}const ze=t=>{switch(t){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return t}};function Qt(t,a){if(!t)return null;const n=window.getComputedStyle(t),s=n.transform||n.webkitTransform||n.mozTransform;let i=s.match(/^matrix3d\((.+)\)$/);return i?parseFloat(i[1].split(", ")[ze(a)?13:12]):(i=s.match(/^matrix\((.+)\)$/),i?parseFloat(i[1].split(", ")[ze(a)?5:4]):null)}function li(t){return 8*(Math.log(t+1)-2)}function xn(t,a){if(!t)return()=>{};const n=t.style.cssText;return Object.assign(t.style,a),()=>{t.style.cssText=n}}function oi(...t){return(...a)=>{for(const n of t)typeof n=="function"&&n(...a)}}const ve={DURATION:.5,EASE:[.32,.72,0,1]},Qa=.4,ci=.25,di=100,es=8,en=16,Tn=26,gn="vaul-dragging";function ts(t){const a=z.useRef(t);return z.useEffect(()=>{a.current=t}),z.useMemo(()=>(...n)=>a.current==null?void 0:a.current.call(a,...n),[])}function ui({defaultProp:t,onChange:a}){const n=z.useState(t),[s]=n,i=z.useRef(s),r=ts(a);return z.useEffect(()=>{i.current!==s&&(r(s),i.current=s)},[s,i,r]),n}function ns({prop:t,defaultProp:a,onChange:n=()=>{}}){const[s,i]=ui({defaultProp:a,onChange:n}),r=t!==void 0,o=r?t:s,d=ts(n),c=z.useCallback(v=>{if(r){const x=typeof v=="function"?v(t):v;x!==t&&d(x)}else i(v)},[r,t,i,d]);return[o,c]}function mi({activeSnapPointProp:t,setActiveSnapPointProp:a,snapPoints:n,drawerRef:s,overlayRef:i,fadeFromIndex:r,onSnapPointChange:o,direction:d="bottom",container:c,snapToSequentialPoint:v}){const[b,x]=ns({prop:t,defaultProp:n==null?void 0:n[0],onChange:a}),[u,y]=z.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);z.useEffect(()=>{function p(){y({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]);const E=z.useMemo(()=>b===(n==null?void 0:n[n.length-1])||null,[n,b]),k=z.useMemo(()=>{var p;return(p=n==null?void 0:n.findIndex(H=>H===b))!=null?p:null},[n,b]),I=n&&n.length>0&&(r||r===0)&&!Number.isNaN(r)&&n[r]===b||!n,f=z.useMemo(()=>{const p=c?{width:c.getBoundingClientRect().width,height:c.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var H;return(H=n==null?void 0:n.map(_=>{const le=typeof _=="string";let O=0;if(le&&(O=parseInt(_,10)),ze(d)){const $=le?O:u?_*p.height:0;return u?d==="bottom"?p.height-$:-p.height+$:$}const K=le?O:u?_*p.width:0;return u?d==="right"?p.width-K:-p.width+K:K}))!=null?H:[]},[n,u,c]),T=z.useMemo(()=>k!==null?f==null?void 0:f[k]:null,[f,k]),D=z.useCallback(p=>{var H;const _=(H=f==null?void 0:f.findIndex(le=>le===p))!=null?H:null;o(_),Ie(s.current,{transition:`transform ${ve.DURATION}s cubic-bezier(${ve.EASE.join(",")})`,transform:ze(d)?`translate3d(0, ${p}px, 0)`:`translate3d(${p}px, 0, 0)`}),f&&_!==f.length-1&&r!==void 0&&_!==r&&_<r?Ie(i.current,{transition:`opacity ${ve.DURATION}s cubic-bezier(${ve.EASE.join(",")})`,opacity:"0"}):Ie(i.current,{transition:`opacity ${ve.DURATION}s cubic-bezier(${ve.EASE.join(",")})`,opacity:"1"}),x(n==null?void 0:n[Math.max(_,0)])},[s.current,n,f,r,i,x]);z.useEffect(()=>{if(b||t){var p;const H=(p=n==null?void 0:n.findIndex(_=>_===t||_===b))!=null?p:-1;f&&H!==-1&&typeof f[H]=="number"&&D(f[H])}},[b,t,n,f,D]);function P({draggedDistance:p,closeDrawer:H,velocity:_,dismissible:le}){if(r===void 0)return;const O=d==="bottom"||d==="right"?(T??0)-p:(T??0)+p,K=k===r-1,$=k===0,Q=p>0;if(K&&Ie(i.current,{transition:`opacity ${ve.DURATION}s cubic-bezier(${ve.EASE.join(",")})`}),!v&&_>2&&!Q){le?H():D(f[0]);return}if(!v&&_>2&&Q&&f&&n){D(f[n.length-1]);return}const Z=f==null?void 0:f.reduce((de,ue)=>typeof de!="number"||typeof ue!="number"?de:Math.abs(ue-O)<Math.abs(de-O)?ue:de),se=ze(d)?window.innerHeight:window.innerWidth;if(_>Qa&&Math.abs(p)<se*.4){const de=Q?1:-1;if(de>0&&E&&n){D(f[n.length-1]);return}if($&&de<0&&le&&H(),k===null)return;D(f[k+de]);return}D(Z)}function R({draggedDistance:p}){if(T===null)return;const H=d==="bottom"||d==="right"?T-p:T+p;(d==="bottom"||d==="right")&&H<f[f.length-1]||(d==="top"||d==="left")&&H>f[f.length-1]||Ie(s.current,{transform:ze(d)?`translate3d(0, ${H}px, 0)`:`translate3d(${H}px, 0, 0)`})}function M(p,H){if(!n||typeof k!="number"||!f||r===void 0)return null;const _=k===r-1;if(k>=r&&H)return 0;if(_&&!H)return 1;if(!I&&!_)return null;const O=_?k+1:k-1,K=_?f[O]-f[O-1]:f[O+1]-f[O],$=p/Math.abs(K);return _?1-$:$}return{isLastSnapPoint:E,activeSnapPoint:b,shouldFade:I,getPercentageDragged:M,setActiveSnapPoint:x,activeSnapPointIndex:k,onRelease:P,onDrag:R,snapPointsOffset:f}}const fi=()=>()=>{};function pi(){const{direction:t,isOpen:a,shouldScaleBackground:n,setBackgroundColorOnScale:s,noBodyStyles:i}=Vt(),r=z.useRef(null),o=S.useMemo(()=>document.body.style.backgroundColor,[]);function d(){return(window.innerWidth-Tn)/window.innerWidth}z.useEffect(()=>{if(a&&n){r.current&&clearTimeout(r.current);const c=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!c)return;oi(s&&!i?xn(document.body,{background:"black"}):fi,xn(c,{transformOrigin:ze(t)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${ve.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ve.EASE.join(",")})`}));const v=xn(c,{borderRadius:`${es}px`,overflow:"hidden",...ze(t)?{transform:`scale(${d()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${d()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{v(),r.current=window.setTimeout(()=>{o?document.body.style.background=o:document.body.style.removeProperty("background")},ve.DURATION*1e3)}}},[a,n,o])}let $t=null;function hi({isOpen:t,modal:a,nested:n,hasBeenOpened:s,preventScrollRestoration:i,noBodyStyles:r}){const[o,d]=z.useState(()=>typeof window<"u"?window.location.href:""),c=z.useRef(0),v=z.useCallback(()=>{if(ca()&&$t===null&&t&&!r){$t={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:x,innerHeight:u}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-c.current}px`,left:`${-x}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const y=u-window.innerHeight;y&&c.current>=u&&(document.body.style.top=`${-(c.current+y)}px`)}),300)}},[t]),b=z.useCallback(()=>{if(ca()&&$t!==null&&!r){const x=-parseInt(document.body.style.top,10),u=-parseInt(document.body.style.left,10);Object.assign(document.body.style,$t),window.requestAnimationFrame(()=>{if(i&&o!==window.location.href){d(window.location.href);return}window.scrollTo(u,x)}),$t=null}},[o]);return z.useEffect(()=>{function x(){c.current=window.scrollY}return x(),window.addEventListener("scroll",x),()=>{window.removeEventListener("scroll",x)}},[]),z.useEffect(()=>{if(a)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||b()}},[a,b]),z.useEffect(()=>{n||!s||(t?(!window.matchMedia("(display-mode: standalone)").matches&&v(),a||window.setTimeout(()=>{b()},500)):b())},[t,s,o,a,n,v,b]),{restorePositionSetting:b}}function xi({open:t,onOpenChange:a,children:n,onDrag:s,onRelease:i,snapPoints:r,shouldScaleBackground:o=!1,setBackgroundColorOnScale:d=!0,closeThreshold:c=ci,scrollLockTimeout:v=di,dismissible:b=!0,handleOnly:x=!1,fadeFromIndex:u=r&&r.length-1,activeSnapPoint:y,setActiveSnapPoint:E,fixed:k,modal:I=!0,onClose:f,nested:T,noBodyStyles:D=!1,direction:P="bottom",defaultOpen:R=!1,disablePreventScroll:M=!0,snapToSequentialPoint:p=!1,preventScrollRestoration:H=!1,repositionInputs:_=!0,onAnimationEnd:le,container:O,autoFocus:K=!1}){var $,Q;const[Z=!1,se]=ns({defaultProp:R,prop:t,onChange:U=>{a==null||a(U),!U&&!T&&qe(),setTimeout(()=>{le==null||le(U)},ve.DURATION*1e3),U&&!I&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),U||(document.body.style.pointerEvents="auto")}}),[de,ue]=z.useState(!1),[ee,te]=z.useState(!1),[X,Me]=z.useState(!1),j=z.useRef(null),F=z.useRef(null),W=z.useRef(null),V=z.useRef(null),B=z.useRef(null),Y=z.useRef(!1),oe=z.useRef(null),J=z.useRef(0),me=z.useRef(!1),he=z.useRef(!R),ie=z.useRef(0),L=z.useRef(null),Le=z.useRef((($=L.current)==null?void 0:$.getBoundingClientRect().height)||0),$e=z.useRef(((Q=L.current)==null?void 0:Q.getBoundingClientRect().width)||0),Ce=z.useRef(0),Se=z.useCallback(U=>{r&&U===ye.length-1&&(F.current=new Date)},[]),{activeSnapPoint:Be,activeSnapPointIndex:Ue,setActiveSnapPoint:_e,onRelease:be,snapPointsOffset:ye,onDrag:zt,shouldFade:st,getPercentageDragged:Fe}=mi({snapPoints:r,activeSnapPointProp:y,setActiveSnapPointProp:E,drawerRef:L,fadeFromIndex:u,overlayRef:j,onSnapPointChange:Se,direction:P,container:O,snapToSequentialPoint:p});ti({isDisabled:!Z||ee||!I||X||!de||!_||!M});const{restorePositionSetting:qe}=hi({isOpen:Z,modal:I,nested:T??!1,hasBeenOpened:de,preventScrollRestoration:H,noBodyStyles:D});function nt(){return(window.innerWidth-Tn)/window.innerWidth}function pt(U){var h,N;!b&&!r||L.current&&!L.current.contains(U.target)||(Le.current=((h=L.current)==null?void 0:h.getBoundingClientRect().height)||0,$e.current=((N=L.current)==null?void 0:N.getBoundingClientRect().width)||0,te(!0),W.current=new Date,Ka()&&window.addEventListener("touchend",()=>Y.current=!1,{once:!0}),U.target.setPointerCapture(U.pointerId),J.current=ze(P)?U.pageY:U.pageX)}function ht(U,h){var N;let q=U;const ce=(N=window.getSelection())==null?void 0:N.toString(),pe=L.current?Qt(L.current,P):null,xe=new Date;if(q.tagName==="SELECT"||q.hasAttribute("data-vaul-no-drag")||q.closest("[data-vaul-no-drag]"))return!1;if(P==="right"||P==="left")return!0;if(F.current&&xe.getTime()-F.current.getTime()<500)return!1;if(pe!==null&&(P==="bottom"?pe>0:pe<0))return!0;if(ce&&ce.length>0)return!1;if(B.current&&xe.getTime()-B.current.getTime()<v&&pe===0||h)return B.current=xe,!1;for(;q;){if(q.scrollHeight>q.clientHeight){if(q.scrollTop!==0)return B.current=new Date,!1;if(q.getAttribute("role")==="dialog")return!0}q=q.parentNode}return!0}function xt(U){if(L.current&&ee){const h=P==="bottom"||P==="right"?1:-1,N=(J.current-(ze(P)?U.pageY:U.pageX))*h,q=N>0,ce=r&&!b&&!q;if(ce&&Ue===0)return;const pe=Math.abs(N),xe=document.querySelector("[data-vaul-drawer-wrapper]"),fe=P==="bottom"||P==="top"?Le.current:$e.current;let ge=pe/fe;const Xe=Fe(pe,q);if(Xe!==null&&(ge=Xe),ce&&ge>=1||!Y.current&&!ht(U.target,q))return;if(L.current.classList.add(gn),Y.current=!0,Ie(L.current,{transition:"none"}),Ie(j.current,{transition:"none"}),r&&zt({draggedDistance:N}),q&&!r){const Je=li(N),yt=Math.min(Je*-1,0)*h;Ie(L.current,{transform:ze(P)?`translate3d(0, ${yt}px, 0)`:`translate3d(${yt}px, 0, 0)`});return}const tt=1-ge;if((st||u&&Ue===u-1)&&(s==null||s(U,ge),Ie(j.current,{opacity:`${tt}`,transition:"none"},!0)),xe&&j.current&&o){const Je=Math.min(nt()+ge*(1-nt()),1),yt=8-ge*8,qt=Math.max(0,14-ge*14);Ie(xe,{borderRadius:`${yt}px`,transform:ze(P)?`scale(${Je}) translate3d(0, ${qt}px, 0)`:`scale(${Je}) translate3d(${qt}px, 0, 0)`,transition:"none"},!0)}if(!r){const Je=pe*h;Ie(L.current,{transform:ze(P)?`translate3d(0, ${Je}px, 0)`:`translate3d(${Je}px, 0, 0)`})}}}z.useEffect(()=>{window.requestAnimationFrame(()=>{he.current=!0})},[]),z.useEffect(()=>{var U;function h(){if(!L.current||!_)return;const N=document.activeElement;if(Sn(N)||me.current){var q;const ce=((q=window.visualViewport)==null?void 0:q.height)||0,pe=window.innerHeight;let xe=pe-ce;const fe=L.current.getBoundingClientRect().height||0,ge=fe>pe*.8;Ce.current||(Ce.current=fe);const Xe=L.current.getBoundingClientRect().top;if(Math.abs(ie.current-xe)>60&&(me.current=!me.current),r&&r.length>0&&ye&&Ue){const tt=ye[Ue]||0;xe+=tt}if(ie.current=xe,fe>ce||me.current){const tt=L.current.getBoundingClientRect().height;let Je=tt;tt>ce&&(Je=ce-(ge?Xe:Tn)),k?L.current.style.height=`${tt-Math.max(xe,0)}px`:L.current.style.height=`${Math.max(Je,ce-Xe)}px`}else Yr()||(L.current.style.height=`${Ce.current}px`);r&&r.length>0&&!me.current?L.current.style.bottom="0px":L.current.style.bottom=`${Math.max(xe,0)}px`}}return(U=window.visualViewport)==null||U.addEventListener("resize",h),()=>{var N;return(N=window.visualViewport)==null?void 0:N.removeEventListener("resize",h)}},[Ue,r,ye]);function et(U){gt(),f==null||f(),U||se(!1),setTimeout(()=>{r&&_e(r[0])},ve.DURATION*1e3)}function Ge(){if(!L.current)return;const U=document.querySelector("[data-vaul-drawer-wrapper]"),h=Qt(L.current,P);Ie(L.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${ve.DURATION}s cubic-bezier(${ve.EASE.join(",")})`}),Ie(j.current,{transition:`opacity ${ve.DURATION}s cubic-bezier(${ve.EASE.join(",")})`,opacity:"1"}),o&&h&&h>0&&Z&&Ie(U,{borderRadius:`${es}px`,overflow:"hidden",...ze(P)?{transform:`scale(${nt()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${nt()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${ve.DURATION}s`,transitionTimingFunction:`cubic-bezier(${ve.EASE.join(",")})`},!0)}function gt(){!ee||!L.current||(L.current.classList.remove(gn),Y.current=!1,te(!1),V.current=new Date)}function wt(U){if(!ee||!L.current)return;L.current.classList.remove(gn),Y.current=!1,te(!1),V.current=new Date;const h=Qt(L.current,P);if(!U||!ht(U.target,!1)||!h||Number.isNaN(h)||W.current===null)return;const N=V.current.getTime()-W.current.getTime(),q=J.current-(ze(P)?U.pageY:U.pageX),ce=Math.abs(q)/N;if(ce>.05&&(Me(!0),setTimeout(()=>{Me(!1)},200)),r){be({draggedDistance:q*(P==="bottom"||P==="right"?1:-1),closeDrawer:et,velocity:ce,dismissible:b}),i==null||i(U,!0);return}if(P==="bottom"||P==="right"?q>0:q<0){Ge(),i==null||i(U,!0);return}if(ce>Qa){et(),i==null||i(U,!1);return}var pe;const xe=Math.min((pe=L.current.getBoundingClientRect().height)!=null?pe:0,window.innerHeight);var fe;const ge=Math.min((fe=L.current.getBoundingClientRect().width)!=null?fe:0,window.innerWidth),Xe=P==="left"||P==="right";if(Math.abs(h)>=(Xe?ge:xe)*c){et(),i==null||i(U,!1);return}i==null||i(U,!0),Ge()}z.useEffect(()=>(Z&&(Ie(document.documentElement,{scrollBehavior:"auto"}),F.current=new Date),()=>{ii(document.documentElement,"scrollBehavior")}),[Z]);function vt(U){const h=U?(window.innerWidth-en)/window.innerWidth:1,N=U?-16:0;oe.current&&window.clearTimeout(oe.current),Ie(L.current,{transition:`transform ${ve.DURATION}s cubic-bezier(${ve.EASE.join(",")})`,transform:ze(P)?`scale(${h}) translate3d(0, ${N}px, 0)`:`scale(${h}) translate3d(${N}px, 0, 0)`}),!U&&L.current&&(oe.current=setTimeout(()=>{const q=Qt(L.current,P);Ie(L.current,{transition:"none",transform:ze(P)?`translate3d(0, ${q}px, 0)`:`translate3d(${q}px, 0, 0)`})},500))}function Pt(U,h){if(h<0)return;const N=(window.innerWidth-en)/window.innerWidth,q=N+h*(1-N),ce=-16+h*en;Ie(L.current,{transform:ze(P)?`scale(${q}) translate3d(0, ${ce}px, 0)`:`scale(${q}) translate3d(${ce}px, 0, 0)`,transition:"none"})}function bt(U,h){const N=ze(P)?window.innerHeight:window.innerWidth,q=h?(N-en)/N:1,ce=h?-16:0;h&&Ie(L.current,{transition:`transform ${ve.DURATION}s cubic-bezier(${ve.EASE.join(",")})`,transform:ze(P)?`scale(${q}) translate3d(0, ${ce}px, 0)`:`scale(${q}) translate3d(${ce}px, 0, 0)`})}return z.useEffect(()=>{I||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[I]),z.createElement(ks,{defaultOpen:R,onOpenChange:U=>{!b&&!U||(U?ue(!0):et(!0),se(U))},open:Z},z.createElement(Ya.Provider,{value:{activeSnapPoint:Be,snapPoints:r,setActiveSnapPoint:_e,drawerRef:L,overlayRef:j,onOpenChange:a,onPress:pt,onRelease:wt,onDrag:xt,dismissible:b,shouldAnimate:he,handleOnly:x,isOpen:Z,isDragging:ee,shouldFade:st,closeDrawer:et,onNestedDrag:Pt,onNestedOpenChange:vt,onNestedRelease:bt,keyboardIsOpen:me,modal:I,snapPointsOffset:ye,activeSnapPointIndex:Ue,direction:P,shouldScaleBackground:o,setBackgroundColorOnScale:d,noBodyStyles:D,container:O,autoFocus:K}},n))}const as=z.forwardRef(function({...t},a){const{overlayRef:n,snapPoints:s,onRelease:i,shouldFade:r,isOpen:o,modal:d,shouldAnimate:c}=Vt(),v=Ja(a,n),b=s&&s.length>0;if(!d)return null;const x=z.useCallback(u=>i(u),[i]);return z.createElement(zs,{onMouseUp:x,ref:v,"data-vaul-overlay":"","data-vaul-snap-points":o&&b?"true":"false","data-vaul-snap-points-overlay":o&&r?"true":"false","data-vaul-animate":c!=null&&c.current?"true":"false",...t})});as.displayName="Drawer.Overlay";const ss=z.forwardRef(function({onPointerDownOutside:t,style:a,onOpenAutoFocus:n,...s},i){const{drawerRef:r,onPress:o,onRelease:d,onDrag:c,keyboardIsOpen:v,snapPointsOffset:b,activeSnapPointIndex:x,modal:u,isOpen:y,direction:E,snapPoints:k,container:I,handleOnly:f,shouldAnimate:T,autoFocus:D}=Vt(),[P,R]=z.useState(!1),M=Ja(i,r),p=z.useRef(null),H=z.useRef(null),_=z.useRef(!1),le=k&&k.length>0;pi();const O=($,Q,Z=0)=>{if(_.current)return!0;const se=Math.abs($.y),de=Math.abs($.x),ue=de>se,ee=["bottom","right"].includes(Q)?1:-1;if(Q==="left"||Q==="right"){if(!($.x*ee<0)&&de>=0&&de<=Z)return ue}else if(!($.y*ee<0)&&se>=0&&se<=Z)return!ue;return _.current=!0,!0};z.useEffect(()=>{le&&window.requestAnimationFrame(()=>{R(!0)})},[]);function K($){p.current=null,_.current=!1,d($)}return z.createElement(Rs,{"data-vaul-drawer-direction":E,"data-vaul-drawer":"","data-vaul-delayed-snap-points":P?"true":"false","data-vaul-snap-points":y&&le?"true":"false","data-vaul-custom-container":I?"true":"false","data-vaul-animate":T!=null&&T.current?"true":"false",...s,ref:M,style:b&&b.length>0?{"--snap-point-height":`${b[x??0]}px`,...a}:a,onPointerDown:$=>{f||(s.onPointerDown==null||s.onPointerDown.call(s,$),p.current={x:$.pageX,y:$.pageY},o($))},onOpenAutoFocus:$=>{n==null||n($),D||$.preventDefault()},onPointerDownOutside:$=>{if(t==null||t($),!u||$.defaultPrevented){$.preventDefault();return}v.current&&(v.current=!1)},onFocusOutside:$=>{if(!u){$.preventDefault();return}},onPointerMove:$=>{if(H.current=$,f||(s.onPointerMove==null||s.onPointerMove.call(s,$),!p.current))return;const Q=$.pageY-p.current.y,Z=$.pageX-p.current.x,se=$.pointerType==="touch"?10:2;O({x:Z,y:Q},E,se)?c($):(Math.abs(Z)>se||Math.abs(Q)>se)&&(p.current=null)},onPointerUp:$=>{s.onPointerUp==null||s.onPointerUp.call(s,$),p.current=null,_.current=!1,d($)},onPointerOut:$=>{s.onPointerOut==null||s.onPointerOut.call(s,$),K(H.current)},onContextMenu:$=>{s.onContextMenu==null||s.onContextMenu.call(s,$),H.current&&K(H.current)}})});ss.displayName="Drawer.Content";const gi=250,wi=120,vi=z.forwardRef(function({preventCycle:t=!1,children:a,...n},s){const{closeDrawer:i,isDragging:r,snapPoints:o,activeSnapPoint:d,setActiveSnapPoint:c,dismissible:v,handleOnly:b,isOpen:x,onPress:u,onDrag:y}=Vt(),E=z.useRef(null),k=z.useRef(!1);function I(){if(k.current){D();return}window.setTimeout(()=>{f()},wi)}function f(){if(r||t||k.current){D();return}if(D(),!o||o.length===0){v||i();return}if(d===o[o.length-1]&&v){i();return}const R=o.findIndex(p=>p===d);if(R===-1)return;const M=o[R+1];c(M)}function T(){E.current=window.setTimeout(()=>{k.current=!0},gi)}function D(){E.current&&window.clearTimeout(E.current),k.current=!1}return z.createElement("div",{onClick:I,onPointerCancel:D,onPointerDown:P=>{b&&u(P),T()},onPointerMove:P=>{b&&y(P)},ref:s,"data-vaul-drawer-visible":x?"true":"false","data-vaul-handle":"","aria-hidden":"true",...n},z.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},a))});vi.displayName="Drawer.Handle";function bi(t){const a=Vt(),{container:n=a.container,...s}=t;return z.createElement(As,{container:n,...s})}const Wt={Root:xi,Content:ss,Overlay:as,Portal:bi,Title:Es};function yi({...t}){return e.jsx(Wt.Root,{"data-slot":"drawer",...t})}function ji({...t}){return e.jsx(Wt.Portal,{"data-slot":"drawer-portal",...t})}function Ni({className:t,...a}){return e.jsx(Wt.Overlay,{"data-slot":"drawer-overlay",className:je("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",t),...a})}function Ci({className:t,children:a,...n}){return e.jsxs(ji,{"data-slot":"drawer-portal",children:[e.jsx(Ni,{}),e.jsxs(Wt.Content,{"data-slot":"drawer-content",className:je("group/drawer-content bg-background fixed z-50 flex h-auto flex-col","data-[vaul-drawer-direction=top]:inset-x-0 data-[vaul-drawer-direction=top]:top-0 data-[vaul-drawer-direction=top]:mb-24 data-[vaul-drawer-direction=top]:max-h-[80vh] data-[vaul-drawer-direction=top]:rounded-b-lg","data-[vaul-drawer-direction=bottom]:inset-x-0 data-[vaul-drawer-direction=bottom]:bottom-0 data-[vaul-drawer-direction=bottom]:mt-24 data-[vaul-drawer-direction=bottom]:max-h-[80vh] data-[vaul-drawer-direction=bottom]:rounded-t-lg","data-[vaul-drawer-direction=right]:inset-y-0 data-[vaul-drawer-direction=right]:right-0 data-[vaul-drawer-direction=right]:w-3/4 data-[vaul-drawer-direction=right]:sm:max-w-sm","data-[vaul-drawer-direction=left]:inset-y-0 data-[vaul-drawer-direction=left]:left-0 data-[vaul-drawer-direction=left]:w-3/4 data-[vaul-drawer-direction=left]:sm:max-w-sm",t),...n,children:[e.jsx("div",{className:"bg-muted mx-auto mt-4 hidden h-2 w-[100px] shrink-0 rounded-full group-data-[vaul-drawer-direction=bottom]/drawer-content:block"}),a]})]})}function Si({className:t,...a}){return e.jsx("div",{"data-slot":"drawer-header",className:je("flex flex-col gap-1.5 p-4",t),...a})}function Ti({className:t,...a}){return e.jsx(Wt.Title,{"data-slot":"drawer-title",className:je("text-foreground font-semibold",t),...a})}const Ei=({show:t,history:a,collections:n=[],selectedCollectionId:s="",onSelectCollection:i,onClear:r,onUseAgain:o,onRemoveEntry:d,hideCollectionSelector:c=!1})=>{const[v,b]=z.useState(null),[x,u]=z.useState(!1),[y,E]=z.useState("input"),k=Array.isArray(a)?a.filter(T=>T.collectionId===s):[],I=Array.isArray(n)?n.find(T=>T.id===s):void 0,f=k.find(T=>T.id===v)||null;return z.useEffect(()=>{b(null),u(!1)},[s,a]),S.useEffect(()=>{if(!x)return;const T=D=>{if(D.ctrlKey&&(D.key==="c"||D.key==="C")){D.preventDefault();const P=y==="input"?(f==null?void 0:f.inputText)||"":(f==null?void 0:f.translatedText)||"";P&&(navigator.clipboard.writeText(P),re.success(`Copied ${y==="input"?"input text":"translated text"}`))}else D.ctrlKey&&(D.key==="v"||D.key==="V")?(D.preventDefault(),f&&o(f)):D.key==="Backspace"&&(D.preventDefault(),f&&(u(!1),d(f.id)))};return window.addEventListener("keydown",T),()=>window.removeEventListener("keydown",T)},[x,y,f,o,d]),t?e.jsxs("div",{className:je("h-full w-full flex flex-col"),children:[e.jsx("div",{className:"my-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Na,{className:"h-5 w-5 mr-2 text-primary"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xl font-bold",children:"Translation History"}),e.jsx("span",{className:"block text-sm mt-1 text-muted-foreground",children:"Previously translated content, organized by collection"})]})]}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{variant:"destructive",size:"sm",onClick:r,disabled:(k==null?void 0:k.length)===0,className:"h-8 text-xs",children:[e.jsx(dt,{className:"h-3.5 w-3.5 mr-1.5"}),"Clear All"]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Delete all translation history in this collection"})})]})})]})}),e.jsx("div",{className:"px-2 pb-0 flex-1 min-h-0",children:e.jsxs(Wr,{direction:"horizontal",className:"h-[500px] w-full",children:[!c&&e.jsxs(e.Fragment,{children:[e.jsx(oa,{defaultSize:25,minSize:20,maxSize:40,className:"border-r border-border/40",children:e.jsx("div",{className:"h-full flex flex-col",children:e.jsx(Ot,{className:"flex-1 px-2 pb-2",children:e.jsx("div",{className:"flex flex-col gap-1",children:(n==null?void 0:n.length)===0?e.jsx("div",{className:"text-xs text-muted-foreground px-2 py-4 text-center",children:"No collections"}):n.map(T=>e.jsxs("div",{className:je("flex items-center gap-2 px-2 py-2 rounded-lg cursor-pointer transition-all",T.id===s?"bg-primary/10 text-primary font-semibold":"hover:bg-muted/60 text-gray-700 dark:text-gray-200"),onClick:()=>i(T.id),children:[e.jsx(yn,{className:"h-4 w-4 mr-1 text-primary/70"}),e.jsx("span",{className:"truncate text-sm",children:T.name})]},T.id))})})})}),e.jsx(qr,{withHandle:!0})]}),e.jsx(oa,{defaultSize:c?100:75,minSize:c?0:40,children:e.jsxs("div",{className:"h-full flex flex-col px-4",children:[e.jsxs("div",{className:" pt-4 pb-2 font-semibold text-base flex items-center gap-2",children:[e.jsx(Us,{className:"h-4 w-4 text-primary/70"}),I?I.name:"No Collection Selected"]}),e.jsxs("div",{className:"flex-1 px-0 pb-4",children:[(k==null?void 0:k.length)===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(Ms,{className:"h-12 w-12 text-muted-foreground/30 mb-3"}),e.jsx("p",{className:"text-muted-foreground font-medium",children:"No translation history yet"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 max-w-md",children:"Translations will be saved here automatically as you use the translator"})]}):e.jsx(Ot,{className:"h-[400px] pr-2",children:e.jsx("div",{className:"space-y-2",children:k.map(T=>e.jsx(Rt,{className:je("transition-all cursor-pointer border-2",v===T.id&&x?"border-primary bg-primary/5":"border-transparent hover:border-border"),onClick:()=>{b(T.id),E("input"),u(!0)},children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2 px-4 py-3",children:[e.jsxs("div",{className:"flex flex-col gap-1 flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(kn,{className:"h-3.5 w-3.5"}),new Date(T.timestamp).toLocaleString(),e.jsx(Ze,{variant:"outline",className:"ml-2 text-xs px-1.5 py-0 h-5",children:T.model})]}),e.jsxs("div",{className:"flex flex-col md:flex-row md:gap-4 mt-1",children:[e.jsx("span",{className:"truncate text-sm font-medium text-primary/90 max-w-[180px] md:max-w-[220px]",title:T.inputText,children:T.inputText}),e.jsx("span",{className:"hidden md:inline text-muted-foreground",children:"â†’"}),e.jsx("span",{className:"truncate text-sm text-muted-foreground max-w-[180px] md:max-w-[220px]",title:T.translatedText,children:T.translatedText})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(Pe,{children:[e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{variant:"outline",size:"sm",onClick:D=>{D.stopPropagation(),o(T)},className:"h-8",children:[e.jsx(jn,{className:"h-3.5 w-3.5 mr-1.5"}),"Reuse"]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Load this translation again"})})]}),e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{variant:"ghost",size:"icon",onClick:D=>{D.stopPropagation(),d(T.id)},className:"h-8 w-8 text-destructive",children:e.jsx(dt,{className:"h-4 w-4"})})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Delete this entry"})})]})]})})]})},T.id))})}),e.jsx(yi,{open:x,onOpenChange:u,children:e.jsxs(Ci,{className:"w-screen h-screen max-w-none max-h-none flex flex-col",children:[e.jsx(Si,{children:e.jsx(Ti,{children:"Translation Details"})}),e.jsx("div",{className:"flex-1 px-4 pb-32 overflow-y-auto",children:e.jsxs(Ss,{value:y,onValueChange:T=>E(T),className:"w-full",children:[e.jsxs(Ts,{className:"mb-4 w-full",children:[e.jsx(Yn,{value:"input",className:"flex-1",children:"Input Text"}),e.jsx(Yn,{value:"translated",className:"flex-1",children:"Translated Text"})]}),e.jsxs(Kn,{value:"input",children:[e.jsxs(Gn,{className:"text-xs flex items-center text-muted-foreground mb-1",children:[e.jsx(bn,{className:"h-3 w-3 mr-1"}),"Input Text"]}),e.jsx(Bt,{value:(f==null?void 0:f.inputText)||"",readOnly:!0,className:"text-sm bg-muted/20 rounded-md p-3 min-h-[120px] max-h-[300px] border border-border/40 resize-none"})]}),e.jsxs(Kn,{value:"translated",children:[e.jsxs(Gn,{className:"text-xs flex items-center text-muted-foreground mb-1",children:[e.jsx(bn,{className:"h-3 w-3 mr-1"}),"Translated Text"]}),e.jsx(Bt,{value:(f==null?void 0:f.translatedText)||"",readOnly:!0,className:"text-sm bg-muted/20 rounded-md p-3 min-h-[120px] max-h-[300px] border border-border/40 resize-none"})]})]})}),e.jsxs("div",{className:"fixed bottom-0 left-0 w-full flex flex-col items-center bg-background/95 py-6 z-50 border-t gap-4",children:[e.jsxs(G,{variant:"outline",size:"lg",className:"w-full max-w-md mx-auto text-base",onClick:async()=>{const T=y==="input"?(f==null?void 0:f.inputText)||"":(f==null?void 0:f.translatedText)||"";T&&(await navigator.clipboard.writeText(T),re.success(`Copied ${y==="input"?"input text":"translated text"}`))},children:[e.jsx(wa,{className:"h-5 w-5 mr-2"}),"Copy ",e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"Ctrl+C"})]}),f&&e.jsxs(G,{variant:"default",size:"lg",className:"w-full max-w-md mx-auto text-base",onClick:()=>o(f),children:[e.jsx(jn,{className:"h-5 w-5 mr-2"}),"Reuse ",e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"Ctrl+V"})]}),f&&e.jsxs(G,{variant:"destructive",size:"lg",className:"w-full max-w-md mx-auto text-base",onClick:()=>{u(!1),d(f.id)},children:[e.jsx(dt,{className:"h-5 w-5 mr-2"}),"Delete ",e.jsx("span",{className:"ml-2 text-xs text-muted-foreground",children:"Backspace"})]})]})]})})]})]})})]})})]}):null},ki=({mappingTable:t,collectionId:a,updateMappingEntry:n,removeMappingEntry:s,addMappingEntry:i,showImportArea:r,toggleImportArea:o,mappingMarkdown:d,setMappingMarkdown:c,revertImport:v,showRevertButton:b,exportMarkdownTable:x,importMarkdownTable:u,error:y})=>{const[E,k]=S.useState(!1),[I,f]=S.useState(!1),[T,D]=S.useState(!1),[P,R]=S.useState(!1),[M,p]=S.useState(!1),[H,_]=S.useState(!1),[le,O]=S.useState(null),K=async()=>{k(!0),await i(a),k(!1)},$=async()=>{f(!0),await o(),f(!1)},Q=async()=>{D(!0),c(`| Term / Name | Transcription | Type (Person/Place/Other) | Gender (if person) | Notes |
|:----------- |:------------- |:------------------------- |:------------------ |:------ |
| äº‹æƒ…æ˜¯è¿™æ ·çš„ | Chuyá»‡n lÃ  tháº¿ nÃ y | Phrase | | Opening phrase |
| æœ€è¿‘ | Gáº§n Ä‘Ã¢y | Time | | |
| å¸ˆå…„ | SÆ° huynh | Title/Relationship | Male | Elder martial brother |
| å…¶å®ž | Thá»±c ra | Adverb | | |`),r||await o(),D(!1)},Z=async()=>{R(!0),await x(),R(!1)},se=async()=>{p(!0),await u(),p(!1)},de=async()=>{_(!0),await v(),_(!1)},ue=async ee=>{O(ee),await s(a,ee),O(null)};return e.jsxs("div",{children:[e.jsx("div",{className:"pb-3",children:e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl flex items-center font-semibold",children:[e.jsx(or,{className:"h-5 w-5 mr-2 text-primary"}),"Mapping Table"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage term mappings and transcriptions"})]}),e.jsxs(Ze,{variant:"outline",className:"h-6",children:[t==null?void 0:t.length," ",(t==null?void 0:t.length)===1?"Entry":"Entries"]})]})}),e.jsx("div",{className:"p-4 pb-0",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-2 sm:gap-4",children:[e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{onClick:K,variant:"default",className:"text-sm h-9 px-4 w-full md:w-auto",disabled:E,children:[E?e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(An,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"md:inline",children:"Add New Term"})]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Add a new term mapping entry"})})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{variant:r?"destructive":"outline",onClick:$,size:"sm",className:"h-9",disabled:I,children:[I?e.jsx(Oe,{className:"h-4 w-4 md:mr-2 animate-spin"}):r?e.jsx(an,{className:"h-4 w-4 md:mr-2"}):e.jsx(ja,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:r?"Close Import/Export":"Import/Export"})]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Import or export mapping data as markdown"})})]})}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{variant:"outline",onClick:Q,size:"sm",className:"h-9",disabled:T,children:[T?e.jsx(Oe,{className:"h-4 w-4 md:mr-2 animate-spin"}):e.jsx(Ca,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Show Example"})]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Load a sample mapping table"})})]})})]})]}),e.jsx("div",{className:je("overflow-hidden transition-all duration-300 ease-in-out",r?"h-[320px] opacity-100":"h-0 opacity-0"),children:e.jsxs("div",{className:"border border-dashed rounded-md",children:[e.jsx("div",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("h3",{className:"text-base font-medium",children:"Import/Export Markdown"}),e.jsxs("div",{className:"flex flex-row flex-wrap gap-2 mt-1 sm:mt-0 w-full sm:w-auto",children:[b&&e.jsxs(G,{variant:"destructive",size:"sm",onClick:de,className:"text-xs h-8",title:"Revert to previous state (available for 1 minute)",disabled:H,children:[H?e.jsx(Oe,{className:"h-3.5 w-3.5 mr-1.5 animate-spin"}):e.jsx(Rn,{className:"h-3.5 w-3.5 mr-1.5"}),"Undo Import"]}),e.jsxs(G,{variant:"outline",size:"sm",onClick:Z,title:"Update markdown from current table",className:"text-xs h-8",disabled:P,children:[P?e.jsx(Oe,{className:"h-3.5 w-3.5 mr-1.5 animate-spin"}):e.jsx(va,{className:"h-3.5 w-3.5 mr-1.5"}),"Update"]}),e.jsxs(G,{variant:"outline",size:"sm",onClick:se,className:"text-xs h-8",disabled:M,children:[M?e.jsx(Oe,{className:"h-3.5 w-3.5 mr-1.5 animate-spin"}):e.jsx(ha,{className:"h-3.5 w-3.5 mr-1.5"}),"Import"]})]})]})}),e.jsxs("div",{className:"py-2 px-4",children:[e.jsx(Bt,{placeholder:"Paste markdown table here...",className:"h-40 w-full text-sm font-mono",value:d,onChange:ee=>c(ee.target.value)}),y&&y.includes("import")&&e.jsxs("div",{className:"flex items-start mt-2 p-2 rounded-md bg-destructive/10 text-destructive text-sm",children:[e.jsx(En,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:y})]})]})]})}),e.jsx("div",{className:"rounded-md border",children:e.jsx("div",{className:"overflow-x-auto max-h-[500px]",children:e.jsxs("table",{className:"w-full border-collapse min-w-max",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-background",children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Term / Name"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Transcription"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Type"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Gender"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Notes"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap w-[100px]",children:"Actions"})]})}),e.jsx("tbody",{children:(t==null?void 0:t.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center h-24 text-muted-foreground",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(Gs,{className:"h-8 w-8 mb-2 text-muted-foreground/40"}),e.jsx("p",{children:"No terms added yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Add a new entry to begin"})]})})}):t.map((ee,te)=>e.jsxs("tr",{className:"border-b hover:bg-muted/20 transition-colors",children:[e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.term,onChange:X=>n(a,te,"term",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Term or name"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.transcription,onChange:X=>n(a,te,"transcription",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Transcription"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.type,onChange:X=>n(a,te,"type",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Type"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.gender,onChange:X=>n(a,te,"gender",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Gender"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.notes,onChange:X=>n(a,te,"notes",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Additional notes"})}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{variant:"destructive",size:"sm",onClick:()=>ue(te),className:"w-full h-8",disabled:le===te,children:[le===te?e.jsx(Oe,{className:"h-3.5 w-3.5 sm:mr-1.5 animate-spin"}):e.jsx(dt,{className:"h-3.5 w-3.5 sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline text-xs",children:"Remove"})]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Delete this mapping entry"})})]})})})]},te))})]})})})]})})]})},Ri=({relationshipsTable:t,collectionId:a,updateRelationshipEntry:n,removeRelationshipEntry:s,addRelationshipEntry:i,showImportArea:r,toggleImportArea:o,relationshipsMarkdown:d,setRelationshipsMarkdown:c,revertImport:v,showRevertButton:b,exportMarkdownTable:x,importMarkdownTable:u,error:y})=>{const[E,k]=S.useState(!1),[I,f]=S.useState(!1),[T,D]=S.useState(!1),[P,R]=S.useState(!1),[M,p]=S.useState(!1),[H,_]=S.useState(!1),[le,O]=S.useState(null),K=async()=>{k(!0),await i(a),k(!1)},$=async()=>{f(!0),await o(),f(!1)},Q=async()=>{D(!0),c(`| Character A | Character B | Relationship | Address Terms (Aâ†’B) | Address Terms (Bâ†’A) | Notes |
|:----------- |:----------- |:------------ |:------------------- |:------------------- |:----- |
| VÆ°u ThiÃªn Thu | Triá»‡u KhÃ´ng Minh | Adoptive Younger Sister -> Elder Brother | Huynh trÆ°á»Ÿng, SÆ° huynh | NgÆ°Æ¡i | Formal/Respectful |
| LÃ¢m Linh Dao | VÆ°u ThiÃªn Thu | Female Lead 2 -> Female Lead 1 | Dao tá»· tá»·, Muá»™i | ThiÃªn Thu | Relationship strained |`),r||await o(),D(!1)},Z=async()=>{R(!0),await x(),R(!1)},se=async()=>{p(!0),await u(),p(!1)},de=async()=>{_(!0),await v(),_(!1)},ue=async ee=>{O(ee),await s(a,ee),O(null)};return e.jsxs("div",{children:[e.jsx("div",{className:"pb-3",children:e.jsxs("div",{className:"flex flex-row justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl flex items-center font-semibold",children:[e.jsx(Xn,{className:"h-5 w-5 mr-2 text-primary"}),"Relationships Table"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage character relationships and address terms"})]}),e.jsxs(Ze,{variant:"outline",className:"h-6",children:[t==null?void 0:t.length," ",(t==null?void 0:t.length)===1?"Entry":"Entries"]})]})}),e.jsx("div",{className:"p-4 pb-0",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-2 sm:gap-4",children:[e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{onClick:K,variant:"default",className:"text-sm h-9 px-4 w-full md:w-auto",disabled:E,children:[E?e.jsx(Oe,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(An,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"md:inline",children:"Add New Relationship"})]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Add a new character relationship entry"})})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{variant:r?"destructive":"outline",onClick:$,size:"sm",className:"h-9",disabled:I,children:[I?e.jsx(Oe,{className:"h-4 w-4 md:mr-2 animate-spin"}):r?e.jsx(an,{className:"h-4 w-4 md:mr-2"}):e.jsx(ja,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:r?"Close Import/Export":"Import/Export"})]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Import or export relationship data as markdown"})})]})}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{variant:"outline",onClick:Q,size:"sm",className:"h-9",disabled:T,children:[T?e.jsx(Oe,{className:"h-4 w-4 md:mr-2 animate-spin"}):e.jsx(Ca,{className:"h-4 w-4 md:mr-2"}),e.jsx("span",{className:"hidden md:inline",children:"Show Example"})]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Load a sample relationship table"})})]})})]})]}),e.jsx("div",{className:je("overflow-hidden transition-all duration-300 ease-in-out",r?"h-[320px] opacity-100":"h-0 opacity-0"),children:e.jsxs("div",{className:"border border-dashed rounded-md",children:[e.jsx("div",{className:"py-3 px-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("h3",{className:"text-base font-medium",children:"Import/Export Markdown"}),e.jsxs("div",{className:"flex flex-row flex-wrap gap-2 mt-1 sm:mt-0 w-full sm:w-auto",children:[b&&e.jsxs(G,{variant:"destructive",size:"sm",onClick:de,className:"text-xs h-8",title:"Revert to previous state (available for 1 minute)",disabled:H,children:[H?e.jsx(Oe,{className:"h-3.5 w-3.5 mr-1.5 animate-spin"}):e.jsx(Rn,{className:"h-3.5 w-3.5 mr-1.5"}),"Undo Import"]}),e.jsxs(G,{variant:"outline",size:"sm",onClick:Z,title:"Update markdown from current table",className:"text-xs h-8",disabled:P,children:[P?e.jsx(Oe,{className:"h-3.5 w-3.5 mr-1.5 animate-spin"}):e.jsx(va,{className:"h-3.5 w-3.5 mr-1.5"}),"Update"]}),e.jsxs(G,{variant:"outline",size:"sm",onClick:se,className:"text-xs h-8",disabled:M,children:[M?e.jsx(Oe,{className:"h-3.5 w-3.5 mr-1.5 animate-spin"}):e.jsx(ha,{className:"h-3.5 w-3.5 mr-1.5"}),"Import"]})]})]})}),e.jsxs("div",{className:"py-2 px-4",children:[e.jsx(Bt,{placeholder:"Paste markdown table here...",className:"h-40 w-full text-sm font-mono",value:d,onChange:ee=>c(ee.target.value)}),y&&y.includes("import")&&e.jsxs("div",{className:"flex items-start mt-2 p-2 rounded-md bg-destructive/10 text-destructive text-sm",children:[e.jsx(En,{className:"h-4 w-4 mr-2 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:y})]})]})]})}),e.jsx("div",{className:"rounded-md border",children:e.jsx("div",{className:"overflow-x-auto max-h-[500px]",children:e.jsxs("table",{className:"w-full border-collapse min-w-max",children:[e.jsx("thead",{className:"sticky top-0 z-10 bg-background",children:e.jsxs("tr",{className:"border-b bg-muted/50",children:[e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Character A"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Character B"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Relationship"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Address (Aâ†’B)"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Address (Bâ†’A)"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap",children:"Notes"}),e.jsx("th",{className:"text-left py-2 px-3 text-sm font-medium whitespace-nowrap w-[100px]",children:"Actions"})]})}),e.jsx("tbody",{children:(t==null?void 0:t.length)===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center h-24 text-muted-foreground",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx(Xn,{className:"h-8 w-8 mb-2 text-muted-foreground/40"}),e.jsx("p",{children:"No relationships added yet"}),e.jsx("p",{className:"text-xs mt-1",children:"Add a new entry to begin"})]})})}):t.map((ee,te)=>e.jsxs("tr",{className:"border-b hover:bg-muted/20 transition-colors",children:[e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.characterA,onChange:X=>n(a,te,"characterA",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Character name"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.characterB,onChange:X=>n(a,te,"characterB",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Character name"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.relationship,onChange:X=>n(a,te,"relationship",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Relationship type"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.addressTermsAToB,onChange:X=>n(a,te,"addressTermsAToB",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"How A addresses B"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.addressTermsBToA,onChange:X=>n(a,te,"addressTermsBToA",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"How B addresses A"})}),e.jsx("td",{className:"py-2 px-2",children:e.jsx(Ke,{value:ee.notes,onChange:X=>n(a,te,"notes",X.target.value),className:"w-full text-sm px-3 py-1 h-8",placeholder:"Additional notes"})}),e.jsx("td",{className:"py-2 px-2 text-center",children:e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs(G,{variant:"destructive",size:"sm",onClick:()=>ue(te),className:"w-full h-8",disabled:le===te,children:[le===te?e.jsx(Oe,{className:"h-3.5 w-3.5 sm:mr-1.5 animate-spin"}):e.jsx(dt,{className:"h-3.5 w-3.5 sm:mr-1.5"}),e.jsx("span",{className:"hidden sm:inline text-xs",children:"Remove"})]})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Delete this relationship entry"})})]})})})]},te))})]})})})]})})]})},Ai=({isVisible:t,settingsPanelRef:a,collections:n,collectionToEdit:s,setCollectionToEdit:i,editedCollectionName:r,setEditedCollectionName:o,addNewCollection:d,useCollection:c,renameCollection:v,requestDeleteCollection:b,showDeleteConfirmation:x,setShowDeleteConfirmation:u,confirmDeleteCollection:y,selectedCollectionId:E,error:k,setError:I,arcrylicBg:f,translationHistory:T,onClearHistory:D,onUseHistoryEntry:P,onRemoveHistoryEntry:R,updateMappingEntry:M,removeMappingEntry:p,addMappingEntry:H,showMappingImportArea:_,toggleMappingImportArea:le,mappingMarkdown:O,setMappingMarkdown:K,revertMappingImport:$,showMappingRevertButton:Q,exportMappingMarkdown:Z,importMappingMarkdown:se,updateRelationshipEntry:de,removeRelationshipEntry:ue,addRelationshipEntry:ee,showRelationshipImportArea:te,toggleRelationshipImportArea:X,relationshipsMarkdown:Me,setRelationshipsMarkdown:j,revertRelationshipImport:F,showRelationshipRevertButton:W,exportRelationshipMarkdown:V,importRelationshipMarkdown:B,onApproveUpdate:Y,onRejectUpdate:oe})=>{const J=n.find(h=>h.id===s),[me,he]=S.useState(!1),[ie,L]=S.useState(""),Le=S.useRef(null),[$e,Ce]=S.useState(null),[Se,Be]=S.useState(""),Ue=S.useRef(null),[_e,be]=S.useState(null),[ye,zt]=S.useState("history"),[,st]=S.useState(!1),Fe=S.useRef(null),qe=["history","mapping","relationships","updates"],nt=S.useRef([]),[pt,ht]=S.useState({left:0,width:0}),xt=S.useCallback((h,N)=>{i(h),o(N),I(null)},[i,o,I]),et=S.useCallback((h,N,q)=>{h.preventDefault(),i(N),o(q),Ce(N),Be(q)},[i,o,Ce,Be]),Ge=S.useRef({}),gt=S.useCallback((h,N)=>{Ge.current[N.id]=setTimeout(()=>{et(h,N.id,N.name),Ge.current[N.id]=null},500)},[et]),wt=S.useCallback((h,N)=>{Ge.current[N.id]&&(clearTimeout(Ge.current[N.id]),Ge.current[N.id]=null,xt(N.id,N.name))},[xt]),vt=S.useCallback((h,N)=>{Ge.current[N.id]&&(clearTimeout(Ge.current[N.id]),Ge.current[N.id]=null)},[]);S.useEffect(()=>{const h=qe.indexOf(ye),N=nt.current[h];N&&ht({left:N.offsetLeft,width:N.offsetWidth})},[ye]),S.useEffect(()=>()=>{Fe.current&&clearTimeout(Fe.current)},[]);const Pt=h=>{if(h===ye)return;Fe.current&&(clearTimeout(Fe.current),Fe.current=null);const N=qe.indexOf(ye),q=qe.indexOf(h);if(N===-1||q===-1)return;const ce=N<q?1:-1;st(!0);let pe=N;const xe=()=>{pe+=ce,zt(qe[pe]),ce>0&&pe<q||ce<0&&pe>q?Fe.current=setTimeout(xe,150):(st(!1),Fe.current=null)};Fe.current=setTimeout(xe,150)};z.useEffect(()=>{me&&Le.current&&Le.current.focus()},[me]),z.useEffect(()=>{$e&&Ue.current&&Ue.current.focus()},[$e]);const bt=()=>{ie.trim()?(d(ie.trim()),L(""),he(!1)):(he(!1),L(""))},U=()=>{$e&&Se.trim()&&(o(Se),i($e),v()),Ce(null)};return e.jsx("div",{ref:a,className:je("overflow-hidden transition-all duration-300 ease-in-out",t?"h-auto min-h-[700px] sm:h-[800px] opacity-100 mb-4 pb-4 border-b border-gray-200 dark:border-gray-700":"h-0 opacity-0 mb-0 pb-0 border-b-0"),style:{display:t?"block":"none"},tabIndex:-1,children:e.jsxs(Rt,{className:je("h-full min-h-[600px] w-full bg-white/90 dark:bg-zinc-900/90 shadow-xl rounded-2xl p-0 flex flex-col sm:flex-row border border-gray-100 dark:border-zinc-800 transition-all duration-300",f&&"backdrop-blur-md"),children:[e.jsxs("aside",{className:"w-full sm:w-1/3 bg-muted/40 dark:bg-muted/20 p-2 sm:p-4 flex flex-col gap-2 border-b sm:border-b-0 sm:border-r border-gray-200 dark:border-gray-800 min-h-[120px] h-[25vh] sm:h-auto max-h-[180px] sm:max-h-none overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(yn,{className:"h-5 w-5 text-primary"}),"Collections"]}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{size:"icon",variant:"outline",onClick:()=>{he(!0),L("")},"aria-label":"Add new collection",children:e.jsx(An,{className:"h-5 w-5"})})}),e.jsx(Ae,{children:"Add new collection"})]})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-1",children:[me&&e.jsx("div",{className:"flex items-center gap-2 px-2 py-2 mb-1 rounded-lg bg-muted/30 dark:bg-muted/10",children:e.jsx(Ke,{ref:Le,value:ie,onChange:h=>L(h.target.value),onBlur:bt,onKeyDown:h=>{h.key==="Enter"?bt():h.key==="Escape"&&(he(!1),L(""))},placeholder:"Collection name",className:"flex-1 h-8 text-sm"})}),n.map(h=>e.jsxs("div",{className:je("flex items-center gap-2 px-2 py-2 rounded-lg cursor-pointer group transition-all",h.id===s?"bg-primary/10 dark:bg-primary/20 text-primary":"hover:bg-muted/60 dark:hover:bg-muted/30 text-gray-700 dark:text-gray-200"),onMouseDown:N=>gt(N,h),onMouseUp:N=>wt(N,h),onMouseLeave:N=>vt(N,h),onTouchStart:N=>gt(N,h),onTouchEnd:N=>wt(N,h),onTouchCancel:N=>vt(N,h),style:{touchAction:"manipulation"},children:[e.jsx(yn,{className:"h-4 w-4 mr-1 text-primary/70"}),$e===h.id?e.jsx(Ke,{ref:Ue,value:r,onChange:N=>o(N.target.value),onBlur:U,onKeyDown:N=>{N.key==="Enter"?U():N.key==="Escape"&&Ce(null)},onClick:N=>N.stopPropagation(),className:"flex-1 h-8 text-sm",autoFocus:!0}):e.jsxs("div",{className:"flex flex-1 items-center min-w-0",children:[e.jsx("span",{className:"flex-1 truncate font-medium text-sm sm:text-base",children:h.name}),e.jsx(er,{className:"h-4 w-4 ml-2 opacity-0 group-hover:opacity-100 text-gray-500 hover:text-primary transition-opacity cursor-pointer",onClick:N=>{N.stopPropagation(),i(h.id),o(h.name),Ce(h.id),Be(h.name)}})]}),h.id===E?e.jsx(Lt,{className:"h-4 w-4 text-green-500 ml-1"}):e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{size:"icon",variant:"ghost",onClick:N=>{N.stopPropagation(),c(h.id)},className:"h-6 w-6 opacity-0 group-hover:opacity-100","aria-label":"Use this collection",children:e.jsx(Lt,{className:"h-4 w-4 text-green-500"})})}),e.jsx(Ae,{children:"Use this collection"})]})}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{size:"icon",variant:"ghost",onClick:N=>{N.stopPropagation(),b(h.id)},className:"h-6 w-6 opacity-0 group-hover:opacity-100 text-red-500","aria-label":"Delete collection",children:e.jsx(dt,{className:"h-4 w-4"})})}),e.jsx(Ae,{children:"Delete collection"})]})}),h.id===s&&$e!==h.id&&e.jsx("span",{className:"ml-2 text-xs font-semibold",children:"Editing"})]},h.id))]})]}),e.jsx("section",{className:"flex-1 min-w-0 p-2 sm:p-6 flex flex-col h-[75vh] sm:h-auto min-h-[400px] overflow-hidden",children:e.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"relative flex border-b mb-4 overflow-x-auto",children:[qe.map((h,N)=>e.jsxs("button",{ref:q=>{nt.current[N]=q},className:je("px-3 sm:px-4 py-2 text-sm font-medium transition-colors relative flex items-center justify-center",h===ye?"text-primary":"text-muted-foreground hover:text-foreground"),onClick:()=>{Pt(h)},children:[e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsxs("span",{className:"sm:hidden",children:[h==="history"&&e.jsx(Na,{className:"h-4 w-4"}),h==="mapping"&&e.jsx(ir,{className:"h-4 w-4"}),h==="relationships"&&e.jsx(Zs,{className:"h-4 w-4"}),h==="updates"&&e.jsx(sr,{className:"h-4 w-4"})]})}),e.jsx(Ae,{side:"bottom",className:"sm:hidden",children:h.charAt(0).toUpperCase()+h.slice(1)})]})}),e.jsx("span",{className:"hidden sm:block",children:h.charAt(0).toUpperCase()+h.slice(1)})]},h)),e.jsx("div",{className:"absolute bottom-0 h-[2px] bg-primary",style:{left:`${pt.left}px`,width:`${pt.width}px`,transform:"translateY(0)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"}})]}),e.jsxs("div",{className:"relative flex-1 h-full",children:[ye==="history"&&e.jsx("div",{className:"h-full pb-[80px] sm:pb-0 overflow-y-auto",children:J&&e.jsx(Ei,{show:!0,history:T.filter(h=>h.collectionId===J.id),collections:n,selectedCollectionId:J.id,onSelectCollection:i,onClear:D,onUseAgain:P,arcrylicBg:f,onRemoveEntry:R,hideCollectionSelector:!0})}),e.jsx("div",{className:je("transition-all duration-300",ye==="mapping"?"visible h-auto opacity-100":"invisible h-0 opacity-0"),children:e.jsx(ki,{mappingTable:(J==null?void 0:J.mappingTable)||[],collectionId:s,updateMappingEntry:M,removeMappingEntry:p,addMappingEntry:H,showImportArea:_,toggleImportArea:le,mappingMarkdown:O,setMappingMarkdown:K,revertImport:$,showRevertButton:Q,exportMarkdownTable:Z,importMarkdownTable:se,error:k,arcrylicBg:f})}),e.jsx("div",{className:je("transition-all duration-300",ye==="relationships"?"visible h-auto opacity-100":"invisible h-0 opacity-0"),children:e.jsx(Ri,{relationshipsTable:(J==null?void 0:J.relationshipsTable)||[],collectionId:s,updateRelationshipEntry:de,removeRelationshipEntry:ue,addRelationshipEntry:ee,showImportArea:te,toggleImportArea:X,relationshipsMarkdown:Me,setRelationshipsMarkdown:j,revertImport:F,showRevertButton:W,exportMarkdownTable:V,importMarkdownTable:B,error:k,arcrylicBg:f})}),ye==="updates"&&e.jsx("div",{className:"h-full pb-[80px] sm:pb-0 overflow-y-auto",children:J!=null&&J.tableUpdateHistory?J.tableUpdateHistory.length>0?e.jsx("div",{className:"space-y-3",children:[...J.tableUpdateHistory].sort((h,N)=>N.timestamp-h.timestamp).map(h=>{var q,ce,pe,xe;const N=_e===h.id;return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-muted/30 p-3 flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:h.type==="mapping"?"Mapping Table":"Relationships Table"}),e.jsx(Ze,{variant:h.status==="pending"?"outline":h.status==="approved"?"secondary":"destructive",className:je("ml-2 text-xs px-1.5",h.status==="pending"&&"bg-amber-100 text-amber-700 hover:bg-amber-100 dark:bg-amber-900/30 dark:text-amber-400 dark:hover:bg-amber-900/30",h.status==="approved"&&"bg-emerald-100 text-emerald-700 hover:bg-emerald-100 dark:bg-emerald-900/30 dark:text-emerald-400 dark:hover:bg-emerald-900/30",h.status==="rejected"&&"bg-red-100 hover:bg-red-100 dark:bg-red-900/30 dark:hover:bg-red-900/30"),children:h.status})]}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[e.jsx(kn,{className:"h-3 w-3 mr-1"}),new Date(h.timestamp).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full",onClick:()=>be(N?null:h.id),children:N?e.jsx(xa,{className:"h-4 w-4"}):e.jsx(ga,{className:"h-4 w-4"})}),h.status==="pending"&&e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{variant:"outline",size:"sm",className:"h-8",onClick:()=>be(N?null:h.id),children:"Review"})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Review and approve/reject changes"})})]})}),(h.status==="approved"||h.status==="rejected")&&e.jsx(G,{variant:"outline",size:"sm",className:"h-8",onClick:fe=>{var ge,Xe;fe.stopPropagation(),!(h.status==="rejected"&&!window.confirm("This update was previously rejected. Do you want to reapply it?"))&&(Y(h),re.success(`${h.type==="mapping"?"Mapping":"Relationships"} table update reapplied`,{description:`${((ge=h.updates.added)==null?void 0:ge.length)||0} new entries and ${((Xe=h.updates.updated)==null?void 0:Xe.length)||0} updated entries`}))},children:"Reapply"})]})]}),N&&e.jsxs("div",{className:"p-3 space-y-3 bg-background",children:[((q=h.updates.added)==null?void 0:q.length)>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs font-medium flex items-center",children:[e.jsx(ya,{className:"h-3.5 w-3.5 mr-1 text-emerald-500"}),"Added Entries"]}),e.jsx(Ze,{variant:"outline",className:"text-xs px-1.5 h-5",children:(ce=h.updates.added)==null?void 0:ce.length})]}),e.jsx("div",{className:"bg-muted/30 rounded-md p-2.5",children:h.updates.added.map((fe,ge)=>e.jsx("div",{className:"text-xs py-1.5 px-2 rounded mb-1 hover:bg-accent/50 transition-colors",children:h.type==="mapping"?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:fe.term}),e.jsxs("span",{className:"text-muted-foreground",children:["â†’ ",fe.transcription]})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:fe.characterA}),e.jsxs("span",{className:"text-muted-foreground",children:["â†’ ",fe.characterB]})]})},ge))})]}),((pe=h.updates.updated)==null?void 0:pe.length)>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs font-medium flex items-center",children:[e.jsx(ba,{className:"h-3.5 w-3.5 mr-1 text-blue-500"}),"Updated Entries"]}),e.jsx(Ze,{variant:"outline",className:"text-xs px-1.5 h-5",children:(xe=h.updates.updated)==null?void 0:xe.length})]}),e.jsx("div",{className:"bg-muted/30 rounded-md p-2.5",children:h.updates.updated.map((fe,ge)=>e.jsx("div",{className:"text-xs py-1.5 px-2 rounded mb-1 hover:bg-accent/50 transition-colors",children:h.type==="mapping"?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:fe.term}),e.jsxs("span",{className:"text-muted-foreground",children:["â†’ ",fe.transcription]})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:fe.characterA}),e.jsxs("span",{className:"text-muted-foreground",children:["â†’ ",fe.characterB]})]})},ge))})]}),h.status==="pending"&&e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx(G,{variant:"outline",onClick:()=>be(null),children:"Cancel"}),e.jsx(G,{variant:"destructive",onClick:()=>{oe(h),be(null)},children:"Reject"}),e.jsx(G,{variant:"default",onClick:()=>{var fe,ge;Y(h),re.success(`${h.type==="mapping"?"Mapping":"Relationships"} table update approved`,{description:`${((fe=h.updates.added)==null?void 0:fe.length)||0} new entries and ${((ge=h.updates.updated)==null?void 0:ge.length)||0} updated entries`}),be(null)},children:"Approve"})]})]})]},h.id)})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center",children:[e.jsx(Lt,{className:"h-8 w-8 text-muted-foreground/40 mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No updates available"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Updates will appear here when available"})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center",children:[e.jsx(Lt,{className:"h-8 w-8 text-muted-foreground/40 mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No updates available"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Updates will appear here when available"})]})})]})]})}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 px-2",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-2xl p-4 sm:p-8 max-w-xs sm:max-w-md w-full mx-2 shadow-2xl border border-gray-200 dark:border-zinc-800 animate-fadeIn",children:[e.jsxs("h3",{className:"text-xl sm:text-2xl font-bold mb-3 text-gray-900 dark:text-white flex items-center gap-2",children:[e.jsx(dt,{className:"h-6 w-6 text-destructive"})," Confirm Deletion"]}),e.jsx("p",{className:"mb-2 text-gray-700 dark:text-gray-300 text-sm sm:text-base",children:"Are you sure you want to delete this collection?"}),e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground mb-6",children:"This action cannot be undone."}),e.jsxs("div",{className:"flex justify-end gap-3 flex-col sm:flex-row",children:[e.jsx(G,{variant:"outline",onClick:()=>u(!1),className:"min-w-[90px]",children:"Cancel"}),e.jsx(G,{variant:"destructive",onClick:y,className:"min-w-[90px]",children:"Delete"})]})]})})]})})},zi=({showTableUpdates:t,isTableUpdatesAnimating:a,pendingTableUpdates:n,expandedEntries:s,toggleEntryExpansion:i,setShowTableUpdates:r,handleUpdateConfirmation:o,showUpdateConfirmation:d})=>t?e.jsxs(Rt,{className:je("fixed bottom-20 right-6 w-96 max-w-[calc(100vw-3rem)] z-[9998] shadow-lg transition-all duration-300 ease-in-out rounded-xl border-border/40",a?"translate-y-4 opacity-0":"translate-y-0 opacity-100"),children:[e.jsxs(wn,{className:"p-4 pb-2 flex flex-row items-center justify-between space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vn,{className:"text-base font-medium",children:"Table Updates"}),e.jsx(Ze,{variant:"outline",className:"ml-2 text-xs",children:n==null?void 0:n.length})]}),e.jsx(G,{variant:"ghost",size:"icon",onClick:()=>r(!1),className:"h-8 w-8 rounded-full",children:e.jsx(an,{className:"h-4 w-4"})})]}),e.jsx(ys,{className:"p-3",children:e.jsx(Ot,{className:"max-h-[60vh] pr-2 overflow-y-auto",children:e.jsx("div",{className:"space-y-3",children:(n==null?void 0:n.length)>0?n.map(c=>{var v,b,x,u;return e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-muted/30 p-3 flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:c.type==="mapping"?"Mapping Table":"Relationships Table"}),e.jsx(Ze,{variant:c.status==="pending"?"outline":c.status==="approved"?"secondary":"destructive",className:"ml-2 text-xs px-1.5",children:c.status})]}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground mt-1",children:[e.jsx(kn,{className:"h-3 w-3 mr-1"}),new Date(c.timestamp).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 rounded-full",onClick:()=>i(c.id),children:s.has(c.id)?e.jsx(xa,{className:"h-4 w-4"}):e.jsx(ga,{className:"h-4 w-4"})}),e.jsx(Pe,{children:e.jsxs(ke,{children:[e.jsx(Re,{asChild:!0,children:e.jsx(G,{variant:"outline",size:"sm",className:"h-8",onClick:()=>d(c),children:"Review"})}),e.jsx(Ae,{children:e.jsx("p",{className:"text-xs",children:"Review and approve/reject changes"})})]})})]})]}),s.has(c.id)&&e.jsxs("div",{className:"p-3 space-y-3 bg-background",children:[((v=c.updates.added)==null?void 0:v.length)>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs font-medium flex items-center",children:[e.jsx(ya,{className:"h-3.5 w-3.5 mr-1 text-emerald-500"}),"Added Entries"]}),e.jsx(Ze,{variant:"outline",className:"text-xs px-1.5 h-5",children:(b=c.updates.added)==null?void 0:b.length})]}),e.jsx(Ot,{className:"h-[120px]",children:e.jsx("div",{className:"bg-muted/30 rounded-md p-2.5",children:c.updates.added.map((y,E)=>e.jsx("div",{className:"text-xs py-1.5 px-2 rounded mb-1 hover:bg-accent/50 transition-colors",children:c.type==="mapping"?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:y.term}),e.jsxs("span",{className:"text-muted-foreground",children:["â†’ ",y.transcription]})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:y.characterA}),e.jsxs("span",{className:"text-muted-foreground",children:["â†’ ",y.characterB]})]})},E))})})]}),((x=c.updates.updated)==null?void 0:x.length)>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs font-medium flex items-center",children:[e.jsx(ba,{className:"h-3.5 w-3.5 mr-1 text-blue-500"}),"Updated Entries"]}),e.jsx(Ze,{variant:"outline",className:"text-xs px-1.5 h-5",children:(u=c.updates.updated)==null?void 0:u.length})]}),e.jsx(Ot,{className:"h-[120px]",children:e.jsx("div",{className:"bg-muted/30 rounded-md p-2.5",children:c.updates.updated.map((y,E)=>e.jsx("div",{className:"text-xs py-1.5 px-2 rounded mb-1 hover:bg-accent/50 transition-colors",children:c.type==="mapping"?e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:y.term}),e.jsxs("span",{className:"text-muted-foreground",children:["â†’ ",y.transcription]})]}):e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:y.characterA}),e.jsxs("span",{className:"text-muted-foreground",children:["â†’ ",y.characterB]})]})},E))})})]}),e.jsxs("div",{className:"flex justify-end gap-2 mt-3",children:[e.jsx(G,{variant:"outline",size:"sm",className:"h-7 text-xs",onClick:()=>o(c,!1),children:"Reject"}),e.jsx(G,{variant:"default",size:"sm",className:"h-7 text-xs",onClick:()=>o(c,!0),children:"Approve"})]})]})]},c.id)}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center",children:[e.jsx(Hs,{className:"h-8 w-8 text-muted-foreground/40 mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No pending updates"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Updates will appear here when available"})]})})})})]}):null,Pi=t=>!t||typeof t!="object"?(console.warn("Invalid mapping entry:",t),null):{term:String(t.term||""),transcription:String(t.transcription||""),type:String(t.type||""),gender:String(t.gender||""),notes:String(t.notes||"")},Mi=t=>!t||typeof t!="object"?(console.warn("Invalid relationship entry:",t),null):{characterA:String(t.characterA||""),characterB:String(t.characterB||""),relationship:String(t.relationship||""),addressTermsAToB:String(t.addressTermsAToB||""),addressTermsBToA:String(t.addressTermsBToA||""),notes:String(t.notes||"")},fa=(t,a,n,s)=>{if(!Array.isArray(a))return console.error("Invalid entries format:",a),{newTable:t,updatedCount:0,added:[],updated:[]};const i=[...t];let r=0;const o=[],d=[];return a.forEach(c=>{const v=n(c);if(v){const b=s(i,v);b>=0?(i[b]=v,d.push(v)):(i.push(v),o.push(v)),r++}}),{newTable:i,updatedCount:r,added:o,updated:d}},Yi=()=>{const t=bs(),[a,n]=S.useState(""),[s,i]=S.useState(""),[r,o]=S.useState(!1),[d,c]=S.useState(null),[v,b]=S.useState(!1),[x,u]=S.useState([]),[,y]=S.useState(!1),[,E]=S.useState(!0),[k,I]=S.useState("gemini-2.0-flash-exp"),f=["gemini-2.0-flash-exp","gemini-2.0-flash-exp-image-generation","gemini-2.0-flash-thinking-exp-01-21","gemini-2.5-pro-exp-03-25"],T={"gemini-2.0-flash-exp":"Recommended","gemini-2.0-flash-exp-image-generation":"Image Generation","gemini-2.0-flash-thinking-exp-01-21":"No support for function calling","gemini-2.5-pro-exp-03-25":"Pro but Stupid (Super slow)"},[D,P]=S.useState(null),[R,M]=S.useState([]),[p,H]=S.useState(""),[_,le]=S.useState(!1),[O,K]=S.useState(""),[$,Q]=S.useState(""),[Z,se]=S.useState(""),[de,ue]=S.useState(!1),[ee]=S.useState("mapping"),[te,X]=S.useState([]),[Me,j]=S.useState([]),[F,W]=S.useState(""),[V,B]=S.useState(""),[Y,oe]=S.useState(!1),[J,me]=S.useState([]),[he,ie]=S.useState([]),[L,Le]=S.useState(!1),[$e,Ce]=S.useState(!1),[Se,Be]=S.useState([]),[Ue,_e]=S.useState(!1),[be,ye]=S.useState(null),[zt,st]=S.useState(!1),Fe=z.useRef(null),qe=S.useRef(null),[nt,pt]=S.useState(new Set),ht=l=>{pt(g=>{const m=new Set(g);return m.has(l)?m.delete(l):m.add(l),m})},xt=()=>{n("")},et=()=>{n(""),i(""),c(null),re.info("Text cleared")},Ge=()=>{navigator.clipboard.writeText(s),b(!0),re.success("Copied to clipboard"),setTimeout(()=>b(!1),2e3)},gt=l=>{c(l)},wt=l=>{ye(l),_e(!!l)},vt=l=>{const g=!_;if(le(g),g){const m=R.find(w=>w.id===l);m&&(K(l),Q(m.name))}},Pt=()=>{if(!O||!$.trim())return;const l=R.map(g=>g.id===O?{...g,name:$.trim()}:g);M(l),Ee("translationCollections",l),re.success(`Collection renamed to "${$}"`)},bt=l=>{console.log("Delete confirmation requested for collection:",l),se(l),setTimeout(()=>{ue(!0),console.log("showDeleteConfirmation set to true")},0)},U=l=>{cn(l)},h=async()=>{if(!a.trim()){re.error("Please enter text to translate"),c("Please enter text to translate");return}dn(),o(!0),c(null),re.promise(async()=>{try{const l=jt(te,!0),g=jt(Me,!1),m=await Ns(a,l,g,D||"default-key",k,{onMappingTableUpdate:w=>{console.log("Received entries mapping table:",w);try{const{updatedCount:C,added:A,updated:ae}=fa(te,w,Pi,(we,De)=>we.findIndex(it=>it.term===De.term));C>0&&_n("mapping",A,ae)}catch(C){console.error("Error updating mapping table:",C),re.error("Failed to update mapping table")}},onRelationshipsTableUpdate:w=>{console.log("Received entries relationships table:",w);try{const{updatedCount:C,added:A,updated:ae}=fa(Me,w,Mi,(we,De)=>we.findIndex(it=>it.characterA===De.characterA&&it.characterB===De.characterB));C>0&&_n("relationships",A,ae)}catch(C){console.error("Error updating relationships table:",C),re.error("Failed to update relationships table")}}});if(m.hasError)throw c(m.thinking||"Translation failed. Please try again."),new Error(m.thinking||"Translation failed");{const w=m.ocrText||"";return i(w),await q(w),w}}catch(l){throw console.error("Translation error:",l),c("An error occurred during translation. Please try again."),l}finally{o(!1)}},{loading:"Translating text...",success:"Translation completed successfully",error:l=>`Translation failed: ${l instanceof Error?l.message:"Unknown error"}`})},N=async()=>{u([]),await Ee("translationHistory",[]),re.success("Translation history cleared")},q=async l=>{const g=R.find(C=>C.id===p);if(!g)return;const w=[{id:Date.now().toString(),timestamp:Date.now(),inputText:a,translatedText:l,model:k,collectionId:p,collectionName:g.name},...x].slice(0,50);u(w),await Ee("translationHistory",w)},ce=l=>{n(l.inputText),i(""),I(l.model),cn(l.collectionId),y(!1),re.info("Previous translation loaded")},pe=async l=>{const g=x.filter(m=>m.id!==l);u(g),await Ee("translationHistory",g)},xe=async(l,g,m,w)=>{if(!l)return;const C=R.map(A=>{if(A.id===l){const ae=A.mappingTable.map((we,De)=>De===g?{...we,[m]:w}:we);return{...A,mappingTable:ae}}return A});M(C),await Ee("translationCollections",C),p===l&&X(C.find(A=>A.id===l).mappingTable)},fe=async(l,g)=>{if(!l)return;const m=R.map(w=>{if(w.id===l){const C=w.mappingTable.filter((A,ae)=>ae!==g);return{...w,mappingTable:C}}return w});M(m),await Ee("translationCollections",m),p===l&&X(m.find(w=>w.id===l).mappingTable)},ge=async(l,g=[])=>{if(!l)return;const m=g.length>0?g:[{term:"",transcription:"",type:"",gender:"",notes:""}],w=R.map(C=>C.id===l?{...C,mappingTable:[...C.mappingTable,...m]}:C);M(w),await Ee("translationCollections",w),p===l&&X(w.find(C=>C.id===l).mappingTable)},Xe=async(l,g,m,w)=>{if(!l)return;const C=R.map(A=>{if(A.id===l){const ae=A.relationshipsTable.map((we,De)=>De===g?{...we,[m]:w}:we);return{...A,relationshipsTable:ae}}return A});M(C),await Ee("translationCollections",C),p===l&&j(C.find(A=>A.id===l).relationshipsTable)},tt=async(l,g)=>{if(!l)return;const m=R.map(w=>{if(w.id===l){const C=w.relationshipsTable.filter((A,ae)=>ae!==g);return{...w,relationshipsTable:C}}return w});M(m),await Ee("translationCollections",m),p===l&&j(m.find(w=>w.id===l).relationshipsTable)},Je=async(l,g=[])=>{if(!l)return;const m=g.length>0?g:[{characterA:"",characterB:"",relationship:"",addressTermsAToB:"",addressTermsBToA:"",notes:""}],w=R.map(C=>C.id===l?{...C,relationshipsTable:[...C.relationshipsTable,...m]}:C);M(w),await Ee("translationCollections",w),p===l&&j(w.find(C=>C.id===l).relationshipsTable)},yt=async l=>{try{if(l.type==="mapping"){const g=[...te];l.updates.added.forEach(m=>g.push(m)),l.updates.updated.forEach(m=>{const w=g.findIndex(C=>C.term===m.term);w>=0&&(g[w]=m)}),X(g),await Mt(!0,g,p)}else{const g=[...Me];l.updates.added.forEach(m=>g.push(m)),l.updates.updated.forEach(m=>{const w=g.findIndex(C=>C.characterA===m.characterA&&C.characterB===m.characterB);w>=0&&(g[w]=m)}),j(g),await Mt(!1,g,p)}if(l.status==="rejected"){const g=R.map(m=>{var w;if(m.id===p){const C=((w=m.tableUpdateHistory)==null?void 0:w.map(A=>A.id===l.id?{...A,status:"approved"}:A))||[];return{...m,tableUpdateHistory:C}}return m});M(g),await Ee("translationCollections",g)}}catch(g){console.error("Error reapplying update:",g),re.error("Failed to reapply update")}},qt=()=>{if(console.log("Scrolling to top attempt"),Fe.current){Fe.current.scrollIntoView({behavior:"smooth"}),console.log("Used scrollIntoView");return}try{window.scroll({top:0,left:0,behavior:"smooth"}),console.log("Used window.scroll")}catch{window.scrollTo(0,0),console.log("Used fallback scrollTo")}},rs=async l=>{I(l),await Ee("translateModel",l)};S.useEffect(()=>{(async()=>{var g;try{const m=await Kt("apiKey"),w=await Kt("translateModel"),C=await Kt("translationCollections"),A=await Kt("translationHistory");if(m&&P(m),w&&I(w),A&&u(A),C&&(C==null?void 0:C.length)>0){M(C),H(C[0].id),X(C[0].mappingTable),j(C[0].relationshipsTable);const ae=((g=C[0].tableUpdateHistory)==null?void 0:g.filter(we=>we.status==="pending"))||[];Be(ae),ae.length>0&&Ce(!0)}else{const ae={id:Date.now().toString(),name:"Default Collection",mappingTable:[],relationshipsTable:[],tableUpdateHistory:[]};M([ae]),H(ae.id)}}catch(m){console.error("Error loading settings:",m)}})()},[]),S.useEffect(()=>{p&&!O&&K(p)},[p,O]),S.useEffect(()=>{const l=()=>{window.scrollY>200?E(!0):E(!1)};return window.addEventListener("scroll",l),()=>window.removeEventListener("scroll",l)},[]),S.useEffect(()=>{_&&qe.current&&setTimeout(()=>{var l;if((l=qe.current)==null||l.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),qe.current){const m=qe.current.getBoundingClientRect().top+window.pageYOffset+-50;window.scrollTo({top:m,behavior:"smooth"})}},250)},[_]),S.useEffect(()=>{if(O){const l=R.find(g=>g.id===O);l&&Q(l.name)}},[O,R]);const is=(l,g)=>{try{const m=l.trim().split(`
`);if((m==null?void 0:m.length)<3)return[];const w=m.slice(2);return g?w.map(C=>{const A=C.split("|").filter((ae,we,De)=>we!==0&&we!==(De==null?void 0:De.length)-1||ae.trim()!=="").map(ae=>ae.trim());if((A==null?void 0:A.length)<5)for(console.warn("Row has fewer than expected columns:",C);(A==null?void 0:A.length)<5;)A.push("");return{term:A[0]||"",transcription:A[1]||"",type:A[2]||"",gender:A[3]||"",notes:A[4]||""}}):w.map(C=>{const A=C.split("|").filter((ae,we,De)=>we!==0&&we!==(De==null?void 0:De.length)-1||ae.trim()!=="").map(ae=>ae.trim());if((A==null?void 0:A.length)<6)for(console.warn("Row has fewer than expected columns:",C);(A==null?void 0:A.length)<6;)A.push("");return{characterA:A[0]||"",characterB:A[1]||"",relationship:A[2]||"",addressTermsAToB:A[3]||"",addressTermsBToA:A[4]||"",notes:A[5]||""}})}catch(m){return console.error("Error parsing markdown table:",m),[]}},jt=(l,g)=>{if((l==null?void 0:l.length)===0)return"";let m="";return g?(m=`| Term / Name | Transcription | Type (Person/Place/Other) | Gender (if person) | Notes |
`,m+=`|:----------- |:------------- |:------------------------- |:------------------ |:------ |
`,l.forEach(w=>{m+=`| ${w.term} | ${w.transcription} | ${w.type} | ${w.gender} | ${w.notes} |
`})):(m=`| Character A | Character B | Relationship | Address Terms (Aâ†’B) | Address Terms (Bâ†’A) | Notes |
`,m+=`|:----------- |:----------- |:------------ |:------------------- |:------------------- |:----- |
`,l.forEach(w=>{m+=`| ${w.characterA} | ${w.characterB} | ${w.relationship} | ${w.addressTermsAToB} | ${w.addressTermsBToA} | ${w.notes} |
`})),m},$n=(l,g)=>{try{if(!l.trim()){re.error("Please enter a markdown table to import"),c("Please enter a markdown table to import");return}if(!l.includes("|")){re.error("Invalid table format. Table must contain pipe characters (|)"),c("Import failed: Invalid table format. Table must contain pipe characters (|)");return}const m=l.trim().split(`
`);if((m==null?void 0:m.length)<3){re.error("Table must contain at least 3 lines (header, separator, and data row)"),c("Import failed: Table must contain at least 3 lines (header, separator, and data row)");return}const w=m[1];if(!w.includes("|")||!w.includes("-")){re.error("Second line must be a separator with pipes (|) and dashes (-)"),c("Import failed: Second line must be a separator with pipes (|) and dashes (-)");return}const C=is(l,g);if((C==null?void 0:C.length)===0){re.error("No valid data rows found in the table"),c("Import failed: No valid data rows found in the table");return}if(c(null),O){if(g){const ae=R.find(we=>we.id===O);ae&&me(ae.mappingTable)}else{const ae=R.find(we=>we.id===O);ae&&ie(ae.relationshipsTable)}const A=R.map(ae=>ae.id===O?{...ae,mappingTable:g?C:ae.mappingTable,relationshipsTable:g?ae.relationshipsTable:C}:ae);M(A),Ee("translationCollections",A),p===O&&(g?X(C):j(C))}else g?(me(te),X(C)):(ie(Me),j(C)),Mt(g,C,p);Le(!0),setTimeout(()=>{Le(!1)},6e4),re.success(`${g?"Mapping":"Relationships"} table imported successfully`)}catch(m){console.error("Error importing markdown table:",m),re.error(`Import failed: ${m instanceof Error?m.message:"Unknown error"}`),c(`Import failed: ${m instanceof Error?m.message:"Unknown error"}`)}},Ln=l=>{if(O){const g=R.map(m=>m.id===O?{...m,mappingTable:l?J:m.mappingTable,relationshipsTable:l?m.relationshipsTable:he}:m);M(g),Ee("translationCollections",g),p===O&&(l?X(J):j(he))}else l?(X(J),Mt(!0,J,p),me([])):(j(he),Mt(!1,he,p),ie([]));l?me([]):ie([]),Le(!1),re.success(`${l?"Mapping":"Relationships"} table reverted to previous state`)},Mt=async(l,g,m=p)=>{if(!m)return;const w=R.map(C=>C.id===m?{...C,mappingTable:l?g:C.mappingTable,relationshipsTable:l?C.relationshipsTable:g}:C);M(w),await Ee("translationCollections",w)},Gt=l=>{if(O){const m=R.find(w=>w.id===O);if(m){const w=jt(l?m.mappingTable:m.relationshipsTable,l);l?W(w):B(w);return}}const g=jt(l?te:Me,l);l?W(g):B(g)},cn=l=>{var m;if(l===p)return;dn();const g=R.find(w=>w.id===l);if(g){H(l),X(g.mappingTable),j(g.relationshipsTable);const w=((m=g.tableUpdateHistory)==null?void 0:m.filter(C=>C.status==="pending"))||[];Be(w),Ce(w.length>0)}},dn=(l=p)=>{if(!l)return;const g=R.map(m=>m.id===l?{...m,mappingTable:te,relationshipsTable:Me}:m);M(g),Ee("translationCollections",g)},ls=l=>{if(!l.trim()){re.error("Please enter a name for the new collection"),c("Please enter a name for the new collection");return}dn();const g={id:Date.now().toString(),name:l,mappingTable:[],relationshipsTable:[],tableUpdateHistory:[]},m=[...R,g];M(m),H(g.id),X([]),j([]),Ee("translationCollections",m),re.success(`Collection "${l}" created`)},os=l=>{if((R==null?void 0:R.length)<=1){re.error("You must have at least one collection"),c("You must have at least one collection");return}const g=R.find(w=>w.id===l);if(!g)return;const m=R.filter(w=>w.id!==l);if(l===p&&(m==null?void 0:m.length)>0){const w=m[0];H(w.id),X(w.mappingTable),j(w.relationshipsTable)}M(m),Ee("translationCollections",m).then(()=>{re.success(`Collection "${g.name}" deleted`)}).catch(w=>{console.error("Failed to save collections after deletion:",w),re.error("Failed to delete collection")}),l===O&&(K(""),Q(""))},Hn=()=>{oe(!Y),Y||Gt(ee==="mapping")},_n=(l,g,m)=>{console.log("handleTableUpdate called with type:",l,"added:",g,"updated:",m);const w={id:crypto.randomUUID(),timestamp:Date.now(),type:l,updates:{added:g,updated:m},status:"pending"};Be(A=>[...A,w]),Ce(!0),st(!0),setTimeout(()=>st(!1),300);const C=R.map(A=>A.id===p?(A.tableUpdateHistory.push(w),{...A,tableUpdateHistory:A.tableUpdateHistory}):A);M(C),Ee("translationCollections",C).catch(A=>{console.error("Error saving pending update to database:",A),re.error("Failed to save pending update to database")}),re.info("New table update available for review",{description:`${g==null?void 0:g.length} new entries and ${m==null?void 0:m.length} updated entries`,action:{label:"Review",onClick:()=>Ce(!0)}})},un=async(l,g)=>{if(!p){console.error("handleUpdateConfirmation error: No collection selected."),re.error("Error: No collection selected to apply updates.");return}const m=R.findIndex(Te=>Te.id===p);if(m===-1){console.error(`handleUpdateConfirmation error: Collection with ID ${p} not found.`),re.error("Error: Selected collection could not be found."),_e(!1),ye(null);return}const w=R[m];let C=w.mappingTable||[],A=w.relationshipsTable||[];if(g)if(l.type==="mapping"){let Te=[...C];l.updates.added.forEach(He=>Te.push(He)),l.updates.updated.forEach(He=>{const lt=Te.findIndex(Yt=>Yt.term===He.term);lt>=0?Te[lt]=He:console.warn(`Mapping term "${He.term}" marked for update not found in current table.`)}),C=Te}else{let Te=[...A];l.updates.added.forEach(He=>Te.push(He)),l.updates.updated.forEach(He=>{const lt=Te.findIndex(Yt=>Yt.characterA===He.characterA&&Yt.characterB===He.characterB);lt>=0?Te[lt]=He:console.warn(`Relationship between "${He.characterA}" and "${He.characterB}" marked for update not found.`)}),A=Te}const ae={...l,status:g?"approved":"rejected"},we=(w.tableUpdateHistory||[]).map(Te=>Te.id===l.id?ae:Te),De={...w,tableUpdateHistory:we,mappingTable:g&&l.type==="mapping"?C:w.mappingTable,relationshipsTable:g&&l.type==="relationships"?A:w.relationshipsTable},it=R.map(Te=>Te.id===p?De:Te);try{M(it),await Ee("translationCollections",it),Be(Te=>{const He=Te.filter(lt=>lt.id!==l.id);return He.length===0&&Ce(!1),He}),_e(!1),ye(null),re.success(`Table update ${g?"approved":"rejected"} successfully.`)}catch(Te){console.error("Error saving update confirmation:",Te),re.error(`Failed to ${g?"approve":"reject"} update. Database save failed. Please try again.`)}};S.useEffect(()=>{if((R==null?void 0:R.length)===0){H(""),X([]),j([]);return}R.find(g=>g.id===p)||(H(R[0].id),X(R[0].mappingTable),j(R[0].relationshipsTable))},[R,p]);const cs=()=>{const l=jt(te,!0),g=jt(Me,!1);return`
# TRANSLATE: Original Language to Vietnamese with Professional Accuracy

Translate the original language text into Vietnamese with complete accuracy and cultural nuance by following these comprehensive guidelines:

---

### ðŸ”¹ DELIVER precise translations that:

- CAPTURE every single word, preserving the **exact meaning, tone, and nuance** of the original
- MAINTAIN **stylistic fidelity**, including:
  - Formality level (trang trá»ng, suá»“ng sÃ£, thÃ¢n máº­tâ€¦)
  - Emotional undertones
  - Cultural or historical references
- ENSURE **pronoun consistency** throughout (e.g. ta, ngÆ°Æ¡i, ngÆ°á»i, háº¯n, nÃ ng, muá»™i, chÃ ng) as appropriate to character and context
- RESPECT the original **sentence structure**, but rewrite for **natural Vietnamese flow** where necessary without losing meaning

---

### ðŸ”¹ ENSURE emotional and stylistic authenticity:

- MATCH the original **emotional intensity** â€” never exaggerate or understate the mood
- REPLICATE the tone precisely â€” formal stays formal, casual stays casual
- PRESERVE **character-specific speech styles**, such as unique patterns, dialects, or quirks

---

### ðŸ”¹ HANDLE names, terms, and references as follows:

- USE **Sino-Vietnamese phonetic transcription** for common historical/cultural nouns if appropriate
- RETAIN **established translations** for character and place names
- PREFER **English equivalents** for Western mythological or biblical references
- DO NOT localize or adapt terms unless required for clarity

---

### ðŸ”¹ MAINTAIN contextual and narrative integrity:

- TRANSLATE with attention to the **broader context** â€” ensure meaning carries across lines and paragraphs
- PRESERVE **subtext and implication**, without adding interpretation or explanation
- DO NOT omit, simplify, or condense the content â€” translate **everything** as faithfully as possible
- SPLIT long or complex Chinese sentences into manageable Vietnamese ones **without altering their meaning**

---

### ðŸ”¹ RELATIONSHIPS & ADDRESS TERMS:

- PRESERVE exact **modes of address** between characters:  
  (e.g. huynh â€“ muá»™i, ngÆ°Æ¡i â€“ ta, nÃ ng â€“ thiáº¿p, ca â€“ Ä‘á»‡â€¦)
- DISTINGUISH between:
  - **Dialogue speech**
  - **Narration by a character**
  - **Character's internal thoughts**
- ADAPT address and tone appropriately to **each narrative layer** (dialogue, monologue, narration)

---

### ðŸ”¹ QUALITY CONTROL CHECKLIST:

- âœ… No omissions â€“ every word is translated
- âœ… No stylistic deviation from original
- âœ… Emotional tone precisely mirrored
- âœ… Consistent vocabulary, names, and pronouns
- âœ… Cultural authenticity maintained

---

## Current Tables:

1. **TERM MAPPING TABLE**:
${l||"No mapping table provided."}

2. **RELATIONSHIPS & ADDRESS TERMS TABLE**:
${g||"No relationships table provided."}

TEXT TO TRANSLATE:
${a}

---

## ðŸ”¹ BEFORE TRANSLATION â€“ TRY TO DEFINE THE CONTEXT:

Before beginning the translation:

1. **CONTEXT AND REFERENCE INFORMATION**:  
   
   - Summary of the story or scene  
   - World background if relevant (historical, fantasy, modernâ€¦)

2. **ADDRESS RELATIONSHIPS**:  
   
   - Character names, their **genders**, and **relationships** with each other  
   - Specific **ways characters address each other** in:  
     - Dialogue  
     - Narration  
     - Inner thoughts

3. **STYLE & TONE OF NARRATOR**:  
   
   - E.g. omniscient formal narrator, or a character's personal internal monologue  

---

ðŸ”¹ AFTER TRANSLATION â€“ CALL FUNCTION TO UPDATE TABLES:
`},ds=()=>{const l=cs();navigator.clipboard.writeText(l),re.success("Full translation prompt copied to clipboard")},us=()=>{if(console.log("Confirming deletion of collection:",Z),!!Z)try{os(Z),ue(!1),se("")}catch(l){console.error("Error deleting collection:",l),re.error("Failed to delete collection")}};return e.jsxs("div",{className:"container mx-auto p-4 flex flex-col gap-6 pb-10 relative",children:[e.jsx("div",{ref:Fe,className:"absolute top-0"}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Text Translator"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(G,{variant:"outline",onClick:ds,"aria-label":"Copy full prompt",className:"hidden md:flex",children:[e.jsx(wa,{className:"h-5 w-5 mr-2"}),"Copy Prompt"]}),e.jsxs(G,{variant:"outline",onClick:et,"aria-label":"Clear all text",children:[e.jsx(Vs,{className:"h-5 w-5 mr-2"}),"Clear"]})]})]}),e.jsx(pr,{inputText:a,setInputText:n,translatedText:s,isTranslating:r,error:d,isCopied:v,onTranslate:h,onCopy:Ge,selectedModel:k,onModelChange:rs,models:f,selectedCollectionId:p,collections:R,onCollectionChange:cn,isCollectionManagementVisible:_,onToggleCollectionManagement:vt,arcrylicBg:t,modelDescriptions:T,clearInputText:xt,setErrorMessage:gt}),e.jsx(Ai,{isVisible:_,settingsPanelRef:qe,collections:R,collectionToEdit:O,setCollectionToEdit:K,editedCollectionName:$,setEditedCollectionName:Q,addNewCollection:ls,useCollection:U,renameCollection:Pt,requestDeleteCollection:bt,showDeleteConfirmation:de,setShowDeleteConfirmation:ue,confirmDeleteCollection:us,selectedCollectionId:p,error:d,setError:c,arcrylicBg:t,translationHistory:x,onClearHistory:N,onUseHistoryEntry:ce,onRemoveHistoryEntry:pe,updateMappingEntry:xe,removeMappingEntry:fe,addMappingEntry:ge,showMappingImportArea:Y,toggleMappingImportArea:Hn,mappingMarkdown:F,setMappingMarkdown:W,revertMappingImport:()=>Ln(!0),showMappingRevertButton:L,exportMappingMarkdown:()=>Gt(!0),importMappingMarkdown:()=>$n(F,!0),updateRelationshipEntry:Xe,removeRelationshipEntry:tt,addRelationshipEntry:Je,showRelationshipImportArea:Y,toggleRelationshipImportArea:Hn,relationshipsMarkdown:V,setRelationshipsMarkdown:B,revertRelationshipImport:()=>Ln(!1),showRelationshipRevertButton:L,exportRelationshipMarkdown:()=>Gt(!1),importRelationshipMarkdown:()=>$n(V,!1),onApproveUpdate:yt,onRejectUpdate:l=>{const g=R.map(m=>{var w;if(m.id===p){const C=((w=m.tableUpdateHistory)==null?void 0:w.map(A=>A.id===l.id?{...A,status:"rejected"}:A))||[];return{...m,tableUpdateHistory:C}}return m});M(g),Ee("translationCollections",g),Be(m=>m.filter(w=>w.id!==l.id)),re.success("Table update rejected successfully")}}),e.jsx(G,{variant:"default",size:"lg",className:"fixed bottom-6 right-6 rounded-full shadow-lg hover:shadow-xl z-[9999] w-12 h-12 p-0",onClick:()=>{console.log("Button clicked"),qt()},"aria-label":"Scroll to top",children:e.jsx(Rn,{className:"h-6 w-6"})}),$e&&e.jsx(zi,{showTableUpdates:$e,isTableUpdatesAnimating:zt,arcrylicBg:t,pendingTableUpdates:Se,expandedEntries:nt,toggleEntryExpansion:ht,setShowTableUpdates:Ce,handleUpdateConfirmation:un,showUpdateConfirmation:wt}),Ue&&be&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",children:e.jsx(Rt,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Confirm Table Update"}),e.jsx(G,{variant:"ghost",size:"sm",onClick:()=>{_e(!1),ye(null)},className:"h-8 w-8 p-0",children:e.jsx(an,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Added Entries"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted",children:e.jsx("tr",{children:be.type==="mapping"?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"p-2 text-left",children:"Term"}),e.jsx("th",{className:"p-2 text-left",children:"Transcription"}),e.jsx("th",{className:"p-2 text-left",children:"Type"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"p-2 text-left",children:"Character A"}),e.jsx("th",{className:"p-2 text-left",children:"Character B"}),e.jsx("th",{className:"p-2 text-left",children:"Relationship"})]})})}),e.jsx("tbody",{children:be.updates.added.map((l,g)=>e.jsx("tr",{className:"border-t",children:be.type==="mapping"?e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"p-2",children:l.term}),e.jsx("td",{className:"p-2",children:l.transcription}),e.jsx("td",{className:"p-2",children:l.type})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"p-2",children:l.characterA}),e.jsx("td",{className:"p-2",children:l.characterB}),e.jsx("td",{className:"p-2",children:l.relationship})]})},g))})]})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Updated Entries"}),e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted",children:e.jsx("tr",{children:be.type==="mapping"?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"p-2 text-left",children:"Term"}),e.jsx("th",{className:"p-2 text-left",children:"Transcription"}),e.jsx("th",{className:"p-2 text-left",children:"Type"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"p-2 text-left",children:"Character A"}),e.jsx("th",{className:"p-2 text-left",children:"Character B"}),e.jsx("th",{className:"p-2 text-left",children:"Relationship"})]})})}),e.jsx("tbody",{children:be.updates.updated.map((l,g)=>e.jsx("tr",{className:"border-t",children:be.type==="mapping"?e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"p-2",children:l.term}),e.jsx("td",{className:"p-2",children:l.transcription}),e.jsx("td",{className:"p-2",children:l.type})]}):e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"p-2",children:l.characterA}),e.jsx("td",{className:"p-2",children:l.characterB}),e.jsx("td",{className:"p-2",children:l.relationship})]})},g))})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[e.jsx(G,{variant:"outline",onClick:()=>{be&&un(be,!1)},children:"Reject"}),e.jsx(G,{variant:"default",onClick:()=>{be&&un(be,!0)},children:"Approve"})]})]})]})})})]})};export{Yi as default};
